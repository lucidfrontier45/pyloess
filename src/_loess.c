/* Generated by Cython 0.22 */

#define PY_SSIZE_T_CLEAN
#ifndef CYTHON_USE_PYLONG_INTERNALS
#ifdef PYLONG_BITS_IN_DIGIT
#define CYTHON_USE_PYLONG_INTERNALS 0
#else
#include "pyconfig.h"
#ifdef PYLONG_BITS_IN_DIGIT
#define CYTHON_USE_PYLONG_INTERNALS 1
#else
#define CYTHON_USE_PYLONG_INTERNALS 0
#endif
#endif
#endif
#include "Python.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03020000)
    #error Cython requires Python 2.6+ or Python 3.2+.
#else
#define CYTHON_ABI "0_22"
#include <stddef.h>
#ifndef offsetof
#define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#endif
#ifndef DL_IMPORT
  #define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef Py_HUGE_VAL
  #define Py_HUGE_VAL HUGE_VAL
#endif
#ifdef PYPY_VERSION
#define CYTHON_COMPILING_IN_PYPY 1
#define CYTHON_COMPILING_IN_CPYTHON 0
#else
#define CYTHON_COMPILING_IN_PYPY 0
#define CYTHON_COMPILING_IN_CPYTHON 1
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x02070600 && !defined(Py_OptimizeFlag)
#define Py_OptimizeFlag 0
#endif
#define __PYX_BUILD_PY_SSIZE_T "n"
#define CYTHON_FORMAT_SSIZE_T "z"
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos) \
          PyCode_New(a+k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyClass_Type
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos) \
          PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyType_Type
#endif
#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#if PY_VERSION_HEX < 0x030400a1 && !defined(Py_TPFLAGS_HAVE_FINALIZE)
  #define Py_TPFLAGS_HAVE_FINALIZE 0
#endif
#if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
  #define CYTHON_PEP393_ENABLED 1
  #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ? \
                                              0 : _PyUnicode_Ready((PyObject *)(op)))
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
  #define __Pyx_PyUnicode_KIND(u)         PyUnicode_KIND(u)
  #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)
  #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
#else
  #define CYTHON_PEP393_ENABLED 0
  #define __Pyx_PyUnicode_READY(op)       (0)
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_SIZE(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) ((Py_UCS4)(PyUnicode_AS_UNICODE(u)[i]))
  #define __Pyx_PyUnicode_KIND(u)         (sizeof(Py_UNICODE))
  #define __Pyx_PyUnicode_DATA(u)         ((void*)PyUnicode_AS_UNICODE(u))
  #define __Pyx_PyUnicode_READ(k, d, i)   ((void)(k), (Py_UCS4)(((Py_UNICODE*)d)[i]))
#endif
#if CYTHON_COMPILING_IN_PYPY
  #define __Pyx_PyUnicode_Concat(a, b)      PyNumber_Add(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  PyNumber_Add(a, b)
  #define __Pyx_PyFrozenSet_Size(s)         PyObject_Size(s)
#else
  #define __Pyx_PyUnicode_Concat(a, b)      PyUnicode_Concat(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  ((unlikely((a) == Py_None) || unlikely((b) == Py_None)) ? \
      PyNumber_Add(a, b) : __Pyx_PyUnicode_Concat(a, b))
  #define __Pyx_PyFrozenSet_Size(s)         PySet_Size(s)
#endif
#define __Pyx_PyString_FormatSafe(a, b)   ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : __Pyx_PyString_Format(a, b))
#define __Pyx_PyUnicode_FormatSafe(a, b)  ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : PyUnicode_Format(a, b))
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyString_Format(a, b)  PyUnicode_Format(a, b)
#else
  #define __Pyx_PyString_Format(a, b)  PyString_Format(a, b)
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyStringObject               PyUnicodeObject
  #define PyString_Type                PyUnicode_Type
  #define PyString_Check               PyUnicode_Check
  #define PyString_CheckExact          PyUnicode_CheckExact
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyBaseString_Check(obj) PyUnicode_Check(obj)
  #define __Pyx_PyBaseString_CheckExact(obj) PyUnicode_CheckExact(obj)
#else
  #define __Pyx_PyBaseString_Check(obj) (PyString_Check(obj) || PyUnicode_Check(obj))
  #define __Pyx_PyBaseString_CheckExact(obj) (PyString_CheckExact(obj) || PyUnicode_CheckExact(obj))
#endif
#ifndef PySet_CheckExact
  #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
#endif
#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
#if PY_MAJOR_VERSION >= 3
  #define PyIntObject                  PyLongObject
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define PyNumber_Int                 PyNumber_Long
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBoolObject                 PyLongObject
#endif
#if PY_MAJOR_VERSION >= 3 && CYTHON_COMPILING_IN_PYPY
  #ifndef PyUnicode_InternFromString
    #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
  #endif
#endif
#if PY_VERSION_HEX < 0x030200A4
  typedef long Py_hash_t;
  #define __Pyx_PyInt_FromHash_t PyInt_FromLong
  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
#else
  #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
#else
  #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
#endif
#ifndef CYTHON_INLINE
  #if defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif
#ifndef CYTHON_RESTRICT
  #if defined(__GNUC__)
    #define CYTHON_RESTRICT __restrict__
  #elif defined(_MSC_VER) && _MSC_VER >= 1400
    #define CYTHON_RESTRICT __restrict
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_RESTRICT restrict
  #else
    #define CYTHON_RESTRICT
  #endif
#endif
#ifdef NAN
#define __PYX_NAN() ((float) NAN)
#else
static CYTHON_INLINE float __PYX_NAN() {
  /* Initialize NaN. The sign is irrelevant, an exponent with all bits 1 and
   a nonzero mantissa means NaN. If the first bit in the mantissa is 1, it is
   a quiet NaN. */
  float value;
  memset(&value, 0xFF, sizeof(value));
  return value;
}
#endif
#define __Pyx_void_to_None(void_result) (void_result, Py_INCREF(Py_None), Py_None)
#ifdef __cplusplus
template<typename T>
void __Pyx_call_destructor(T* x) {
    x->~T();
}
template<typename T>
class __Pyx_FakeReference {
  public:
    __Pyx_FakeReference() : ptr(NULL) { }
    __Pyx_FakeReference(T& ref) : ptr(&ref) { }
    T *operator->() { return ptr; }
    operator T&() { return *ptr; }
  private:
    T *ptr;
};
#endif


#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
#endif

#ifndef __PYX_EXTERN_C
  #ifdef __cplusplus
    #define __PYX_EXTERN_C extern "C"
  #else
    #define __PYX_EXTERN_C extern
  #endif
#endif

#if defined(WIN32) || defined(MS_WINDOWS)
#define _USE_MATH_DEFINES
#endif
#include <math.h>
#define __PYX_HAVE___loess
#define __PYX_HAVE_API___loess
#include "stdlib.h"
#include "numpy/arrayobject.h"
#include "loess.h"
#include "cloess.h"
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#ifdef PYREX_WITHOUT_ASSERTIONS
#define CYTHON_WITHOUT_ASSERTIONS
#endif

#ifndef CYTHON_UNUSED
# if defined(__GNUC__)
#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#     define CYTHON_UNUSED __attribute__ ((__unused__))
#   else
#     define CYTHON_UNUSED
#   endif
# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
#   define CYTHON_UNUSED __attribute__ ((__unused__))
# else
#   define CYTHON_UNUSED
# endif
#endif
typedef struct {PyObject **p; char *s; const Py_ssize_t n; const char* encoding;
                const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry;

#define __PYX_DEFAULT_STRING_ENCODING_IS_ASCII 0
#define __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT 0
#define __PYX_DEFAULT_STRING_ENCODING ""
#define __Pyx_PyObject_FromString __Pyx_PyBytes_FromString
#define __Pyx_PyObject_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#define __Pyx_fits_Py_ssize_t(v, type, is_signed)  (    \
    (sizeof(type) < sizeof(Py_ssize_t))  ||             \
    (sizeof(type) > sizeof(Py_ssize_t) &&               \
          likely(v < (type)PY_SSIZE_T_MAX ||            \
                 v == (type)PY_SSIZE_T_MAX)  &&         \
          (!is_signed || likely(v > (type)PY_SSIZE_T_MIN ||       \
                                v == (type)PY_SSIZE_T_MIN)))  ||  \
    (sizeof(type) == sizeof(Py_ssize_t) &&              \
          (is_signed || likely(v < (type)PY_SSIZE_T_MAX ||        \
                               v == (type)PY_SSIZE_T_MAX)))  )
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject*);
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject*, Py_ssize_t* length);
#define __Pyx_PyByteArray_FromString(s) PyByteArray_FromStringAndSize((const char*)s, strlen((const char*)s))
#define __Pyx_PyByteArray_FromStringAndSize(s, l) PyByteArray_FromStringAndSize((const char*)s, l)
#define __Pyx_PyBytes_FromString        PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize PyBytes_FromStringAndSize
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char*);
#if PY_MAJOR_VERSION < 3
    #define __Pyx_PyStr_FromString        __Pyx_PyBytes_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#else
    #define __Pyx_PyStr_FromString        __Pyx_PyUnicode_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyUnicode_FromStringAndSize
#endif
#define __Pyx_PyObject_AsSString(s)    ((signed char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsUString(s)    ((unsigned char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
#define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
#define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
#define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
#define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
#if PY_MAJOR_VERSION < 3
static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
{
    const Py_UNICODE *u_end = u;
    while (*u_end++) ;
    return (size_t)(u_end - u - 1);
}
#else
#define __Pyx_Py_UNICODE_strlen Py_UNICODE_strlen
#endif
#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
#define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
#define __Pyx_Owned_Py_None(b) (Py_INCREF(Py_None), Py_None)
#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x);
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
#if CYTHON_COMPILING_IN_CPYTHON
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
#else
#define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
#endif
#define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
static int __Pyx_sys_getdefaultencoding_not_ascii;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    PyObject* ascii_chars_u = NULL;
    PyObject* ascii_chars_b = NULL;
    const char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    if (strcmp(default_encoding_c, "ascii") == 0) {
        __Pyx_sys_getdefaultencoding_not_ascii = 0;
    } else {
        char ascii_chars[128];
        int c;
        for (c = 0; c < 128; c++) {
            ascii_chars[c] = c;
        }
        __Pyx_sys_getdefaultencoding_not_ascii = 1;
        ascii_chars_u = PyUnicode_DecodeASCII(ascii_chars, 128, NULL);
        if (!ascii_chars_u) goto bad;
        ascii_chars_b = PyUnicode_AsEncodedString(ascii_chars_u, default_encoding_c, NULL);
        if (!ascii_chars_b || !PyBytes_Check(ascii_chars_b) || memcmp(ascii_chars, PyBytes_AS_STRING(ascii_chars_b), 128) != 0) {
            PyErr_Format(
                PyExc_ValueError,
                "This module compiled with c_string_encoding=ascii, but default encoding '%.200s' is not a superset of ascii.",
                default_encoding_c);
            goto bad;
        }
        Py_DECREF(ascii_chars_u);
        Py_DECREF(ascii_chars_b);
    }
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    Py_XDECREF(ascii_chars_u);
    Py_XDECREF(ascii_chars_b);
    return -1;
}
#endif
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT && PY_MAJOR_VERSION >= 3
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_DecodeUTF8(c_str, size, NULL)
#else
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_Decode(c_str, size, __PYX_DEFAULT_STRING_ENCODING, NULL)
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
static char* __PYX_DEFAULT_STRING_ENCODING;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) (const char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    __PYX_DEFAULT_STRING_ENCODING = (char*) malloc(strlen(default_encoding_c));
    if (!__PYX_DEFAULT_STRING_ENCODING) goto bad;
    strcpy(__PYX_DEFAULT_STRING_ENCODING, default_encoding_c);
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    return -1;
}
#endif
#endif


/* Test for GCC > 2.95 */
#if defined(__GNUC__)     && (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))
  #define likely(x)   __builtin_expect(!!(x), 1)
  #define unlikely(x) __builtin_expect(!!(x), 0)
#else /* !__GNUC__ or GCC < 2.95 */
  #define likely(x)   (x)
  #define unlikely(x) (x)
#endif /* __GNUC__ */

static PyObject *__pyx_m;
static PyObject *__pyx_d;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;


static const char *__pyx_f[] = {
  "_loess.pyx",
  "c_numpy.pxd",
};

/*--- Type declarations ---*/
struct __pyx_obj_6_loess_loess_inputs;
struct __pyx_obj_6_loess_loess_control;
struct __pyx_obj_6_loess_loess_kd_tree;
struct __pyx_obj_6_loess_loess_model;
struct __pyx_obj_6_loess_loess_outputs;
struct __pyx_obj_6_loess_conf_intervals;
struct __pyx_obj_6_loess_loess_predicted;
struct __pyx_obj_6_loess_loess;
struct __pyx_obj_6_loess_anova;

/* "_loess.pyx":61
 * #---- ---- loess model ---
 * #####---------------------------------------------------------------------------
 * cdef class loess_inputs:             # <<<<<<<<<<<<<<
 *     """Loess inputs
 * 
 */
struct __pyx_obj_6_loess_loess_inputs {
  PyObject_HEAD
  loess_inputs *_base;
  PyArrayObject *w_ndr;
  PyArrayObject *x;
  PyArrayObject *y;
  PyArrayObject *masked;
  PyArrayObject *x_eff;
  PyArrayObject *y_eff;
  int nobs;
  int npar;
};


/* "_loess.pyx":128
 * ##---- ---- loess control ---
 * ######---------------------------------------------------------------------------
 * cdef class loess_control:             # <<<<<<<<<<<<<<
 *     """Loess control parameters.
 * 
 */
struct __pyx_obj_6_loess_loess_control {
  PyObject_HEAD
  loess_control *_base;
};


/* "_loess.pyx":286
 * ##---- ---- loess kd_tree ---
 * ######---------------------------------------------------------------------------
 * cdef class loess_kd_tree:             # <<<<<<<<<<<<<<
 *     cdef c_loess.c_loess_kd_tree *_base
 * 
 */
struct __pyx_obj_6_loess_loess_kd_tree {
  PyObject_HEAD
  loess_kd_tree *_base;
};


/* "_loess.pyx":292
 * ##---- ---- loess model ---
 * ######---------------------------------------------------------------------------
 * cdef class loess_model:             # <<<<<<<<<<<<<<
 *     """loess_model contains parameters required for a loess fit.
 * 
 */
struct __pyx_obj_6_loess_loess_model {
  PyObject_HEAD
  struct __pyx_vtabstruct_6_loess_loess_model *__pyx_vtab;
  loess_model *_base;
  long npar;
};


/* "_loess.pyx":434
 * #---- ---- loess outputs ---
 * #####---------------------------------------------------------------------------
 * cdef class loess_outputs:             # <<<<<<<<<<<<<<
 *     """Outputs of a loess fit. This object is automatically created with empty
 * values when a new loess object is instantiated. The object gets filled when the
 */
struct __pyx_obj_6_loess_loess_outputs {
  PyObject_HEAD
  struct __pyx_vtabstruct_6_loess_loess_outputs *__pyx_vtab;
  loess_outputs *_base;
  long nobs;
  long npar;
  int activated;
};


/* "_loess.pyx":532
 * #---- ---- loess confidence ---
 * #####---------------------------------------------------------------------------
 * cdef class conf_intervals:             # <<<<<<<<<<<<<<
 *     """Pointwise confidence intervals of a loess-predicted object:
 * 
 */
struct __pyx_obj_6_loess_conf_intervals {
  PyObject_HEAD
  struct __pyx_vtabstruct_6_loess_conf_intervals *__pyx_vtab;
  conf_inv _base;
  PyArrayObject *lower;
  PyArrayObject *fit;
  PyArrayObject *upper;
};


/* "_loess.pyx":564
 * #---- ---- loess predictions ---
 * #####---------------------------------------------------------------------------
 * cdef class loess_predicted:             # <<<<<<<<<<<<<<
 *     """Predicted values and standard errors of a loess object
 * 
 */
struct __pyx_obj_6_loess_loess_predicted {
  PyObject_HEAD
  struct __pyx_vtabstruct_6_loess_loess_predicted *__pyx_vtab;
  prediction _base;
  long nest;
  struct __pyx_obj_6_loess_conf_intervals *confidence_intervals;
};


/* "_loess.pyx":650
 * #---- ---- loess base class ---
 * #####---------------------------------------------------------------------------
 * cdef class loess:             # <<<<<<<<<<<<<<
 *     """
 * 
 */
struct __pyx_obj_6_loess_loess {
  PyObject_HEAD
  loess _base;
  struct __pyx_obj_6_loess_loess_inputs *inputs;
  struct __pyx_obj_6_loess_loess_model *model;
  struct __pyx_obj_6_loess_loess_control *control;
  struct __pyx_obj_6_loess_loess_kd_tree *kd_tree;
  struct __pyx_obj_6_loess_loess_outputs *outputs;
  struct __pyx_obj_6_loess_loess_predicted *predicted;
};


/* "_loess.pyx":886
 * #---- ---- loess anova ---
 * #####---------------------------------------------------------------------------
 * cdef class anova:             # <<<<<<<<<<<<<<
 *     cdef readonly double dfn, dfd, F_value, Pr_F
 *     #
 */
struct __pyx_obj_6_loess_anova {
  PyObject_HEAD
  double dfn;
  double dfd;
  double F_value;
  double Pr_F;
};



/* "_loess.pyx":292
 * ##---- ---- loess model ---
 * ######---------------------------------------------------------------------------
 * cdef class loess_model:             # <<<<<<<<<<<<<<
 *     """loess_model contains parameters required for a loess fit.
 * 
 */

struct __pyx_vtabstruct_6_loess_loess_model {
  PyObject *(*setup)(struct __pyx_obj_6_loess_loess_model *, loess_model *, long);
};
static struct __pyx_vtabstruct_6_loess_loess_model *__pyx_vtabptr_6_loess_loess_model;


/* "_loess.pyx":434
 * #---- ---- loess outputs ---
 * #####---------------------------------------------------------------------------
 * cdef class loess_outputs:             # <<<<<<<<<<<<<<
 *     """Outputs of a loess fit. This object is automatically created with empty
 * values when a new loess object is instantiated. The object gets filled when the
 */

struct __pyx_vtabstruct_6_loess_loess_outputs {
  PyObject *(*setup)(struct __pyx_obj_6_loess_loess_outputs *, loess_outputs *, long, long);
};
static struct __pyx_vtabstruct_6_loess_loess_outputs *__pyx_vtabptr_6_loess_loess_outputs;


/* "_loess.pyx":532
 * #---- ---- loess confidence ---
 * #####---------------------------------------------------------------------------
 * cdef class conf_intervals:             # <<<<<<<<<<<<<<
 *     """Pointwise confidence intervals of a loess-predicted object:
 * 
 */

struct __pyx_vtabstruct_6_loess_conf_intervals {
  PyObject *(*setup)(struct __pyx_obj_6_loess_conf_intervals *, conf_inv, long);
};
static struct __pyx_vtabstruct_6_loess_conf_intervals *__pyx_vtabptr_6_loess_conf_intervals;


/* "_loess.pyx":564
 * #---- ---- loess predictions ---
 * #####---------------------------------------------------------------------------
 * cdef class loess_predicted:             # <<<<<<<<<<<<<<
 *     """Predicted values and standard errors of a loess object
 * 
 */

struct __pyx_vtabstruct_6_loess_loess_predicted {
  PyObject *(*setup)(struct __pyx_obj_6_loess_loess_predicted *, prediction, long);
};
static struct __pyx_vtabstruct_6_loess_loess_predicted *__pyx_vtabptr_6_loess_loess_predicted;

/* --- Runtime support code (head) --- */
#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif
#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, int);
    void (*DECREF)(void*, PyObject*, int);
    void (*GOTREF)(void*, PyObject*, int);
    void (*GIVEREF)(void*, PyObject*, int);
    void* (*SetupContext)(const char*, int, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname);
  #define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
#ifdef WITH_THREAD
  #define __Pyx_RefNannySetupContext(name, acquire_gil) \
          if (acquire_gil) { \
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure(); \
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__); \
              PyGILState_Release(__pyx_gilstate_save); \
          } else { \
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__); \
          }
#else
  #define __Pyx_RefNannySetupContext(name, acquire_gil) \
          __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
#endif
  #define __Pyx_RefNannyFinishContext() \
          __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r)  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_DECREF(r)  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GOTREF(r)  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_XINCREF(r)  do { if((r) != NULL) {__Pyx_INCREF(r); }} while(0)
  #define __Pyx_XDECREF(r)  do { if((r) != NULL) {__Pyx_DECREF(r); }} while(0)
  #define __Pyx_XGOTREF(r)  do { if((r) != NULL) {__Pyx_GOTREF(r); }} while(0)
  #define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);}} while(0)
#else
  #define __Pyx_RefNannyDeclarations
  #define __Pyx_RefNannySetupContext(name, acquire_gil)
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XINCREF(r) Py_XINCREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
  #define __Pyx_XGOTREF(r)
  #define __Pyx_XGIVEREF(r)
#endif
#define __Pyx_XDECREF_SET(r, v) do {                            \
        PyObject *tmp = (PyObject *) r;                         \
        r = v; __Pyx_XDECREF(tmp);                              \
    } while (0)
#define __Pyx_DECREF_SET(r, v) do {                             \
        PyObject *tmp = (PyObject *) r;                         \
        r = v; __Pyx_DECREF(tmp);                               \
    } while (0)
#define __Pyx_CLEAR(r)    do { PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);} while(0)
#define __Pyx_XCLEAR(r)   do { if((r) != NULL) {PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);}} while(0)

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_getattro))
        return tp->tp_getattro(obj, attr_name);
#if PY_MAJOR_VERSION < 3
    if (likely(tp->tp_getattr))
        return tp->tp_getattr(obj, PyString_AS_STRING(attr_name));
#endif
    return PyObject_GetAttr(obj, attr_name);
}
#else
#define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
#endif

static PyObject *__Pyx_GetBuiltinName(PyObject *name);

static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);

#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_PyObject_DelAttrStr(o,n) __Pyx_PyObject_SetAttrStr(o,n,NULL)
static CYTHON_INLINE int __Pyx_PyObject_SetAttrStr(PyObject* obj, PyObject* attr_name, PyObject* value) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_setattro))
        return tp->tp_setattro(obj, attr_name, value);
#if PY_MAJOR_VERSION < 3
    if (likely(tp->tp_setattr))
        return tp->tp_setattr(obj, PyString_AS_STRING(attr_name), value);
#endif
    return PyObject_SetAttr(obj, attr_name, value);
}
#else
#define __Pyx_PyObject_DelAttrStr(o,n)   PyObject_DelAttr(o,n)
#define __Pyx_PyObject_SetAttrStr(o,n,v) PyObject_SetAttr(o,n,v)
#endif

static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name);

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
#else
#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
#endif

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
#endif

static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);

static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);

static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);

static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[], \
    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args, \
    const char* function_name);

#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck) \
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ? \
    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) : \
    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) : \
               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck) \
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ? \
    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) : \
    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck) \
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ? \
    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) : \
    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                     int is_list, int wraparound, int boundscheck);

static CYTHON_INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb);
static CYTHON_INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb);

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
#else
#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
#endif

#include <string.h>

static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);

static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals);

#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyString_Equals __Pyx_PyUnicode_Equals
#else
#define __Pyx_PyString_Equals __Pyx_PyBytes_Equals
#endif

static CYTHON_INLINE int __Pyx_CheckKeywordStrings(PyObject *kwdict, const char* function_name, int kw_allowed);

static PyObject* __Pyx_PyDict_GetItemDefault(PyObject* d, PyObject* key, PyObject* default_value);

#if PY_MAJOR_VERSION < 3
#define __Pyx_PyString_Join __Pyx_PyBytes_Join
#define __Pyx_PyBaseString_Join(s, v) (PyUnicode_CheckExact(s) ? PyUnicode_Join(s, v) : __Pyx_PyBytes_Join(s, v))
#else
#define __Pyx_PyString_Join PyUnicode_Join
#define __Pyx_PyBaseString_Join PyUnicode_Join
#endif
#if CYTHON_COMPILING_IN_CPYTHON
    #if PY_MAJOR_VERSION < 3
    #define __Pyx_PyBytes_Join _PyString_Join
    #else
    #define __Pyx_PyBytes_Join _PyBytes_Join
    #endif
#else
static CYTHON_INLINE PyObject* __Pyx_PyBytes_Join(PyObject* sep, PyObject* values);
#endif

static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
        int has_cstart, int has_cstop, int wraparound);

static CYTHON_INLINE int __Pyx_IterFinish(void);

static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name);

static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);

static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void);

static void __Pyx_UnpackTupleError(PyObject *, Py_ssize_t index);

static CYTHON_INLINE int __Pyx_unpack_tuple2(PyObject* tuple, PyObject** value1, PyObject** value2,
                                             int is_tuple, int has_known_size, int decref_tuple);

static CYTHON_INLINE PyObject* __Pyx_dict_iterator(PyObject* dict, int is_dict, PyObject* method_name,
                                                   Py_ssize_t* p_orig_length, int* p_is_dict);
static CYTHON_INLINE int __Pyx_dict_iter_next(PyObject* dict_or_iter, Py_ssize_t orig_length, Py_ssize_t* ppos,
                                              PyObject** pkey, PyObject** pvalue, PyObject** pitem, int is_dict);

#ifndef __PYX_FORCE_INIT_THREADS
  #define __PYX_FORCE_INIT_THREADS 0
#endif

static int __Pyx_SetVtable(PyObject *dict, void *vtable);

typedef struct {
    int code_line;
    PyCodeObject* code_object;
} __Pyx_CodeObjectCacheEntry;
struct __Pyx_CodeObjectCache {
    int count;
    int max_count;
    __Pyx_CodeObjectCacheEntry* entries;
};
static struct __Pyx_CodeObjectCache __pyx_code_cache = {0,0,NULL};
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line);
static PyCodeObject *__pyx_find_code_object(int code_line);
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object);

static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename);

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);

static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);

static int __Pyx_Print(PyObject*, PyObject *, int);
#if CYTHON_COMPILING_IN_PYPY || PY_MAJOR_VERSION >= 3
static PyObject* __pyx_print = 0;
static PyObject* __pyx_print_kwargs = 0;
#endif

static int __Pyx_PrintOne(PyObject* stream, PyObject *o);

static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);

static int __Pyx_check_binary_version(void);

#if !defined(__Pyx_PyIdentifier_FromString)
#if PY_MAJOR_VERSION < 3
  #define __Pyx_PyIdentifier_FromString(s) PyString_FromString(s)
#else
  #define __Pyx_PyIdentifier_FromString(s) PyUnicode_FromString(s)
#endif
#endif

static PyObject *__Pyx_ImportModule(const char *name);

static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, size_t size, int strict);

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);

static PyObject *__pyx_f_6_loess_11loess_model_setup(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, loess_model *__pyx_v_base, long __pyx_v_npar); /* proto*/
static PyObject *__pyx_f_6_loess_13loess_outputs_setup(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self, loess_outputs *__pyx_v_base, long __pyx_v_nobs, long __pyx_v_npar); /* proto*/
static PyObject *__pyx_f_6_loess_14conf_intervals_setup(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self, conf_inv __pyx_v_base, long __pyx_v_nest); /* proto*/
static PyObject *__pyx_f_6_loess_15loess_predicted_setup(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self, prediction __pyx_v_base, long __pyx_v_nest); /* proto*/

/* Module declarations from 'c_python' */

/* Module declarations from 'numpy' */

/* Module declarations from 'c_numpy' */
static PyTypeObject *__pyx_ptype_7c_numpy_dtype = 0;
static PyTypeObject *__pyx_ptype_7c_numpy_ndarray = 0;
static PyTypeObject *__pyx_ptype_7c_numpy_flatiter = 0;
static PyTypeObject *__pyx_ptype_7c_numpy_broadcast = 0;

/* Module declarations from 'c_loess' */

/* Module declarations from '_loess' */
static PyTypeObject *__pyx_ptype_6_loess_loess_inputs = 0;
static PyTypeObject *__pyx_ptype_6_loess_loess_control = 0;
static PyTypeObject *__pyx_ptype_6_loess_loess_kd_tree = 0;
static PyTypeObject *__pyx_ptype_6_loess_loess_model = 0;
static PyTypeObject *__pyx_ptype_6_loess_loess_outputs = 0;
static PyTypeObject *__pyx_ptype_6_loess_conf_intervals = 0;
static PyTypeObject *__pyx_ptype_6_loess_loess_predicted = 0;
static PyTypeObject *__pyx_ptype_6_loess_loess = 0;
static PyTypeObject *__pyx_ptype_6_loess_anova = 0;
static PyObject *__pyx_f_6_loess_floatarray_from_data(int, int, double *); /*proto*/
static PyObject *__pyx_f_6_loess_boolarray_from_data(int, int, int *); /*proto*/
#define __Pyx_MODULE_NAME "_loess"
int __pyx_module_is_main__loess = 0;

/* Implementation of '_loess' */
static PyObject *__pyx_builtin_ValueError;
static int __pyx_pf_6_loess_12loess_inputs___init__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self, PyObject *__pyx_v_x_data, PyObject *__pyx_v_y_data); /* proto */
static PyObject *__pyx_pf_6_loess_12loess_inputs_7weights___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_12loess_inputs_7weights_2__set__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self, PyObject *__pyx_v_w); /* proto */
static PyObject *__pyx_pf_6_loess_12loess_inputs_1x___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_12loess_inputs_1y___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_12loess_inputs_6masked___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_12loess_inputs_5x_eff___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_12loess_inputs_5y_eff___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_12loess_inputs_4nobs___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_12loess_inputs_4npar___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_control_7surface___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_13loess_control_7surface_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_surface); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_control_10statistics___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_13loess_control_10statistics_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_statistics); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_control_9trace_hat___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_13loess_control_9trace_hat_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_trace_hat); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_control_10iterations___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_13loess_control_10iterations_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_iterations); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_control_4cell___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_13loess_control_4cell_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_cell); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_control_update(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_cellargs); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_control_2__str__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_9normalize___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_11loess_model_9normalize_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_normalize); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_4span___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_11loess_model_4span_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_span); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_6degree___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_11loess_model_6degree_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_degree); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_6family___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_11loess_model_6family_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_family); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_16parametric_flags___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_11loess_model_16parametric_flags_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_paramf); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_17drop_square_flags___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_11loess_model_17drop_square_flags_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_drop_sq); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_update(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_modelargs); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_2__repr__(CYTHON_UNUSED struct __pyx_obj_6_loess_loess_model *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_11loess_model_4__str__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_13fitted_values___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_16fitted_residuals___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_12pseudovalues___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_8diagonal___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_6robust___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_7divisor___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_3enp___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_1s___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_9one_delta___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_9two_delta___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_9trace_hat___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs___str__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_13loess_outputs_9activated___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self); /* proto */
static void __pyx_pf_6_loess_14conf_intervals___dealloc__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_14conf_intervals_2__str__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_14conf_intervals_5lower___get__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_14conf_intervals_3fit___get__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_14conf_intervals_5upper___get__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self); /* proto */
static void __pyx_pf_6_loess_15loess_predicted___dealloc__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_15loess_predicted_6values___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_15loess_predicted_6stderr___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_15loess_predicted_14residual_scale___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_15loess_predicted_2df___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_15loess_predicted_2confidence(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self, PyObject *__pyx_v_coverage); /* proto */
static PyObject *__pyx_pf_6_loess_15loess_predicted_4__str__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_15loess_predicted_4nest___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_15loess_predicted_20confidence_intervals___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_5loess___init__(struct __pyx_obj_6_loess_loess *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, CYTHON_UNUSED PyObject *__pyx_v_weights, PyObject *__pyx_v_options); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_2fit(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_4input_summary(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_6output_summary(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_8predict(struct __pyx_obj_6_loess_loess *__pyx_v_self, PyObject *__pyx_v_newdata, PyObject *__pyx_v_stderror); /* proto */
static void __pyx_pf_6_loess_5loess_10__dealloc__(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_6inputs___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_5model___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_7control___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_7kd_tree___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_7outputs___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5loess_9predicted___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self); /* proto */
static int __pyx_pf_6_loess_5anova___init__(struct __pyx_obj_6_loess_anova *__pyx_v_self, PyObject *__pyx_v_loess_one, PyObject *__pyx_v_loess_two); /* proto */
static PyObject *__pyx_pf_6_loess_5anova_3dfn___get__(struct __pyx_obj_6_loess_anova *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5anova_3dfd___get__(struct __pyx_obj_6_loess_anova *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5anova_7F_value___get__(struct __pyx_obj_6_loess_anova *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6_loess_5anova_4Pr_F___get__(struct __pyx_obj_6_loess_anova *__pyx_v_self); /* proto */
static PyObject *__pyx_tp_new_6_loess_loess_inputs(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6_loess_loess_control(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6_loess_loess_kd_tree(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6_loess_loess_model(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6_loess_loess_outputs(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6_loess_conf_intervals(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6_loess_loess_predicted(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6_loess_loess(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6_loess_anova(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static char __pyx_k_C[] = "C";
static char __pyx_k_T[] = "T";
static char __pyx_k_r[] = "r_";
static char __pyx_k_s[] = "s";
static char __pyx_k_x[] = "x";
static char __pyx_k_y[] = "y";
static char __pyx_k__7[] = "\n";
static char __pyx_k_df[] = "df";
static char __pyx_k_end[] = "end";
static char __pyx_k_enp[] = "enp";
static char __pyx_k_get[] = "get";
static char __pyx_k_bool[] = "bool";
static char __pyx_k_cell[] = "cell";
static char __pyx_k_copy[] = "copy";
static char __pyx_k_file[] = "file";
static char __pyx_k_join[] = "join";
static char __pyx_k_main[] = "__main__";
static char __pyx_k_ndim[] = "ndim";
static char __pyx_k_ones[] = "ones";
static char __pyx_k_size[] = "size";
static char __pyx_k_span[] = "span";
static char __pyx_k_test[] = "__test__";
static char __pyx_k_array[] = "array";
static char __pyx_k_dtype[] = "dtype";
static char __pyx_k_exact[] = "exact";
static char __pyx_k_float[] = "float_";
static char __pyx_k_lower[] = "lower";
static char __pyx_k_numpy[] = "numpy";
static char __pyx_k_order[] = "order";
static char __pyx_k_print[] = "print";
static char __pyx_k_ravel[] = "ravel";
static char __pyx_k_shape[] = "shape";
static char __pyx_k_subok[] = "subok";
static char __pyx_k_Span_s[] = "Span            : %s";
static char __pyx_k_astype[] = "astype";
static char __pyx_k_degree[] = "degree";
static char __pyx_k_direct[] = "direct";
static char __pyx_k_family[] = "family";
static char __pyx_k_import[] = "__import__";
static char __pyx_k_narray[] = "narray";
static char __pyx_k_stderr[] = "stderr";
static char __pyx_k_update[] = "update";
static char __pyx_k_values[] = "values";
static char __pyx_k_x_data[] = "x_data";
static char __pyx_k_y_data[] = "y_data";
static char __pyx_k_Control[] = "Control          :";
static char __pyx_k_Outputs[] = "Outputs................";
static char __pyx_k_divisor[] = "divisor";
static char __pyx_k_newdata[] = "newdata";
static char __pyx_k_outputs[] = "outputs";
static char __pyx_k_surface[] = "surface";
static char __pyx_k_weights[] = "weights";
static char __pyx_k_Degree_s[] = "Degree          : %s";
static char __pyx_k_Family_s[] = "Family          : %s";
static char __pyx_k_coverage[] = "coverage";
static char __pyx_k_gaussian[] = "gaussian";
static char __pyx_k_stderror[] = "stderror";
static char __pyx_k_iteritems[] = "iteritems";
static char __pyx_k_loess_one[] = "loess_one";
static char __pyx_k_loess_two[] = "loess_two";
static char __pyx_k_normalize[] = "normalize";
static char __pyx_k_one_delta[] = "one_delta";
static char __pyx_k_symmetric[] = "symmetric";
static char __pyx_k_trace_hat[] = "trace_hat";
static char __pyx_k_two_delta[] = "two_delta";
static char __pyx_k_Deltas_s_s[] = "Deltas                : %s - %s";
static char __pyx_k_Fit_flag_d[] = "Fit flag                       : %d";
static char __pyx_k_ValueError[] = "ValueError";
static char __pyx_k_atleast_1d[] = "atleast_1d";
static char __pyx_k_iterations[] = "iterations";
static char __pyx_k_parametric[] = "parametric";
static char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
static char __pyx_k_statistics[] = "statistics";
static char __pyx_k_Cell_size_s[] = "Cell size        : %s";
static char __pyx_k_approximate[] = "approximate";
static char __pyx_k_drop_square[] = "drop_square";
static char __pyx_k_interpolate[] = "interpolate";
static char __pyx_k_Normalized_s[] = "Normalized      : %s";
static char __pyx_k_Parametric_s[] = "Parametric      : %s";
static char __pyx_k_Statistics_s[] = "Statistics       : %s";
static char __pyx_k_Drop_square_s[] = "Drop_square     : %s";
static char __pyx_k_fitted_values[] = "fitted_values";
static char __pyx_k_Surface_type_s[] = "Surface type     : %s";
static char __pyx_k_residual_scale[] = "residual_scale";
static char __pyx_k_Fitted_values_s[] = "Fitted values         : %s\n";
static char __pyx_k_Nb_iterations_s[] = "Nb iterations    : %s";
static char __pyx_k_Model_parameters[] = "Model parameters.....";
static char __pyx_k_Residual_error_s[] = "Residual error        : %s";
static char __pyx_k_Residual_scale_s[] = "Residual scale        : %s";
static char __pyx_k_fitted_residuals[] = "fitted_residuals";
static char __pyx_k_parametric_flags[] = "parametric_flags";
static char __pyx_k_drop_square_flags[] = "drop_square_flags";
static char __pyx_k_Fitted_residuals_s[] = "Fitted residuals      : %s\n";
static char __pyx_k_Predicted_values_s[] = "Predicted values      : %s\n";
static char __pyx_k_Trace_estimation_s[] = "Trace estimation : %s";
static char __pyx_k_Degrees_of_freedom_s[] = "Degrees of freedom    : %s";
static char __pyx_k_Predicted_std_error_s[] = "Predicted std error   : %s\n";
static char __pyx_k_Eqv_nb_of_parameters_s[] = "Eqv. nb of parameters : %s";
static char __pyx_k_Normalization_factors_s[] = "Normalization factors : %s";
static char __pyx_k_Number_of_Observations_d[] = "Number of Observations         : %d";
static char __pyx_k_Residual_Scale_Estimate_4f[] = "Residual Scale Estimate        : %.4f";
static char __pyx_k_Residual_Standard_Error_4f[] = "Residual Standard Error        : %.4f";
static char __pyx_k_loess_object_model_parameters[] = "<loess object: model parameters>";
static char __pyx_k_Span_should_be_between_0_and_1[] = "Span should be between 0 and 1!";
static char __pyx_k_cell_integer_Maximum_cell_size[] = "\n    cell : integer\n        Maximum cell size of the kd-tree. Suppose k = floor(n*cell*span),\n        where n is the number of observations, and span the smoothing parameter.\n        Then, a cell is further divided if the number of observations within it \n        is greater than or equal to k. This option is only used if the surface \n        is interpolated.\n        ";
static char __pyx_k_Arguments_should_be_valid_loess[] = "Arguments should be valid loess objects!got '%s' instead";
static char __pyx_k_Equivalent_Number_of_Parameters[] = "Equivalent Number of Parameters: %.1f";
static char __pyx_k_Invalid_value_for_the_trace_hat[] = "Invalid value for the 'trace_hat' argument: should be in ('approximate', 'exact').";
static char __pyx_k_iterations_integer_Number_of_it[] = "\n    iterations : integer\n        Number of iterations of the robust fitting method. If the family is \n        \"gaussian\", the number of iterations is set to 0.\n        ";
static char __pyx_k_should_be_in_interpolate_direct[] = "should be in ('interpolate', 'direct').";
static char __pyx_k_statistics_string_approximate_D[] = "\n    statistics : string [\"approximate\"]\n        Determines whether the statistical quantities are computed exactly \n        (\"exact\") or approximately (\"approximate\"). \"exact\" should only be used \n        for testing the approximation in statistical development and is not meant \n        for routine usage because computation time can be horrendous.\n        ";
static char __pyx_k_surface_string_interpolate_Dete[] = "\n    surface : string [\"interpolate\"]\n        Determines whether the fitted surface is computed directly at all points\n        (\"direct\") or whether an interpolation method is used (\"interpolate\").\n        The default (\"interpolate\") is what most users should use unless special \n        circumstances warrant.\n        ";
static char __pyx_k_trace_hat_string_wait_to_decide[] = "\n    trace_hat : string [\"wait.to.decide\"]\n        Determines how the trace of the hat matrix should be computed. The hat\n        matrix is used in the computation of the statistical quantities. \n        If \"exact\", an exact computation is done; this could be slow when the\n        number of observations n becomes large. If \"wait.to.decide\" is selected, \n        then a default is \"exact\" for n < 500 and \"approximate\" otherwise. \n        This option is only useful when the fitted surface is interpolated. If  \n        surface is \"exact\", an exact computation is always done for the trace. \n        Setting trace_hat to \"approximate\" for large dataset will substantially \n        reduce the computation time.\n        ";
static char __pyx_k_A_n_ndarray_of_weights_to_be_giv[] = "A (n,) ndarray of weights to be given to individual observations in the \n        sum of squared residuals that forms the local fitting criterion. If not\n        None, the weights should be non negative. If the different observations\n        have non-equal variances, the weights should be inversely proportional \n        to the variances.\n        By default, an unweighted fit is carried out (all the weights are one).\n        ";
static char __pyx_k_Can_t_predict_without_input_data[] = "Can't predict without input data !";
static char __pyx_k_Confidence_intervals_Lower_b_fit[] = "Confidence intervals....\nLower b./ fit / upper b.\n%s";
static char __pyx_k_Degree_should_be_between_0_and_2[] = "Degree should be between 0 and 2!";
static char __pyx_k_Incompatible_data_size_there_sho[] = "Incompatible data size: there should be as many rows as parameters";
static char __pyx_k_Invalid_number_of_iterations_sho[] = "Invalid number of iterations: should be positive";
static char __pyx_k_Invalid_size_of_the_weights_vect[] = "Invalid size of the 'weights' vector!";
static char __pyx_k_Invalid_value_for_the_cell_argum[] = "Invalid value for the cell argument: should be positive";
static char __pyx_k_Invalid_value_for_the_family_arg[] = "Invalid value for the 'family' argument: should be in ('symmetric', 'gaussian').";
static char __pyx_k_Invalid_value_for_the_statistics[] = "Invalid value for the 'statistics' argument: should be in ('approximate', 'exact').";
static char __pyx_k_Invalid_value_for_the_surface_ar[] = "Invalid value for the 'surface' argument: ";
static char __pyx_k_The_array_of_indepedent_varibale[] = "The array of indepedent varibales should be 2D at most!";
static char __pyx_k_The_coverage_precentage_should_b[] = "The coverage precentage should be between 0 and 1!";
static PyObject *__pyx_kp_s_Arguments_should_be_valid_loess;
static PyObject *__pyx_n_s_C;
static PyObject *__pyx_kp_s_Can_t_predict_without_input_data;
static PyObject *__pyx_kp_s_Cell_size_s;
static PyObject *__pyx_kp_s_Confidence_intervals_Lower_b_fit;
static PyObject *__pyx_kp_s_Control;
static PyObject *__pyx_kp_s_Degree_s;
static PyObject *__pyx_kp_s_Degree_should_be_between_0_and_2;
static PyObject *__pyx_kp_s_Degrees_of_freedom_s;
static PyObject *__pyx_kp_s_Deltas_s_s;
static PyObject *__pyx_kp_s_Drop_square_s;
static PyObject *__pyx_kp_s_Equivalent_Number_of_Parameters;
static PyObject *__pyx_kp_s_Eqv_nb_of_parameters_s;
static PyObject *__pyx_kp_s_Family_s;
static PyObject *__pyx_kp_s_Fit_flag_d;
static PyObject *__pyx_kp_s_Fitted_residuals_s;
static PyObject *__pyx_kp_s_Fitted_values_s;
static PyObject *__pyx_kp_s_Incompatible_data_size_there_sho;
static PyObject *__pyx_kp_s_Invalid_number_of_iterations_sho;
static PyObject *__pyx_kp_s_Invalid_size_of_the_weights_vect;
static PyObject *__pyx_kp_s_Invalid_value_for_the_cell_argum;
static PyObject *__pyx_kp_s_Invalid_value_for_the_family_arg;
static PyObject *__pyx_kp_s_Invalid_value_for_the_statistics;
static PyObject *__pyx_kp_s_Invalid_value_for_the_surface_ar;
static PyObject *__pyx_kp_s_Invalid_value_for_the_trace_hat;
static PyObject *__pyx_kp_s_Model_parameters;
static PyObject *__pyx_kp_s_Nb_iterations_s;
static PyObject *__pyx_kp_s_Normalization_factors_s;
static PyObject *__pyx_kp_s_Normalized_s;
static PyObject *__pyx_kp_s_Number_of_Observations_d;
static PyObject *__pyx_kp_s_Outputs;
static PyObject *__pyx_kp_s_Parametric_s;
static PyObject *__pyx_kp_s_Predicted_std_error_s;
static PyObject *__pyx_kp_s_Predicted_values_s;
static PyObject *__pyx_kp_s_Residual_Scale_Estimate_4f;
static PyObject *__pyx_kp_s_Residual_Standard_Error_4f;
static PyObject *__pyx_kp_s_Residual_error_s;
static PyObject *__pyx_kp_s_Residual_scale_s;
static PyObject *__pyx_kp_s_Span_s;
static PyObject *__pyx_kp_s_Span_should_be_between_0_and_1;
static PyObject *__pyx_kp_s_Statistics_s;
static PyObject *__pyx_kp_s_Surface_type_s;
static PyObject *__pyx_n_s_T;
static PyObject *__pyx_kp_s_The_array_of_indepedent_varibale;
static PyObject *__pyx_kp_s_The_coverage_precentage_should_b;
static PyObject *__pyx_kp_s_Trace_estimation_s;
static PyObject *__pyx_n_s_ValueError;
static PyObject *__pyx_kp_s__7;
static PyObject *__pyx_n_s_approximate;
static PyObject *__pyx_n_s_array;
static PyObject *__pyx_n_s_astype;
static PyObject *__pyx_n_s_atleast_1d;
static PyObject *__pyx_n_s_bool;
static PyObject *__pyx_n_s_cell;
static PyObject *__pyx_n_s_copy;
static PyObject *__pyx_n_s_coverage;
static PyObject *__pyx_n_s_degree;
static PyObject *__pyx_n_s_df;
static PyObject *__pyx_n_s_direct;
static PyObject *__pyx_n_s_divisor;
static PyObject *__pyx_n_s_drop_square;
static PyObject *__pyx_n_s_drop_square_flags;
static PyObject *__pyx_n_s_dtype;
static PyObject *__pyx_n_s_end;
static PyObject *__pyx_n_s_enp;
static PyObject *__pyx_n_s_exact;
static PyObject *__pyx_n_s_family;
static PyObject *__pyx_n_s_file;
static PyObject *__pyx_n_s_fitted_residuals;
static PyObject *__pyx_n_s_fitted_values;
static PyObject *__pyx_n_s_float;
static PyObject *__pyx_n_s_gaussian;
static PyObject *__pyx_n_s_get;
static PyObject *__pyx_n_s_import;
static PyObject *__pyx_n_s_interpolate;
static PyObject *__pyx_n_s_iterations;
static PyObject *__pyx_n_s_iteritems;
static PyObject *__pyx_n_s_join;
static PyObject *__pyx_kp_s_loess_object_model_parameters;
static PyObject *__pyx_n_s_loess_one;
static PyObject *__pyx_n_s_loess_two;
static PyObject *__pyx_n_s_lower;
static PyObject *__pyx_n_s_main;
static PyObject *__pyx_n_s_narray;
static PyObject *__pyx_n_s_ndim;
static PyObject *__pyx_n_s_newdata;
static PyObject *__pyx_n_s_normalize;
static PyObject *__pyx_n_s_numpy;
static PyObject *__pyx_n_s_one_delta;
static PyObject *__pyx_n_s_ones;
static PyObject *__pyx_n_s_order;
static PyObject *__pyx_n_s_outputs;
static PyObject *__pyx_n_s_parametric;
static PyObject *__pyx_n_s_parametric_flags;
static PyObject *__pyx_n_s_print;
static PyObject *__pyx_n_s_pyx_vtable;
static PyObject *__pyx_n_s_r;
static PyObject *__pyx_n_s_ravel;
static PyObject *__pyx_n_s_residual_scale;
static PyObject *__pyx_n_s_s;
static PyObject *__pyx_n_s_shape;
static PyObject *__pyx_kp_s_should_be_in_interpolate_direct;
static PyObject *__pyx_n_s_size;
static PyObject *__pyx_n_s_span;
static PyObject *__pyx_n_s_statistics;
static PyObject *__pyx_n_s_stderr;
static PyObject *__pyx_n_s_stderror;
static PyObject *__pyx_n_s_subok;
static PyObject *__pyx_n_s_surface;
static PyObject *__pyx_n_s_symmetric;
static PyObject *__pyx_n_s_test;
static PyObject *__pyx_n_s_trace_hat;
static PyObject *__pyx_n_s_two_delta;
static PyObject *__pyx_n_s_update;
static PyObject *__pyx_n_s_values;
static PyObject *__pyx_n_s_weights;
static PyObject *__pyx_n_s_x;
static PyObject *__pyx_n_s_x_data;
static PyObject *__pyx_n_s_y;
static PyObject *__pyx_n_s_y_data;
static PyObject *__pyx_float_0_;
static PyObject *__pyx_float_1_;
static PyObject *__pyx_float_0_5;
static PyObject *__pyx_float_0_95;
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_tuple_;
static PyObject *__pyx_tuple__2;
static PyObject *__pyx_tuple__3;
static PyObject *__pyx_tuple__4;
static PyObject *__pyx_tuple__5;
static PyObject *__pyx_tuple__6;
static PyObject *__pyx_tuple__8;
static PyObject *__pyx_tuple__9;
static PyObject *__pyx_tuple__10;
static PyObject *__pyx_tuple__11;
static PyObject *__pyx_tuple__12;
static PyObject *__pyx_tuple__13;

/* "_loess.pyx":17
 * cimport c_loess
 * 
 * cdef floatarray_from_data(int rows, int cols, double *data):             # <<<<<<<<<<<<<<
 *     cdef ndarray a_ndr
 *     cdef npy_intp size
 */

static PyObject *__pyx_f_6_loess_floatarray_from_data(int __pyx_v_rows, int __pyx_v_cols, double *__pyx_v_data) {
  PyArrayObject *__pyx_v_a_ndr = 0;
  npy_intp __pyx_v_size;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("floatarray_from_data", 0);

  /* "_loess.pyx":20
 *     cdef ndarray a_ndr
 *     cdef npy_intp size
 *     size = rows*cols             # <<<<<<<<<<<<<<
 *     a_ndr = <object>PyArray_SimpleNewFromData(1, &size, NPY_DOUBLE, data)
 *     if cols > 1:
 */
  __pyx_v_size = (__pyx_v_rows * __pyx_v_cols);

  /* "_loess.pyx":21
 *     cdef npy_intp size
 *     size = rows*cols
 *     a_ndr = <object>PyArray_SimpleNewFromData(1, &size, NPY_DOUBLE, data)             # <<<<<<<<<<<<<<
 *     if cols > 1:
 *         a_ndr.shape = (rows, cols)
 */
  __pyx_t_1 = PyArray_SimpleNewFromData(1, (&__pyx_v_size), NPY_DOUBLE, __pyx_v_data); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = ((PyObject *)__pyx_t_1);
  __Pyx_INCREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_a_ndr = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":22
 *     size = rows*cols
 *     a_ndr = <object>PyArray_SimpleNewFromData(1, &size, NPY_DOUBLE, data)
 *     if cols > 1:             # <<<<<<<<<<<<<<
 *         a_ndr.shape = (rows, cols)
 *     return a_ndr
 */
  __pyx_t_3 = ((__pyx_v_cols > 1) != 0);
  if (__pyx_t_3) {

    /* "_loess.pyx":23
 *     a_ndr = <object>PyArray_SimpleNewFromData(1, &size, NPY_DOUBLE, data)
 *     if cols > 1:
 *         a_ndr.shape = (rows, cols)             # <<<<<<<<<<<<<<
 *     return a_ndr
 * 
 */
    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_rows); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_cols); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_a_ndr), __pyx_n_s_shape, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "_loess.pyx":24
 *     if cols > 1:
 *         a_ndr.shape = (rows, cols)
 *     return a_ndr             # <<<<<<<<<<<<<<
 * 
 * cdef boolarray_from_data(int rows, int cols, int *data):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_a_ndr));
  __pyx_r = ((PyObject *)__pyx_v_a_ndr);
  goto __pyx_L0;

  /* "_loess.pyx":17
 * cimport c_loess
 * 
 * cdef floatarray_from_data(int rows, int cols, double *data):             # <<<<<<<<<<<<<<
 *     cdef ndarray a_ndr
 *     cdef npy_intp size
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("_loess.floatarray_from_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_a_ndr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":26
 *     return a_ndr
 * 
 * cdef boolarray_from_data(int rows, int cols, int *data):             # <<<<<<<<<<<<<<
 *     cdef ndarray a_ndr
 *     cdef npy_intp size
 */

static PyObject *__pyx_f_6_loess_boolarray_from_data(int __pyx_v_rows, int __pyx_v_cols, int *__pyx_v_data) {
  PyArrayObject *__pyx_v_a_ndr = 0;
  npy_intp __pyx_v_size;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("boolarray_from_data", 0);

  /* "_loess.pyx":29
 *     cdef ndarray a_ndr
 *     cdef npy_intp size
 *     size = rows*cols             # <<<<<<<<<<<<<<
 *     a_ndr = <object>PyArray_SimpleNewFromData(1, &size, NPY_DOUBLE, data)
 *     if cols > 1:
 */
  __pyx_v_size = (__pyx_v_rows * __pyx_v_cols);

  /* "_loess.pyx":30
 *     cdef npy_intp size
 *     size = rows*cols
 *     a_ndr = <object>PyArray_SimpleNewFromData(1, &size, NPY_DOUBLE, data)             # <<<<<<<<<<<<<<
 *     if cols > 1:
 *         a_ndr.shape = (rows, cols)
 */
  __pyx_t_1 = PyArray_SimpleNewFromData(1, (&__pyx_v_size), NPY_DOUBLE, __pyx_v_data); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = ((PyObject *)__pyx_t_1);
  __Pyx_INCREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_a_ndr = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":31
 *     size = rows*cols
 *     a_ndr = <object>PyArray_SimpleNewFromData(1, &size, NPY_DOUBLE, data)
 *     if cols > 1:             # <<<<<<<<<<<<<<
 *         a_ndr.shape = (rows, cols)
 *     return a_ndr.astype(numpy.bool)
 */
  __pyx_t_3 = ((__pyx_v_cols > 1) != 0);
  if (__pyx_t_3) {

    /* "_loess.pyx":32
 *     a_ndr = <object>PyArray_SimpleNewFromData(1, &size, NPY_DOUBLE, data)
 *     if cols > 1:
 *         a_ndr.shape = (rows, cols)             # <<<<<<<<<<<<<<
 *     return a_ndr.astype(numpy.bool)
 * 
 */
    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_rows); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_cols); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_a_ndr), __pyx_n_s_shape, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "_loess.pyx":33
 *     if cols > 1:
 *         a_ndr.shape = (rows, cols)
 *     return a_ndr.astype(numpy.bool)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_a_ndr), __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_bool); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __Pyx_GIVEREF(__pyx_t_2); __pyx_t_2 = NULL;
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":26
 *     return a_ndr
 * 
 * cdef boolarray_from_data(int rows, int cols, int *data):             # <<<<<<<<<<<<<<
 *     cdef ndarray a_ndr
 *     cdef npy_intp size
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("_loess.boolarray_from_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_a_ndr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":87
 *     cdef readonly int nobs, npar
 *     #.........
 *     def __init__(self, x_data, y_data):             # <<<<<<<<<<<<<<
 *         cdef ndarray unmasked
 *         self.x = narray(x_data, copy=False, subok=True, dtype=float_, order='C')
 */

/* Python wrapper */
static int __pyx_pw_6_loess_12loess_inputs_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6_loess_12loess_inputs_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x_data = 0;
  PyObject *__pyx_v_y_data = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x_data,&__pyx_n_s_y_data,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x_data)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y_data)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_x_data = values[0];
    __pyx_v_y_data = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("_loess.loess_inputs.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6_loess_12loess_inputs___init__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self), __pyx_v_x_data, __pyx_v_y_data);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_12loess_inputs___init__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self, PyObject *__pyx_v_x_data, PyObject *__pyx_v_y_data) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__", 0);

  /* "_loess.pyx":89
 *     def __init__(self, x_data, y_data):
 *         cdef ndarray unmasked
 *         self.x = narray(x_data, copy=False, subok=True, dtype=float_, order='C')             # <<<<<<<<<<<<<<
 *         self.y = narray(y_data, copy=False, subok=True, dtype=float_, order='C')
 *         # Check the dimensions ........
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_narray); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_x_data);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_x_data);
  __Pyx_GIVEREF(__pyx_v_x_data);
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_subok, Py_True) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_float); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_C) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GIVEREF(__pyx_t_4);
  __Pyx_GOTREF(__pyx_v_self->x);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->x));
  __pyx_v_self->x = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "_loess.pyx":90
 *         cdef ndarray unmasked
 *         self.x = narray(x_data, copy=False, subok=True, dtype=float_, order='C')
 *         self.y = narray(y_data, copy=False, subok=True, dtype=float_, order='C')             # <<<<<<<<<<<<<<
 *         # Check the dimensions ........
 *         if self.x.ndim == 1:
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_narray); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_v_y_data);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_y_data);
  __Pyx_GIVEREF(__pyx_v_y_data);
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_copy, Py_False) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_subok, Py_True) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_float); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_order, __pyx_n_s_C) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->y);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->y));
  __pyx_v_self->y = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":92
 *         self.y = narray(y_data, copy=False, subok=True, dtype=float_, order='C')
 *         # Check the dimensions ........
 *         if self.x.ndim == 1:             # <<<<<<<<<<<<<<
 *             self.npar = 1
 *         elif self.x.ndim == 2:
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->x), __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_int_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {

    /* "_loess.pyx":93
 *         # Check the dimensions ........
 *         if self.x.ndim == 1:
 *             self.npar = 1             # <<<<<<<<<<<<<<
 *         elif self.x.ndim == 2:
 *             self.npar = self.x.shape[-1]
 */
    __pyx_v_self->npar = 1;
    goto __pyx_L3;
  }

  /* "_loess.pyx":94
 *         if self.x.ndim == 1:
 *             self.npar = 1
 *         elif self.x.ndim == 2:             # <<<<<<<<<<<<<<
 *             self.npar = self.x.shape[-1]
 *         else:
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->x), __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_int_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {

    /* "_loess.pyx":95
 *             self.npar = 1
 *         elif self.x.ndim == 2:
 *             self.npar = self.x.shape[-1]             # <<<<<<<<<<<<<<
 *         else:
 *             raise ValueError("The array of indepedent varibales should be 2D at most!")
 */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->x), __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, -1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_6 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_self->npar = __pyx_t_6;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "_loess.pyx":97
 *             self.npar = self.x.shape[-1]
 *         else:
 *             raise ValueError("The array of indepedent varibales should be 2D at most!")             # <<<<<<<<<<<<<<
 *         self.nobs = len(self.x)
 *         # Get the effective data ......
 */
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_L3:;

  /* "_loess.pyx":98
 *         else:
 *             raise ValueError("The array of indepedent varibales should be 2D at most!")
 *         self.nobs = len(self.x)             # <<<<<<<<<<<<<<
 *         # Get the effective data ......
 *         self.x_eff = self.x.ravel()
 */
  __pyx_t_2 = ((PyObject *)__pyx_v_self->x);
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_7 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_self->nobs = __pyx_t_7;

  /* "_loess.pyx":100
 *         self.nobs = len(self.x)
 *         # Get the effective data ......
 *         self.x_eff = self.x.ravel()             # <<<<<<<<<<<<<<
 *         self.y_eff = self.y
 *         self.w_ndr = numpy.ones((self.nobs,), dtype=float_)
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->x), __pyx_n_s_ravel); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->x_eff);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->x_eff));
  __pyx_v_self->x_eff = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":101
 *         # Get the effective data ......
 *         self.x_eff = self.x.ravel()
 *         self.y_eff = self.y             # <<<<<<<<<<<<<<
 *         self.w_ndr = numpy.ones((self.nobs,), dtype=float_)
 * 
 */
  __pyx_t_2 = ((PyObject *)__pyx_v_self->y);
  __Pyx_INCREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->y_eff);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->y_eff));
  __pyx_v_self->y_eff = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":102
 *         self.x_eff = self.x.ravel()
 *         self.y_eff = self.y
 *         self.w_ndr = numpy.ones((self.nobs,), dtype=float_)             # <<<<<<<<<<<<<<
 * 
 *     #.........
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->nobs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_float); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GIVEREF(__pyx_t_4);
  __Pyx_GOTREF(__pyx_v_self->w_ndr);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->w_ndr));
  __pyx_v_self->w_ndr = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "_loess.pyx":87
 *     cdef readonly int nobs, npar
 *     #.........
 *     def __init__(self, x_data, y_data):             # <<<<<<<<<<<<<<
 *         cdef ndarray unmasked
 *         self.x = narray(x_data, copy=False, subok=True, dtype=float_, order='C')
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("_loess.loess_inputs.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":113
 *         By default, an unweighted fit is carried out (all the weights are one).
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self.w_ndr
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_12loess_inputs_7weights_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_12loess_inputs_7weights_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_7weights___get__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_12loess_inputs_7weights___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":114
 *         """
 *         def __get__(self):
 *             return self.w_ndr             # <<<<<<<<<<<<<<
 * 
 *         def __set__(self, w):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->w_ndr));
  __pyx_r = ((PyObject *)__pyx_v_self->w_ndr);
  goto __pyx_L0;

  /* "_loess.pyx":113
 *         By default, an unweighted fit is carried out (all the weights are one).
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self.w_ndr
 * 
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":116
 *             return self.w_ndr
 * 
 *         def __set__(self, w):             # <<<<<<<<<<<<<<
 *             cdef npy_intp *dims
 *             cdef ndarray w_ndr
 */

/* Python wrapper */
static int __pyx_pw_6_loess_12loess_inputs_7weights_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_w); /*proto*/
static int __pyx_pw_6_loess_12loess_inputs_7weights_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_w) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_7weights_2__set__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self), ((PyObject *)__pyx_v_w));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_12loess_inputs_7weights_2__set__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self, PyObject *__pyx_v_w) {
  PyArrayObject *__pyx_v_w_ndr = 0;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":119
 *             cdef npy_intp *dims
 *             cdef ndarray w_ndr
 *             w_ndr = narray(w, copy=False, subok=False)             # <<<<<<<<<<<<<<
 *             if w_ndr.ndim > 1 or w_ndr.size != self.nobs:
 *                 raise ValueError("Invalid size of the 'weights' vector!")
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_narray); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_w);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_w);
  __Pyx_GIVEREF(__pyx_v_w);
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_subok, Py_False) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_w_ndr = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "_loess.pyx":120
 *             cdef ndarray w_ndr
 *             w_ndr = narray(w, copy=False, subok=False)
 *             if w_ndr.ndim > 1 or w_ndr.size != self.nobs:             # <<<<<<<<<<<<<<
 *                 raise ValueError("Invalid size of the 'weights' vector!")
 *             self.w_ndr = w_ndr
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_w_ndr), __pyx_n_s_ndim); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_w_ndr), __pyx_n_s_size); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_self->nobs); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_t_4, Py_NE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {

    /* "_loess.pyx":121
 *             w_ndr = narray(w, copy=False, subok=False)
 *             if w_ndr.ndim > 1 or w_ndr.size != self.nobs:
 *                 raise ValueError("Invalid size of the 'weights' vector!")             # <<<<<<<<<<<<<<
 *             self.w_ndr = w_ndr
 *             self._base.weights = <double *>w_ndr.data
 */
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":122
 *             if w_ndr.ndim > 1 or w_ndr.size != self.nobs:
 *                 raise ValueError("Invalid size of the 'weights' vector!")
 *             self.w_ndr = w_ndr             # <<<<<<<<<<<<<<
 *             self._base.weights = <double *>w_ndr.data
 * #
 */
  __Pyx_INCREF(((PyObject *)__pyx_v_w_ndr));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_w_ndr));
  __Pyx_GOTREF(__pyx_v_self->w_ndr);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->w_ndr));
  __pyx_v_self->w_ndr = __pyx_v_w_ndr;

  /* "_loess.pyx":123
 *                 raise ValueError("Invalid size of the 'weights' vector!")
 *             self.w_ndr = w_ndr
 *             self._base.weights = <double *>w_ndr.data             # <<<<<<<<<<<<<<
 * #
 * ######---------------------------------------------------------------------------
 */
  __pyx_v_self->_base->weights = ((double *)__pyx_v_w_ndr->data);

  /* "_loess.pyx":116
 *             return self.w_ndr
 * 
 *         def __set__(self, w):             # <<<<<<<<<<<<<<
 *             cdef npy_intp *dims
 *             cdef ndarray w_ndr
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("_loess.loess_inputs.weights.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_w_ndr);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":84
 *     cdef c_loess.c_loess_inputs *_base
 *     cdef ndarray w_ndr
 *     cdef readonly ndarray x, y, masked, x_eff, y_eff             # <<<<<<<<<<<<<<
 *     cdef readonly int nobs, npar
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_12loess_inputs_1x_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_12loess_inputs_1x_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_1x___get__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_12loess_inputs_1x___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->x));
  __pyx_r = ((PyObject *)__pyx_v_self->x);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_12loess_inputs_1y_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_12loess_inputs_1y_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_1y___get__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_12loess_inputs_1y___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->y));
  __pyx_r = ((PyObject *)__pyx_v_self->y);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_12loess_inputs_6masked_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_12loess_inputs_6masked_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_6masked___get__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_12loess_inputs_6masked___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->masked));
  __pyx_r = ((PyObject *)__pyx_v_self->masked);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_12loess_inputs_5x_eff_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_12loess_inputs_5x_eff_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_5x_eff___get__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_12loess_inputs_5x_eff___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->x_eff));
  __pyx_r = ((PyObject *)__pyx_v_self->x_eff);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_12loess_inputs_5y_eff_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_12loess_inputs_5y_eff_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_5y_eff___get__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_12loess_inputs_5y_eff___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->y_eff));
  __pyx_r = ((PyObject *)__pyx_v_self->y_eff);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":85
 *     cdef ndarray w_ndr
 *     cdef readonly ndarray x, y, masked, x_eff, y_eff
 *     cdef readonly int nobs, npar             # <<<<<<<<<<<<<<
 *     #.........
 *     def __init__(self, x_data, y_data):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_12loess_inputs_4nobs_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_12loess_inputs_4nobs_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_4nobs___get__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_12loess_inputs_4nobs___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->nobs); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_inputs.nobs.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_12loess_inputs_4npar_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_12loess_inputs_4npar_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_12loess_inputs_4npar___get__(((struct __pyx_obj_6_loess_loess_inputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_12loess_inputs_4npar___get__(struct __pyx_obj_6_loess_loess_inputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->npar); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_inputs.npar.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":173
 *         circumstances warrant.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.surface
 *         def __set__(self, surface):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_control_7surface_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_control_7surface_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_7surface___get__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_control_7surface___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":174
 *         """
 *         def __get__(self):
 *             return self._base.surface             # <<<<<<<<<<<<<<
 *         def __set__(self, surface):
 *             if surface.lower() not in ('interpolate', 'direct'):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_self->_base->surface); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":173
 *         circumstances warrant.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.surface
 *         def __set__(self, surface):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_control.surface.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":175
 *         def __get__(self):
 *             return self._base.surface
 *         def __set__(self, surface):             # <<<<<<<<<<<<<<
 *             if surface.lower() not in ('interpolate', 'direct'):
 *                 raise ValueError("Invalid value for the 'surface' argument: "+
 */

/* Python wrapper */
static int __pyx_pw_6_loess_13loess_control_7surface_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_surface); /*proto*/
static int __pyx_pw_6_loess_13loess_control_7surface_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_surface) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_7surface_2__set__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self), ((PyObject *)__pyx_v_surface));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_13loess_control_7surface_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_surface) {
  PyObject *__pyx_v_tmpx = NULL;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  char *__pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":176
 *             return self._base.surface
 *         def __set__(self, surface):
 *             if surface.lower() not in ('interpolate', 'direct'):             # <<<<<<<<<<<<<<
 *                 raise ValueError("Invalid value for the 'surface' argument: "+
 *                                  "should be in ('interpolate', 'direct').")
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_surface, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_n_s_interpolate, Py_NE)); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_n_s_direct, Py_NE)); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = (__pyx_t_4 != 0);
  if (__pyx_t_5) {

    /* "_loess.pyx":177
 *         def __set__(self, surface):
 *             if surface.lower() not in ('interpolate', 'direct'):
 *                 raise ValueError("Invalid value for the 'surface' argument: "+             # <<<<<<<<<<<<<<
 *                                  "should be in ('interpolate', 'direct').")
 *             tmpx = surface.lower()
 */
    __pyx_t_1 = PyNumber_Add(__pyx_kp_s_Invalid_value_for_the_surface_ar, __pyx_kp_s_should_be_in_interpolate_direct); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":179
 *                 raise ValueError("Invalid value for the 'surface' argument: "+
 *                                  "should be in ('interpolate', 'direct').")
 *             tmpx = surface.lower()             # <<<<<<<<<<<<<<
 *             self._base.surface = tmpx
 *     #.........
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_surface, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_tmpx = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":180
 *                                  "should be in ('interpolate', 'direct').")
 *             tmpx = surface.lower()
 *             self._base.surface = tmpx             # <<<<<<<<<<<<<<
 *     #.........
 *     property statistics:
 */
  __pyx_t_6 = __Pyx_PyObject_AsString(__pyx_v_tmpx); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->surface = __pyx_t_6;

  /* "_loess.pyx":175
 *         def __get__(self):
 *             return self._base.surface
 *         def __set__(self, surface):             # <<<<<<<<<<<<<<
 *             if surface.lower() not in ('interpolate', 'direct'):
 *                 raise ValueError("Invalid value for the 'surface' argument: "+
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("_loess.loess_control.surface.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_tmpx);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":190
 *         for routine usage because computation time can be horrendous.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.statistics
 *         def __set__(self, statistics):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_control_10statistics_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_control_10statistics_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_10statistics___get__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_control_10statistics___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":191
 *         """
 *         def __get__(self):
 *             return self._base.statistics             # <<<<<<<<<<<<<<
 *         def __set__(self, statistics):
 *             if statistics.lower() not in ('approximate', 'exact'):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_self->_base->statistics); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":190
 *         for routine usage because computation time can be horrendous.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.statistics
 *         def __set__(self, statistics):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_control.statistics.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":192
 *         def __get__(self):
 *             return self._base.statistics
 *         def __set__(self, statistics):             # <<<<<<<<<<<<<<
 *             if statistics.lower() not in ('approximate', 'exact'):
 *                 raise ValueError("Invalid value for the 'statistics' argument: "\
 */

/* Python wrapper */
static int __pyx_pw_6_loess_13loess_control_10statistics_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_statistics); /*proto*/
static int __pyx_pw_6_loess_13loess_control_10statistics_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_statistics) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_10statistics_2__set__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self), ((PyObject *)__pyx_v_statistics));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_13loess_control_10statistics_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_statistics) {
  PyObject *__pyx_v_tmpx = NULL;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  char *__pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":193
 *             return self._base.statistics
 *         def __set__(self, statistics):
 *             if statistics.lower() not in ('approximate', 'exact'):             # <<<<<<<<<<<<<<
 *                 raise ValueError("Invalid value for the 'statistics' argument: "\
 *                                  "should be in ('approximate', 'exact').")
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_statistics, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_n_s_approximate, Py_NE)); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_n_s_exact, Py_NE)); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = (__pyx_t_4 != 0);
  if (__pyx_t_5) {

    /* "_loess.pyx":194
 *         def __set__(self, statistics):
 *             if statistics.lower() not in ('approximate', 'exact'):
 *                 raise ValueError("Invalid value for the 'statistics' argument: "\             # <<<<<<<<<<<<<<
 *                                  "should be in ('approximate', 'exact').")
 *             tmpx = statistics.lower()
 */
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":196
 *                 raise ValueError("Invalid value for the 'statistics' argument: "\
 *                                  "should be in ('approximate', 'exact').")
 *             tmpx = statistics.lower()             # <<<<<<<<<<<<<<
 *             self._base.statistics = tmpx
 *     #.........
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_statistics, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_tmpx = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":197
 *                                  "should be in ('approximate', 'exact').")
 *             tmpx = statistics.lower()
 *             self._base.statistics = tmpx             # <<<<<<<<<<<<<<
 *     #.........
 *     property trace_hat:
 */
  __pyx_t_6 = __Pyx_PyObject_AsString(__pyx_v_tmpx); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->statistics = __pyx_t_6;

  /* "_loess.pyx":192
 *         def __get__(self):
 *             return self._base.statistics
 *         def __set__(self, statistics):             # <<<<<<<<<<<<<<
 *             if statistics.lower() not in ('approximate', 'exact'):
 *                 raise ValueError("Invalid value for the 'statistics' argument: "\
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("_loess.loess_control.statistics.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_tmpx);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":212
 *         reduce the computation time.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.trace_hat
 *         def __set__(self, trace_hat):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_control_9trace_hat_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_control_9trace_hat_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_9trace_hat___get__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_control_9trace_hat___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":213
 *         """
 *         def __get__(self):
 *             return self._base.trace_hat             # <<<<<<<<<<<<<<
 *         def __set__(self, trace_hat):
 *             if trace_hat.lower() not in ('approximate', 'exact'):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_self->_base->trace_hat); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":212
 *         reduce the computation time.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.trace_hat
 *         def __set__(self, trace_hat):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_control.trace_hat.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":214
 *         def __get__(self):
 *             return self._base.trace_hat
 *         def __set__(self, trace_hat):             # <<<<<<<<<<<<<<
 *             if trace_hat.lower() not in ('approximate', 'exact'):
 *                 raise ValueError("Invalid value for the 'trace_hat' argument: "\
 */

/* Python wrapper */
static int __pyx_pw_6_loess_13loess_control_9trace_hat_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_trace_hat); /*proto*/
static int __pyx_pw_6_loess_13loess_control_9trace_hat_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_trace_hat) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_9trace_hat_2__set__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self), ((PyObject *)__pyx_v_trace_hat));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_13loess_control_9trace_hat_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_trace_hat) {
  PyObject *__pyx_v_tmpx = NULL;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  char *__pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":215
 *             return self._base.trace_hat
 *         def __set__(self, trace_hat):
 *             if trace_hat.lower() not in ('approximate', 'exact'):             # <<<<<<<<<<<<<<
 *                 raise ValueError("Invalid value for the 'trace_hat' argument: "\
 *                                  "should be in ('approximate', 'exact').")
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_trace_hat, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_n_s_approximate, Py_NE)); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_n_s_exact, Py_NE)); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = (__pyx_t_4 != 0);
  if (__pyx_t_5) {

    /* "_loess.pyx":216
 *         def __set__(self, trace_hat):
 *             if trace_hat.lower() not in ('approximate', 'exact'):
 *                 raise ValueError("Invalid value for the 'trace_hat' argument: "\             # <<<<<<<<<<<<<<
 *                                  "should be in ('approximate', 'exact').")
 *             tmpx = trace_hat.lower()
 */
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":218
 *                 raise ValueError("Invalid value for the 'trace_hat' argument: "\
 *                                  "should be in ('approximate', 'exact').")
 *             tmpx = trace_hat.lower()             # <<<<<<<<<<<<<<
 *             self._base.trace_hat = tmpx
 *     #.........
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_trace_hat, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_tmpx = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":219
 *                                  "should be in ('approximate', 'exact').")
 *             tmpx = trace_hat.lower()
 *             self._base.trace_hat = tmpx             # <<<<<<<<<<<<<<
 *     #.........
 *     property iterations:
 */
  __pyx_t_6 = __Pyx_PyObject_AsString(__pyx_v_tmpx); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->trace_hat = __pyx_t_6;

  /* "_loess.pyx":214
 *         def __get__(self):
 *             return self._base.trace_hat
 *         def __set__(self, trace_hat):             # <<<<<<<<<<<<<<
 *             if trace_hat.lower() not in ('approximate', 'exact'):
 *                 raise ValueError("Invalid value for the 'trace_hat' argument: "\
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("_loess.loess_control.trace_hat.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_tmpx);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":227
 *         "gaussian", the number of iterations is set to 0.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.iterations
 *         def __set__(self, iterations):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_control_10iterations_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_control_10iterations_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_10iterations___get__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_control_10iterations___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":228
 *         """
 *         def __get__(self):
 *             return self._base.iterations             # <<<<<<<<<<<<<<
 *         def __set__(self, iterations):
 *             if iterations < 0:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->_base->iterations); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":227
 *         "gaussian", the number of iterations is set to 0.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.iterations
 *         def __set__(self, iterations):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_control.iterations.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":229
 *         def __get__(self):
 *             return self._base.iterations
 *         def __set__(self, iterations):             # <<<<<<<<<<<<<<
 *             if iterations < 0:
 *                 raise ValueError("Invalid number of iterations: should be positive")
 */

/* Python wrapper */
static int __pyx_pw_6_loess_13loess_control_10iterations_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_iterations); /*proto*/
static int __pyx_pw_6_loess_13loess_control_10iterations_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_iterations) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_10iterations_2__set__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self), ((PyObject *)__pyx_v_iterations));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_13loess_control_10iterations_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_iterations) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":230
 *             return self._base.iterations
 *         def __set__(self, iterations):
 *             if iterations < 0:             # <<<<<<<<<<<<<<
 *                 raise ValueError("Invalid number of iterations: should be positive")
 *             self._base.iterations = iterations
 */
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_iterations, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {

    /* "_loess.pyx":231
 *         def __set__(self, iterations):
 *             if iterations < 0:
 *                 raise ValueError("Invalid number of iterations: should be positive")             # <<<<<<<<<<<<<<
 *             self._base.iterations = iterations
 *     #.........
 */
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":232
 *             if iterations < 0:
 *                 raise ValueError("Invalid number of iterations: should be positive")
 *             self._base.iterations = iterations             # <<<<<<<<<<<<<<
 *     #.........
 *     property cell:
 */
  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_v_iterations); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->iterations = __pyx_t_3;

  /* "_loess.pyx":229
 *         def __get__(self):
 *             return self._base.iterations
 *         def __set__(self, iterations):             # <<<<<<<<<<<<<<
 *             if iterations < 0:
 *                 raise ValueError("Invalid number of iterations: should be positive")
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_control.iterations.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":243
 *         is interpolated.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.cell
 *         def __set__(self, cell):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_control_4cell_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_control_4cell_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_4cell___get__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_control_4cell___get__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":244
 *         """
 *         def __get__(self):
 *             return self._base.cell             # <<<<<<<<<<<<<<
 *         def __set__(self, cell):
 *             if cell <= 0:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base->cell); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":243
 *         is interpolated.
 *         """
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.cell
 *         def __set__(self, cell):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_control.cell.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":245
 *         def __get__(self):
 *             return self._base.cell
 *         def __set__(self, cell):             # <<<<<<<<<<<<<<
 *             if cell <= 0:
 *                 raise ValueError("Invalid value for the cell argument: should be positive")
 */

/* Python wrapper */
static int __pyx_pw_6_loess_13loess_control_4cell_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_cell); /*proto*/
static int __pyx_pw_6_loess_13loess_control_4cell_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_cell) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_4cell_2__set__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self), ((PyObject *)__pyx_v_cell));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_13loess_control_4cell_2__set__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_cell) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  double __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":246
 *             return self._base.cell
 *         def __set__(self, cell):
 *             if cell <= 0:             # <<<<<<<<<<<<<<
 *                 raise ValueError("Invalid value for the cell argument: should be positive")
 *             self._base.cell = cell
 */
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_cell, __pyx_int_0, Py_LE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {

    /* "_loess.pyx":247
 *         def __set__(self, cell):
 *             if cell <= 0:
 *                 raise ValueError("Invalid value for the cell argument: should be positive")             # <<<<<<<<<<<<<<
 *             self._base.cell = cell
 *     #.........
 */
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":248
 *             if cell <= 0:
 *                 raise ValueError("Invalid value for the cell argument: should be positive")
 *             self._base.cell = cell             # <<<<<<<<<<<<<<
 *     #.........
 *     def update(self, **cellargs):
 */
  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_v_cell); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->cell = __pyx_t_3;

  /* "_loess.pyx":245
 *         def __get__(self):
 *             return self._base.cell
 *         def __set__(self, cell):             # <<<<<<<<<<<<<<
 *             if cell <= 0:
 *                 raise ValueError("Invalid value for the cell argument: should be positive")
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_control.cell.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":250
 *             self._base.cell = cell
 *     #.........
 *     def update(self, **cellargs):             # <<<<<<<<<<<<<<
 *         """Updates several parameters at once."""
 *         surface = cellargs.get('surface', None)
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_control_1update(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6_loess_13loess_control_update[] = "Updates several parameters at once.";
static PyObject *__pyx_pw_6_loess_13loess_control_1update(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_cellargs = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("update (wrapper)", 0);
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("update", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return NULL;}
  if (__pyx_kwds && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "update", 1))) return NULL;
  __pyx_v_cellargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_cellargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_cellargs);
  __pyx_r = __pyx_pf_6_loess_13loess_control_update(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self), __pyx_v_cellargs);

  /* function exit code */
  __Pyx_XDECREF(__pyx_v_cellargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_control_update(struct __pyx_obj_6_loess_loess_control *__pyx_v_self, PyObject *__pyx_v_cellargs) {
  PyObject *__pyx_v_surface = NULL;
  PyObject *__pyx_v_statistics = NULL;
  PyObject *__pyx_v_trace_hat = NULL;
  PyObject *__pyx_v_iterations = NULL;
  PyObject *__pyx_v_cell = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("update", 0);

  /* "_loess.pyx":252
 *     def update(self, **cellargs):
 *         """Updates several parameters at once."""
 *         surface = cellargs.get('surface', None)             # <<<<<<<<<<<<<<
 *         if surface is not None:
 *             self.surface = surface
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_cellargs, __pyx_n_s_surface, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_surface = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":253
 *         """Updates several parameters at once."""
 *         surface = cellargs.get('surface', None)
 *         if surface is not None:             # <<<<<<<<<<<<<<
 *             self.surface = surface
 *         #
 */
  __pyx_t_2 = (__pyx_v_surface != Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "_loess.pyx":254
 *         surface = cellargs.get('surface', None)
 *         if surface is not None:
 *             self.surface = surface             # <<<<<<<<<<<<<<
 *         #
 *         statistics = cellargs.get('statistics', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_surface, __pyx_v_surface) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "_loess.pyx":256
 *             self.surface = surface
 *         #
 *         statistics = cellargs.get('statistics', None)             # <<<<<<<<<<<<<<
 *         if statistics is not None:
 *             self.statistics = statistics
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_cellargs, __pyx_n_s_statistics, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_statistics = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":257
 *         #
 *         statistics = cellargs.get('statistics', None)
 *         if statistics is not None:             # <<<<<<<<<<<<<<
 *             self.statistics = statistics
 *         #
 */
  __pyx_t_3 = (__pyx_v_statistics != Py_None);
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {

    /* "_loess.pyx":258
 *         statistics = cellargs.get('statistics', None)
 *         if statistics is not None:
 *             self.statistics = statistics             # <<<<<<<<<<<<<<
 *         #
 *         trace_hat = cellargs.get('trace_hat', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_statistics, __pyx_v_statistics) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "_loess.pyx":260
 *             self.statistics = statistics
 *         #
 *         trace_hat = cellargs.get('trace_hat', None)             # <<<<<<<<<<<<<<
 *         if trace_hat is not None:
 *             self.trace_hat = trace_hat
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_cellargs, __pyx_n_s_trace_hat, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_trace_hat = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":261
 *         #
 *         trace_hat = cellargs.get('trace_hat', None)
 *         if trace_hat is not None:             # <<<<<<<<<<<<<<
 *             self.trace_hat = trace_hat
 *         #
 */
  __pyx_t_2 = (__pyx_v_trace_hat != Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "_loess.pyx":262
 *         trace_hat = cellargs.get('trace_hat', None)
 *         if trace_hat is not None:
 *             self.trace_hat = trace_hat             # <<<<<<<<<<<<<<
 *         #
 *         iterations = cellargs.get('iterations', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_trace_hat, __pyx_v_trace_hat) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "_loess.pyx":264
 *             self.trace_hat = trace_hat
 *         #
 *         iterations = cellargs.get('iterations', None)             # <<<<<<<<<<<<<<
 *         if iterations is not None:
 *             self.iterations = iterations
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_cellargs, __pyx_n_s_iterations, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_iterations = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":265
 *         #
 *         iterations = cellargs.get('iterations', None)
 *         if iterations is not None:             # <<<<<<<<<<<<<<
 *             self.iterations = iterations
 *         #
 */
  __pyx_t_3 = (__pyx_v_iterations != Py_None);
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {

    /* "_loess.pyx":266
 *         iterations = cellargs.get('iterations', None)
 *         if iterations is not None:
 *             self.iterations = iterations             # <<<<<<<<<<<<<<
 *         #
 *         cell = cellargs.get('cell', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_iterations, __pyx_v_iterations) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "_loess.pyx":268
 *             self.iterations = iterations
 *         #
 *         cell = cellargs.get('cell', None)             # <<<<<<<<<<<<<<
 *         if cell is not None:
 *             self.parametric_flags = cell
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_cellargs, __pyx_n_s_cell, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_cell = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":269
 *         #
 *         cell = cellargs.get('cell', None)
 *         if cell is not None:             # <<<<<<<<<<<<<<
 *             self.parametric_flags = cell
 *         #
 */
  __pyx_t_2 = (__pyx_v_cell != Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "_loess.pyx":270
 *         cell = cellargs.get('cell', None)
 *         if cell is not None:
 *             self.parametric_flags = cell             # <<<<<<<<<<<<<<
 *         #
 *     #.........
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_parametric_flags, __pyx_v_cell) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "_loess.pyx":250
 *             self._base.cell = cell
 *     #.........
 *     def update(self, **cellargs):             # <<<<<<<<<<<<<<
 *         """Updates several parameters at once."""
 *         surface = cellargs.get('surface', None)
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_control.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_surface);
  __Pyx_XDECREF(__pyx_v_statistics);
  __Pyx_XDECREF(__pyx_v_trace_hat);
  __Pyx_XDECREF(__pyx_v_iterations);
  __Pyx_XDECREF(__pyx_v_cell);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":273
 *         #
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         strg = ["Control          :",
 *                 "Surface type     : %s" % self.surface,
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_control_3__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_control_3__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_control_2__str__(((struct __pyx_obj_6_loess_loess_control *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_control_2__str__(struct __pyx_obj_6_loess_loess_control *__pyx_v_self) {
  PyObject *__pyx_v_strg = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__str__", 0);

  /* "_loess.pyx":275
 *     def __str__(self):
 *         strg = ["Control          :",
 *                 "Surface type     : %s" % self.surface,             # <<<<<<<<<<<<<<
 *                 "Statistics       : %s" % self.statistics,
 *                 "Trace estimation : %s" % self.trace_hat,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_surface); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Surface_type_s, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":276
 *         strg = ["Control          :",
 *                 "Surface type     : %s" % self.surface,
 *                 "Statistics       : %s" % self.statistics,             # <<<<<<<<<<<<<<
 *                 "Trace estimation : %s" % self.trace_hat,
 *                 "Cell size        : %s" % self.cell,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_statistics); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_Statistics_s, __pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":277
 *                 "Surface type     : %s" % self.surface,
 *                 "Statistics       : %s" % self.statistics,
 *                 "Trace estimation : %s" % self.trace_hat,             # <<<<<<<<<<<<<<
 *                 "Cell size        : %s" % self.cell,
 *                 "Nb iterations    : %s" % self.iterations,]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_trace_hat); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Trace_estimation_s, __pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":278
 *                 "Statistics       : %s" % self.statistics,
 *                 "Trace estimation : %s" % self.trace_hat,
 *                 "Cell size        : %s" % self.cell,             # <<<<<<<<<<<<<<
 *                 "Nb iterations    : %s" % self.iterations,]
 *         return '\n'.join(strg)
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_cell); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_Cell_size_s, __pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":279
 *                 "Trace estimation : %s" % self.trace_hat,
 *                 "Cell size        : %s" % self.cell,
 *                 "Nb iterations    : %s" % self.iterations,]             # <<<<<<<<<<<<<<
 *         return '\n'.join(strg)
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_iterations); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_Nb_iterations_s, __pyx_t_1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":274
 *     #.........
 *     def __str__(self):
 *         strg = ["Control          :",             # <<<<<<<<<<<<<<
 *                 "Surface type     : %s" % self.surface,
 *                 "Statistics       : %s" % self.statistics,
 */
  __pyx_t_1 = PyList_New(6); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_kp_s_Control);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_s_Control);
  __Pyx_GIVEREF(__pyx_kp_s_Control);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_1, 4, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_5);
  PyList_SET_ITEM(__pyx_t_1, 5, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_6);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_v_strg = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":280
 *                 "Cell size        : %s" % self.cell,
 *                 "Nb iterations    : %s" % self.iterations,]
 *         return '\n'.join(strg)             # <<<<<<<<<<<<<<
 * 
 * #
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyString_Join(__pyx_kp_s__7, __pyx_v_strg); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":273
 *         #
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         strg = ["Control          :",
 *                 "Surface type     : %s" % self.surface,
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("_loess.loess_control.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_strg);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":334
 *     cdef long npar
 *     #.........
 *     cdef setup(self, c_loess.c_loess_model *base, long npar):             # <<<<<<<<<<<<<<
 *         self._base = base
 *         self.npar = npar
 */

static PyObject *__pyx_f_6_loess_11loess_model_setup(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, loess_model *__pyx_v_base, long __pyx_v_npar) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setup", 0);

  /* "_loess.pyx":335
 *     #.........
 *     cdef setup(self, c_loess.c_loess_model *base, long npar):
 *         self._base = base             # <<<<<<<<<<<<<<
 *         self.npar = npar
 *         return self
 */
  __pyx_v_self->_base = __pyx_v_base;

  /* "_loess.pyx":336
 *     cdef setup(self, c_loess.c_loess_model *base, long npar):
 *         self._base = base
 *         self.npar = npar             # <<<<<<<<<<<<<<
 *         return self
 *     #.........
 */
  __pyx_v_self->npar = __pyx_v_npar;

  /* "_loess.pyx":337
 *         self._base = base
 *         self.npar = npar
 *         return self             # <<<<<<<<<<<<<<
 *     #.........
 *     property normalize:
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "_loess.pyx":334
 *     cdef long npar
 *     #.........
 *     cdef setup(self, c_loess.c_loess_model *base, long npar):             # <<<<<<<<<<<<<<
 *         self._base = base
 *         self.npar = npar
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":340
 *     #.........
 *     property normalize:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return bool(self._base.normalize)
 *         def __set__(self, normalize):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_9normalize_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_9normalize_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_9normalize___get__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_9normalize___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":341
 *     property normalize:
 *         def __get__(self):
 *             return bool(self._base.normalize)             # <<<<<<<<<<<<<<
 *         def __set__(self, normalize):
 *             self._base.normalize = normalize
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->_base->normalize); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyBool_FromLong((!(!__pyx_t_2))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":340
 *     #.........
 *     property normalize:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return bool(self._base.normalize)
 *         def __set__(self, normalize):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_model.normalize.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":342
 *         def __get__(self):
 *             return bool(self._base.normalize)
 *         def __set__(self, normalize):             # <<<<<<<<<<<<<<
 *             self._base.normalize = normalize
 *     #.........
 */

/* Python wrapper */
static int __pyx_pw_6_loess_11loess_model_9normalize_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_normalize); /*proto*/
static int __pyx_pw_6_loess_11loess_model_9normalize_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_normalize) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_9normalize_2__set__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self), ((PyObject *)__pyx_v_normalize));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_11loess_model_9normalize_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_normalize) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":343
 *             return bool(self._base.normalize)
 *         def __set__(self, normalize):
 *             self._base.normalize = normalize             # <<<<<<<<<<<<<<
 *     #.........
 *     property span:
 */
  __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_v_normalize); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->normalize = __pyx_t_1;

  /* "_loess.pyx":342
 *         def __get__(self):
 *             return bool(self._base.normalize)
 *         def __set__(self, normalize):             # <<<<<<<<<<<<<<
 *             self._base.normalize = normalize
 *     #.........
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("_loess.loess_model.normalize.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":346
 *     #.........
 *     property span:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.span
 *         def __set__(self, span):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_4span_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_4span_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_4span___get__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_4span___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":347
 *     property span:
 *         def __get__(self):
 *             return self._base.span             # <<<<<<<<<<<<<<
 *         def __set__(self, span):
 *             if span <= 0. or span > 1.:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base->span); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":346
 *     #.........
 *     property span:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.span
 *         def __set__(self, span):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_model.span.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":348
 *         def __get__(self):
 *             return self._base.span
 *         def __set__(self, span):             # <<<<<<<<<<<<<<
 *             if span <= 0. or span > 1.:
 *                 raise ValueError("Span should be between 0 and 1!")
 */

/* Python wrapper */
static int __pyx_pw_6_loess_11loess_model_4span_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_span); /*proto*/
static int __pyx_pw_6_loess_11loess_model_4span_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_span) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_4span_2__set__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self), ((PyObject *)__pyx_v_span));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_11loess_model_4span_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_span) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  double __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":349
 *             return self._base.span
 *         def __set__(self, span):
 *             if span <= 0. or span > 1.:             # <<<<<<<<<<<<<<
 *                 raise ValueError("Span should be between 0 and 1!")
 *             self._base.span = span
 */
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_span, __pyx_float_0_, Py_LE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (!__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_span, __pyx_float_1_, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = __pyx_t_3;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {

    /* "_loess.pyx":350
 *         def __set__(self, span):
 *             if span <= 0. or span > 1.:
 *                 raise ValueError("Span should be between 0 and 1!")             # <<<<<<<<<<<<<<
 *             self._base.span = span
 *     #.........
 */
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":351
 *             if span <= 0. or span > 1.:
 *                 raise ValueError("Span should be between 0 and 1!")
 *             self._base.span = span             # <<<<<<<<<<<<<<
 *     #.........
 *     property degree:
 */
  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_v_span); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->span = __pyx_t_4;

  /* "_loess.pyx":348
 *         def __get__(self):
 *             return self._base.span
 *         def __set__(self, span):             # <<<<<<<<<<<<<<
 *             if span <= 0. or span > 1.:
 *                 raise ValueError("Span should be between 0 and 1!")
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("_loess.loess_model.span.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":354
 *     #.........
 *     property degree:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.degree
 *         def __set__(self, degree):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_6degree_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_6degree_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_6degree___get__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_6degree___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":355
 *     property degree:
 *         def __get__(self):
 *             return self._base.degree             # <<<<<<<<<<<<<<
 *         def __set__(self, degree):
 *             if degree < 0 or degree > 2:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->_base->degree); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":354
 *     #.........
 *     property degree:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.degree
 *         def __set__(self, degree):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_model.degree.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":356
 *         def __get__(self):
 *             return self._base.degree
 *         def __set__(self, degree):             # <<<<<<<<<<<<<<
 *             if degree < 0 or degree > 2:
 *                 raise ValueError("Degree should be between 0 and 2!")
 */

/* Python wrapper */
static int __pyx_pw_6_loess_11loess_model_6degree_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_degree); /*proto*/
static int __pyx_pw_6_loess_11loess_model_6degree_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_degree) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_6degree_2__set__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self), ((PyObject *)__pyx_v_degree));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_11loess_model_6degree_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_degree) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":357
 *             return self._base.degree
 *         def __set__(self, degree):
 *             if degree < 0 or degree > 2:             # <<<<<<<<<<<<<<
 *                 raise ValueError("Degree should be between 0 and 2!")
 *             self._base.degree = degree
 */
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_degree, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (!__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_degree, __pyx_int_2, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = __pyx_t_3;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {

    /* "_loess.pyx":358
 *         def __set__(self, degree):
 *             if degree < 0 or degree > 2:
 *                 raise ValueError("Degree should be between 0 and 2!")             # <<<<<<<<<<<<<<
 *             self._base.degree = degree
 *     #.........
 */
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":359
 *             if degree < 0 or degree > 2:
 *                 raise ValueError("Degree should be between 0 and 2!")
 *             self._base.degree = degree             # <<<<<<<<<<<<<<
 *     #.........
 *     property family:
 */
  __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_v_degree); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->degree = __pyx_t_4;

  /* "_loess.pyx":356
 *         def __get__(self):
 *             return self._base.degree
 *         def __set__(self, degree):             # <<<<<<<<<<<<<<
 *             if degree < 0 or degree > 2:
 *                 raise ValueError("Degree should be between 0 and 2!")
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("_loess.loess_model.degree.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":362
 *     #.........
 *     property family:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.family
 *         def __set__(self, family):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_6family_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_6family_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_6family___get__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_6family___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":363
 *     property family:
 *         def __get__(self):
 *             return self._base.family             # <<<<<<<<<<<<<<
 *         def __set__(self, family):
 *             if family.lower() not in ('symmetric', 'gaussian'):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_self->_base->family); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":362
 *     #.........
 *     property family:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.family
 *         def __set__(self, family):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_model.family.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":364
 *         def __get__(self):
 *             return self._base.family
 *         def __set__(self, family):             # <<<<<<<<<<<<<<
 *             if family.lower() not in ('symmetric', 'gaussian'):
 *                 raise ValueError("Invalid value for the 'family' argument: "\
 */

/* Python wrapper */
static int __pyx_pw_6_loess_11loess_model_6family_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_family); /*proto*/
static int __pyx_pw_6_loess_11loess_model_6family_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_family) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_6family_2__set__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self), ((PyObject *)__pyx_v_family));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_11loess_model_6family_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_family) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  char *__pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":365
 *             return self._base.family
 *         def __set__(self, family):
 *             if family.lower() not in ('symmetric', 'gaussian'):             # <<<<<<<<<<<<<<
 *                 raise ValueError("Invalid value for the 'family' argument: "\
 *                                  "should be in ('symmetric', 'gaussian').")
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_family, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_n_s_symmetric, Py_NE)); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_n_s_gaussian, Py_NE)); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = (__pyx_t_4 != 0);
  if (__pyx_t_5) {

    /* "_loess.pyx":366
 *         def __set__(self, family):
 *             if family.lower() not in ('symmetric', 'gaussian'):
 *                 raise ValueError("Invalid value for the 'family' argument: "\             # <<<<<<<<<<<<<<
 *                                  "should be in ('symmetric', 'gaussian').")
 *             self._base.family = family
 */
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":368
 *                 raise ValueError("Invalid value for the 'family' argument: "\
 *                                  "should be in ('symmetric', 'gaussian').")
 *             self._base.family = family             # <<<<<<<<<<<<<<
 *     #.........
 *     property parametric_flags:
 */
  __pyx_t_6 = __Pyx_PyObject_AsString(__pyx_v_family); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_self->_base->family = __pyx_t_6;

  /* "_loess.pyx":364
 *         def __get__(self):
 *             return self._base.family
 *         def __set__(self, family):             # <<<<<<<<<<<<<<
 *             if family.lower() not in ('symmetric', 'gaussian'):
 *                 raise ValueError("Invalid value for the 'family' argument: "\
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("_loess.loess_model.family.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":371
 *     #.........
 *     property parametric_flags:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return boolarray_from_data(self.npar, 1, self._base.parametric)
 *         def __set__(self, paramf):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_16parametric_flags_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_16parametric_flags_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_16parametric_flags___get__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_16parametric_flags___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":372
 *     property parametric_flags:
 *         def __get__(self):
 *             return boolarray_from_data(self.npar, 1, self._base.parametric)             # <<<<<<<<<<<<<<
 *         def __set__(self, paramf):
 *             cdef ndarray p_ndr
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_boolarray_from_data(__pyx_v_self->npar, 1, __pyx_v_self->_base->parametric); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":371
 *     #.........
 *     property parametric_flags:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return boolarray_from_data(self.npar, 1, self._base.parametric)
 *         def __set__(self, paramf):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_model.parametric_flags.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":373
 *         def __get__(self):
 *             return boolarray_from_data(self.npar, 1, self._base.parametric)
 *         def __set__(self, paramf):             # <<<<<<<<<<<<<<
 *             cdef ndarray p_ndr
 *             cdef int i
 */

/* Python wrapper */
static int __pyx_pw_6_loess_11loess_model_16parametric_flags_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_paramf); /*proto*/
static int __pyx_pw_6_loess_11loess_model_16parametric_flags_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_paramf) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_16parametric_flags_2__set__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self), ((PyObject *)__pyx_v_paramf));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_11loess_model_16parametric_flags_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_paramf) {
  PyArrayObject *__pyx_v_p_ndr = 0;
  int __pyx_v_i;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  long __pyx_t_8;
  int __pyx_t_9;
  int __pyx_t_10;
  int __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":376
 *             cdef ndarray p_ndr
 *             cdef int i
 *             p_ndr = numpy.atleast_1d(narray(paramf, copy=False, subok=True,             # <<<<<<<<<<<<<<
 *                                             dtype=numpy.bool))
 *             for i from 0 <= i < min(self.npar, p_ndr.size):
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_atleast_1d); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_narray); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_INCREF(__pyx_v_paramf);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_paramf);
  __Pyx_GIVEREF(__pyx_v_paramf);
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_copy, Py_False) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_subok, Py_True) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "_loess.pyx":377
 *             cdef int i
 *             p_ndr = numpy.atleast_1d(narray(paramf, copy=False, subok=True,
 *                                             dtype=numpy.bool))             # <<<<<<<<<<<<<<
 *             for i from 0 <= i < min(self.npar, p_ndr.size):
 *                 self._base.parametric[i] = p_ndr[i]
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_bool); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "_loess.pyx":376
 *             cdef ndarray p_ndr
 *             cdef int i
 *             p_ndr = numpy.atleast_1d(narray(paramf, copy=False, subok=True,             # <<<<<<<<<<<<<<
 *                                             dtype=numpy.bool))
 *             for i from 0 <= i < min(self.npar, p_ndr.size):
 */
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __Pyx_GIVEREF(__pyx_t_5); __pyx_t_5 = NULL;
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_p_ndr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":378
 *             p_ndr = numpy.atleast_1d(narray(paramf, copy=False, subok=True,
 *                                             dtype=numpy.bool))
 *             for i from 0 <= i < min(self.npar, p_ndr.size):             # <<<<<<<<<<<<<<
 *                 self._base.parametric[i] = p_ndr[i]
 *     #.........
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_p_ndr), __pyx_n_s_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_8 = __pyx_v_self->npar;
  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_t_8); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_7 = PyObject_RichCompare(__pyx_t_1, __pyx_t_4, Py_LT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_9 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (__pyx_t_9) {
    __Pyx_INCREF(__pyx_t_1);
    __pyx_t_3 = __pyx_t_1;
  } else {
    __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_t_8); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_3 = __pyx_t_7;
    __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_10; __pyx_v_i++) {

    /* "_loess.pyx":379
 *                                             dtype=numpy.bool))
 *             for i from 0 <= i < min(self.npar, p_ndr.size):
 *                 self._base.parametric[i] = p_ndr[i]             # <<<<<<<<<<<<<<
 *     #.........
 *     property drop_square_flags:
 */
    __pyx_t_3 = __Pyx_GetItemInt(((PyObject *)__pyx_v_p_ndr), __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    (__pyx_v_self->_base->parametric[__pyx_v_i]) = __pyx_t_11;
  }

  /* "_loess.pyx":373
 *         def __get__(self):
 *             return boolarray_from_data(self.npar, 1, self._base.parametric)
 *         def __set__(self, paramf):             # <<<<<<<<<<<<<<
 *             cdef ndarray p_ndr
 *             cdef int i
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("_loess.loess_model.parametric_flags.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_p_ndr);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":382
 *     #.........
 *     property drop_square_flags:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return boolarray_from_data(self.npar, 1, self._base.drop_square)
 *         def __set__(self, drop_sq):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_17drop_square_flags_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_17drop_square_flags_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_17drop_square_flags___get__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_17drop_square_flags___get__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":383
 *     property drop_square_flags:
 *         def __get__(self):
 *             return boolarray_from_data(self.npar, 1, self._base.drop_square)             # <<<<<<<<<<<<<<
 *         def __set__(self, drop_sq):
 *             cdef ndarray d_ndr
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_boolarray_from_data(__pyx_v_self->npar, 1, __pyx_v_self->_base->drop_square); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":382
 *     #.........
 *     property drop_square_flags:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return boolarray_from_data(self.npar, 1, self._base.drop_square)
 *         def __set__(self, drop_sq):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_model.drop_square_flags.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":384
 *         def __get__(self):
 *             return boolarray_from_data(self.npar, 1, self._base.drop_square)
 *         def __set__(self, drop_sq):             # <<<<<<<<<<<<<<
 *             cdef ndarray d_ndr
 *             cdef int i
 */

/* Python wrapper */
static int __pyx_pw_6_loess_11loess_model_17drop_square_flags_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_drop_sq); /*proto*/
static int __pyx_pw_6_loess_11loess_model_17drop_square_flags_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_drop_sq) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_17drop_square_flags_2__set__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self), ((PyObject *)__pyx_v_drop_sq));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_11loess_model_17drop_square_flags_2__set__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_drop_sq) {
  PyArrayObject *__pyx_v_d_ndr = 0;
  int __pyx_v_i;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  long __pyx_t_8;
  int __pyx_t_9;
  int __pyx_t_10;
  int __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__set__", 0);

  /* "_loess.pyx":387
 *             cdef ndarray d_ndr
 *             cdef int i
 *             d_ndr = numpy.atleast_1d(narray(drop_sq, copy=False, subok=True,             # <<<<<<<<<<<<<<
 *                                             dtype=numpy.bool))
 *             for i from 0 <= i < min(self.npar, d_ndr.size):
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_atleast_1d); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_narray); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_INCREF(__pyx_v_drop_sq);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_drop_sq);
  __Pyx_GIVEREF(__pyx_v_drop_sq);
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_copy, Py_False) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_subok, Py_True) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "_loess.pyx":388
 *             cdef int i
 *             d_ndr = numpy.atleast_1d(narray(drop_sq, copy=False, subok=True,
 *                                             dtype=numpy.bool))             # <<<<<<<<<<<<<<
 *             for i from 0 <= i < min(self.npar, d_ndr.size):
 *                 self._base.drop_square[i] = d_ndr[i]
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_bool); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "_loess.pyx":387
 *             cdef ndarray d_ndr
 *             cdef int i
 *             d_ndr = numpy.atleast_1d(narray(drop_sq, copy=False, subok=True,             # <<<<<<<<<<<<<<
 *                                             dtype=numpy.bool))
 *             for i from 0 <= i < min(self.npar, d_ndr.size):
 */
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __Pyx_GIVEREF(__pyx_t_5); __pyx_t_5 = NULL;
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_d_ndr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":389
 *             d_ndr = numpy.atleast_1d(narray(drop_sq, copy=False, subok=True,
 *                                             dtype=numpy.bool))
 *             for i from 0 <= i < min(self.npar, d_ndr.size):             # <<<<<<<<<<<<<<
 *                 self._base.drop_square[i] = d_ndr[i]
 *     #........
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_d_ndr), __pyx_n_s_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_8 = __pyx_v_self->npar;
  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_t_8); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_7 = PyObject_RichCompare(__pyx_t_1, __pyx_t_4, Py_LT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_9 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (__pyx_t_9) {
    __Pyx_INCREF(__pyx_t_1);
    __pyx_t_3 = __pyx_t_1;
  } else {
    __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_t_8); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_3 = __pyx_t_7;
    __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_10; __pyx_v_i++) {

    /* "_loess.pyx":390
 *                                             dtype=numpy.bool))
 *             for i from 0 <= i < min(self.npar, d_ndr.size):
 *                 self._base.drop_square[i] = d_ndr[i]             # <<<<<<<<<<<<<<
 *     #........
 *     def update(self, **modelargs):
 */
    __pyx_t_3 = __Pyx_GetItemInt(((PyObject *)__pyx_v_d_ndr), __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    (__pyx_v_self->_base->drop_square[__pyx_v_i]) = __pyx_t_11;
  }

  /* "_loess.pyx":384
 *         def __get__(self):
 *             return boolarray_from_data(self.npar, 1, self._base.drop_square)
 *         def __set__(self, drop_sq):             # <<<<<<<<<<<<<<
 *             cdef ndarray d_ndr
 *             cdef int i
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("_loess.loess_model.drop_square_flags.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_d_ndr);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":392
 *                 self._base.drop_square[i] = d_ndr[i]
 *     #........
 *     def update(self, **modelargs):             # <<<<<<<<<<<<<<
 *         family = modelargs.get('family', None)
 *         if family is not None:
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_1update(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_1update(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_modelargs = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("update (wrapper)", 0);
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("update", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return NULL;}
  if (__pyx_kwds && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "update", 1))) return NULL;
  __pyx_v_modelargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_modelargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_modelargs);
  __pyx_r = __pyx_pf_6_loess_11loess_model_update(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self), __pyx_v_modelargs);

  /* function exit code */
  __Pyx_XDECREF(__pyx_v_modelargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_update(struct __pyx_obj_6_loess_loess_model *__pyx_v_self, PyObject *__pyx_v_modelargs) {
  PyObject *__pyx_v_family = NULL;
  PyObject *__pyx_v_span = NULL;
  PyObject *__pyx_v_degree = NULL;
  PyObject *__pyx_v_normalize = NULL;
  PyObject *__pyx_v_parametric = NULL;
  PyObject *__pyx_v_drop_square = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("update", 0);

  /* "_loess.pyx":393
 *     #........
 *     def update(self, **modelargs):
 *         family = modelargs.get('family', None)             # <<<<<<<<<<<<<<
 *         if family is not None:
 *             self.family = family
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_modelargs, __pyx_n_s_family, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_family = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":394
 *     def update(self, **modelargs):
 *         family = modelargs.get('family', None)
 *         if family is not None:             # <<<<<<<<<<<<<<
 *             self.family = family
 *         #
 */
  __pyx_t_2 = (__pyx_v_family != Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "_loess.pyx":395
 *         family = modelargs.get('family', None)
 *         if family is not None:
 *             self.family = family             # <<<<<<<<<<<<<<
 *         #
 *         span = modelargs.get('span', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_family, __pyx_v_family) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "_loess.pyx":397
 *             self.family = family
 *         #
 *         span = modelargs.get('span', None)             # <<<<<<<<<<<<<<
 *         if span is not None:
 *             self.span = span
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_modelargs, __pyx_n_s_span, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_span = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":398
 *         #
 *         span = modelargs.get('span', None)
 *         if span is not None:             # <<<<<<<<<<<<<<
 *             self.span = span
 *         #
 */
  __pyx_t_3 = (__pyx_v_span != Py_None);
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {

    /* "_loess.pyx":399
 *         span = modelargs.get('span', None)
 *         if span is not None:
 *             self.span = span             # <<<<<<<<<<<<<<
 *         #
 *         degree = modelargs.get('degree', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_span, __pyx_v_span) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "_loess.pyx":401
 *             self.span = span
 *         #
 *         degree = modelargs.get('degree', None)             # <<<<<<<<<<<<<<
 *         if degree is not None:
 *             self.degree = degree
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_modelargs, __pyx_n_s_degree, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_degree = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":402
 *         #
 *         degree = modelargs.get('degree', None)
 *         if degree is not None:             # <<<<<<<<<<<<<<
 *             self.degree = degree
 *         #
 */
  __pyx_t_2 = (__pyx_v_degree != Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "_loess.pyx":403
 *         degree = modelargs.get('degree', None)
 *         if degree is not None:
 *             self.degree = degree             # <<<<<<<<<<<<<<
 *         #
 *         normalize = modelargs.get('normalize', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_degree, __pyx_v_degree) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "_loess.pyx":405
 *             self.degree = degree
 *         #
 *         normalize = modelargs.get('normalize', None)             # <<<<<<<<<<<<<<
 *         if normalize is not None:
 *             self.normalize = normalize
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_modelargs, __pyx_n_s_normalize, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_normalize = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":406
 *         #
 *         normalize = modelargs.get('normalize', None)
 *         if normalize is not None:             # <<<<<<<<<<<<<<
 *             self.normalize = normalize
 *         #
 */
  __pyx_t_3 = (__pyx_v_normalize != Py_None);
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {

    /* "_loess.pyx":407
 *         normalize = modelargs.get('normalize', None)
 *         if normalize is not None:
 *             self.normalize = normalize             # <<<<<<<<<<<<<<
 *         #
 *         parametric = modelargs.get('parametric', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_normalize, __pyx_v_normalize) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "_loess.pyx":409
 *             self.normalize = normalize
 *         #
 *         parametric = modelargs.get('parametric', None)             # <<<<<<<<<<<<<<
 *         if parametric is not None:
 *             self.parametric_flags = parametric
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_modelargs, __pyx_n_s_parametric, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_parametric = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":410
 *         #
 *         parametric = modelargs.get('parametric', None)
 *         if parametric is not None:             # <<<<<<<<<<<<<<
 *             self.parametric_flags = parametric
 *         #
 */
  __pyx_t_2 = (__pyx_v_parametric != Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "_loess.pyx":411
 *         parametric = modelargs.get('parametric', None)
 *         if parametric is not None:
 *             self.parametric_flags = parametric             # <<<<<<<<<<<<<<
 *         #
 *         drop_square = modelargs.get('drop_square', None)
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_parametric_flags, __pyx_v_parametric) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "_loess.pyx":413
 *             self.parametric_flags = parametric
 *         #
 *         drop_square = modelargs.get('drop_square', None)             # <<<<<<<<<<<<<<
 *         if drop_square is not None:
 *             self.drop_square_flags = drop_square
 */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_modelargs, __pyx_n_s_drop_square, Py_None); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_drop_square = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "_loess.pyx":414
 *         #
 *         drop_square = modelargs.get('drop_square', None)
 *         if drop_square is not None:             # <<<<<<<<<<<<<<
 *             self.drop_square_flags = drop_square
 *     #.........
 */
  __pyx_t_3 = (__pyx_v_drop_square != Py_None);
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {

    /* "_loess.pyx":415
 *         drop_square = modelargs.get('drop_square', None)
 *         if drop_square is not None:
 *             self.drop_square_flags = drop_square             # <<<<<<<<<<<<<<
 *     #.........
 *     def __repr__(self):
 */
    if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_drop_square_flags, __pyx_v_drop_square) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "_loess.pyx":392
 *                 self._base.drop_square[i] = d_ndr[i]
 *     #........
 *     def update(self, **modelargs):             # <<<<<<<<<<<<<<
 *         family = modelargs.get('family', None)
 *         if family is not None:
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_model.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_family);
  __Pyx_XDECREF(__pyx_v_span);
  __Pyx_XDECREF(__pyx_v_degree);
  __Pyx_XDECREF(__pyx_v_normalize);
  __Pyx_XDECREF(__pyx_v_parametric);
  __Pyx_XDECREF(__pyx_v_drop_square);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":417
 *             self.drop_square_flags = drop_square
 *     #.........
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         return "<loess object: model parameters>"
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_2__repr__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_2__repr__(CYTHON_UNUSED struct __pyx_obj_6_loess_loess_model *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__repr__", 0);

  /* "_loess.pyx":418
 *     #.........
 *     def __repr__(self):
 *         return "<loess object: model parameters>"             # <<<<<<<<<<<<<<
 *     #.........
 *     def __str__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_kp_s_loess_object_model_parameters);
  __pyx_r = __pyx_kp_s_loess_object_model_parameters;
  goto __pyx_L0;

  /* "_loess.pyx":417
 *             self.drop_square_flags = drop_square
 *     #.........
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         return "<loess object: model parameters>"
 *     #.........
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":420
 *         return "<loess object: model parameters>"
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         strg = ["Model parameters.....",
 *                 "Family          : %s" % self.family,
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_11loess_model_5__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_11loess_model_5__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_11loess_model_4__str__(((struct __pyx_obj_6_loess_loess_model *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_11loess_model_4__str__(struct __pyx_obj_6_loess_loess_model *__pyx_v_self) {
  PyObject *__pyx_v_strg = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__str__", 0);

  /* "_loess.pyx":422
 *     def __str__(self):
 *         strg = ["Model parameters.....",
 *                 "Family          : %s" % self.family,             # <<<<<<<<<<<<<<
 *                 "Span            : %s" % self.span,
 *                 "Degree          : %s" % self.degree,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_family); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Family_s, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":423
 *         strg = ["Model parameters.....",
 *                 "Family          : %s" % self.family,
 *                 "Span            : %s" % self.span,             # <<<<<<<<<<<<<<
 *                 "Degree          : %s" % self.degree,
 *                 "Normalized      : %s" % self.normalize,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_span); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_Span_s, __pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":424
 *                 "Family          : %s" % self.family,
 *                 "Span            : %s" % self.span,
 *                 "Degree          : %s" % self.degree,             # <<<<<<<<<<<<<<
 *                 "Normalized      : %s" % self.normalize,
 *                 "Parametric      : %s" % self.parametric_flags[:self.npar],
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_degree); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Degree_s, __pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":425
 *                 "Span            : %s" % self.span,
 *                 "Degree          : %s" % self.degree,
 *                 "Normalized      : %s" % self.normalize,             # <<<<<<<<<<<<<<
 *                 "Parametric      : %s" % self.parametric_flags[:self.npar],
 *                 "Drop_square     : %s" % self.drop_square_flags[:self.npar]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_normalize); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_Normalized_s, __pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":426
 *                 "Degree          : %s" % self.degree,
 *                 "Normalized      : %s" % self.normalize,
 *                 "Parametric      : %s" % self.parametric_flags[:self.npar],             # <<<<<<<<<<<<<<
 *                 "Drop_square     : %s" % self.drop_square_flags[:self.npar]
 *                 ]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_parametric_flags); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_t_1, 0, __pyx_v_self->npar, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Parametric_s, __pyx_t_6); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "_loess.pyx":427
 *                 "Normalized      : %s" % self.normalize,
 *                 "Parametric      : %s" % self.parametric_flags[:self.npar],
 *                 "Drop_square     : %s" % self.drop_square_flags[:self.npar]             # <<<<<<<<<<<<<<
 *                 ]
 *         return '\n'.join(strg)
 */
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_drop_square_flags); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_6, 0, __pyx_v_self->npar, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_Drop_square_s, __pyx_t_7); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "_loess.pyx":421
 *     #.........
 *     def __str__(self):
 *         strg = ["Model parameters.....",             # <<<<<<<<<<<<<<
 *                 "Family          : %s" % self.family,
 *                 "Span            : %s" % self.span,
 */
  __pyx_t_7 = PyList_New(7); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_INCREF(__pyx_kp_s_Model_parameters);
  PyList_SET_ITEM(__pyx_t_7, 0, __pyx_kp_s_Model_parameters);
  __Pyx_GIVEREF(__pyx_kp_s_Model_parameters);
  PyList_SET_ITEM(__pyx_t_7, 1, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_7, 2, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_7, 3, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_7, 4, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_5);
  PyList_SET_ITEM(__pyx_t_7, 5, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_7, 6, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_6);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_6 = 0;
  __pyx_v_strg = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "_loess.pyx":429
 *                 "Drop_square     : %s" % self.drop_square_flags[:self.npar]
 *                 ]
 *         return '\n'.join(strg)             # <<<<<<<<<<<<<<
 * 
 * #####---------------------------------------------------------------------------
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_7 = __Pyx_PyString_Join(__pyx_kp_s__7, __pyx_v_strg); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":420
 *         return "<loess object: model parameters>"
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         strg = ["Model parameters.....",
 *                 "Family          : %s" % self.family,
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("_loess.loess_model.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_strg);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":467
 *     cdef long nobs, npar
 *     cdef readonly int activated
 *     cdef setup(self,c_loess.c_loess_outputs *base, long nobs, long npar):             # <<<<<<<<<<<<<<
 *         self._base = base
 *         self.nobs = nobs
 */

static PyObject *__pyx_f_6_loess_13loess_outputs_setup(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self, loess_outputs *__pyx_v_base, long __pyx_v_nobs, long __pyx_v_npar) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setup", 0);

  /* "_loess.pyx":468
 *     cdef readonly int activated
 *     cdef setup(self,c_loess.c_loess_outputs *base, long nobs, long npar):
 *         self._base = base             # <<<<<<<<<<<<<<
 *         self.nobs = nobs
 *         self.npar = npar
 */
  __pyx_v_self->_base = __pyx_v_base;

  /* "_loess.pyx":469
 *     cdef setup(self,c_loess.c_loess_outputs *base, long nobs, long npar):
 *         self._base = base
 *         self.nobs = nobs             # <<<<<<<<<<<<<<
 *         self.npar = npar
 *         self.activated = False
 */
  __pyx_v_self->nobs = __pyx_v_nobs;

  /* "_loess.pyx":470
 *         self._base = base
 *         self.nobs = nobs
 *         self.npar = npar             # <<<<<<<<<<<<<<
 *         self.activated = False
 *     #........
 */
  __pyx_v_self->npar = __pyx_v_npar;

  /* "_loess.pyx":471
 *         self.nobs = nobs
 *         self.npar = npar
 *         self.activated = False             # <<<<<<<<<<<<<<
 *     #........
 *     property fitted_values:
 */
  __pyx_v_self->activated = 0;

  /* "_loess.pyx":467
 *     cdef long nobs, npar
 *     cdef readonly int activated
 *     cdef setup(self,c_loess.c_loess_outputs *base, long nobs, long npar):             # <<<<<<<<<<<<<<
 *         self._base = base
 *         self.nobs = nobs
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":474
 *     #........
 *     property fitted_values:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.fitted_values)
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_13fitted_values_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_13fitted_values_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_13fitted_values___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_13fitted_values___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":475
 *     property fitted_values:
 *         def __get__(self):
 *             return floatarray_from_data(self.nobs, 1, self._base.fitted_values)             # <<<<<<<<<<<<<<
 *     #.........
 *     property fitted_residuals:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_self->nobs, 1, __pyx_v_self->_base->fitted_values); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":474
 *     #........
 *     property fitted_values:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.fitted_values)
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.fitted_values.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":478
 *     #.........
 *     property fitted_residuals:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.fitted_residuals)
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_16fitted_residuals_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_16fitted_residuals_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_16fitted_residuals___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_16fitted_residuals___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":479
 *     property fitted_residuals:
 *         def __get__(self):
 *             return floatarray_from_data(self.nobs, 1, self._base.fitted_residuals)             # <<<<<<<<<<<<<<
 *     #.........
 *     property pseudovalues:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_self->nobs, 1, __pyx_v_self->_base->fitted_residuals); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":478
 *     #.........
 *     property fitted_residuals:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.fitted_residuals)
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.fitted_residuals.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":482
 *     #.........
 *     property pseudovalues:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.pseudovalues)
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_12pseudovalues_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_12pseudovalues_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_12pseudovalues___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_12pseudovalues___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":483
 *     property pseudovalues:
 *         def __get__(self):
 *             return floatarray_from_data(self.nobs, 1, self._base.pseudovalues)             # <<<<<<<<<<<<<<
 *     #.........
 *     property diagonal:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_self->nobs, 1, __pyx_v_self->_base->pseudovalues); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":482
 *     #.........
 *     property pseudovalues:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.pseudovalues)
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.pseudovalues.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":486
 *     #.........
 *     property diagonal:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.diagonal)
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_8diagonal_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_8diagonal_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_8diagonal___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_8diagonal___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":487
 *     property diagonal:
 *         def __get__(self):
 *             return floatarray_from_data(self.nobs, 1, self._base.diagonal)             # <<<<<<<<<<<<<<
 *     #.........
 *     property robust:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_self->nobs, 1, __pyx_v_self->_base->diagonal); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":486
 *     #.........
 *     property diagonal:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.diagonal)
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.diagonal.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":490
 *     #.........
 *     property robust:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.robust)
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_6robust_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_6robust_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_6robust___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_6robust___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":491
 *     property robust:
 *         def __get__(self):
 *             return floatarray_from_data(self.nobs, 1, self._base.robust)             # <<<<<<<<<<<<<<
 *     #.........
 *     property divisor:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_self->nobs, 1, __pyx_v_self->_base->robust); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":490
 *     #.........
 *     property robust:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nobs, 1, self._base.robust)
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.robust.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":494
 *     #.........
 *     property divisor:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.npar, 1, self._base.divisor)
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_7divisor_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_7divisor_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_7divisor___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_7divisor___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":495
 *     property divisor:
 *         def __get__(self):
 *             return floatarray_from_data(self.npar, 1, self._base.divisor)             # <<<<<<<<<<<<<<
 *     #.........
 *     property enp:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_self->npar, 1, __pyx_v_self->_base->divisor); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":494
 *     #.........
 *     property divisor:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.npar, 1, self._base.divisor)
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.divisor.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":498
 *     #.........
 *     property enp:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.enp
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_3enp_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_3enp_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_3enp___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_3enp___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":499
 *     property enp:
 *         def __get__(self):
 *             return self._base.enp             # <<<<<<<<<<<<<<
 *     #.........
 *     property s:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base->enp); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":498
 *     #.........
 *     property enp:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.enp
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.enp.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":502
 *     #.........
 *     property s:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.s
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_1s_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_1s_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_1s___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_1s___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":503
 *     property s:
 *         def __get__(self):
 *             return self._base.s             # <<<<<<<<<<<<<<
 *     #.........
 *     property one_delta:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base->s); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":502
 *     #.........
 *     property s:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.s
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.s.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":506
 *     #.........
 *     property one_delta:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.one_delta
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_9one_delta_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_9one_delta_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_9one_delta___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_9one_delta___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":507
 *     property one_delta:
 *         def __get__(self):
 *             return self._base.one_delta             # <<<<<<<<<<<<<<
 *     #.........
 *     property two_delta:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base->one_delta); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":506
 *     #.........
 *     property one_delta:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.one_delta
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.one_delta.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":510
 *     #.........
 *     property two_delta:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.two_delta
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_9two_delta_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_9two_delta_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_9two_delta___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_9two_delta___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":511
 *     property two_delta:
 *         def __get__(self):
 *             return self._base.two_delta             # <<<<<<<<<<<<<<
 *     #.........
 *     property trace_hat:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base->two_delta); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":510
 *     #.........
 *     property two_delta:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.two_delta
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.two_delta.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":514
 *     #.........
 *     property trace_hat:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.trace_hat
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_9trace_hat_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_9trace_hat_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_9trace_hat___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_9trace_hat___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":515
 *     property trace_hat:
 *         def __get__(self):
 *             return self._base.trace_hat             # <<<<<<<<<<<<<<
 *     #.........
 *     def __str__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base->trace_hat); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":514
 *     #.........
 *     property trace_hat:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.trace_hat
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.trace_hat.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":517
 *             return self._base.trace_hat
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         strg = ["Outputs................",
 *                 "Fitted values         : %s\n" % self.fitted_values,
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_1__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_1__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs___str__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs___str__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_v_strg = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__str__", 0);

  /* "_loess.pyx":519
 *     def __str__(self):
 *         strg = ["Outputs................",
 *                 "Fitted values         : %s\n" % self.fitted_values,             # <<<<<<<<<<<<<<
 *                 "Fitted residuals      : %s\n" % self.fitted_residuals,
 *                 "Eqv. nb of parameters : %s" % self.enp,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_fitted_values); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Fitted_values_s, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":520
 *         strg = ["Outputs................",
 *                 "Fitted values         : %s\n" % self.fitted_values,
 *                 "Fitted residuals      : %s\n" % self.fitted_residuals,             # <<<<<<<<<<<<<<
 *                 "Eqv. nb of parameters : %s" % self.enp,
 *                 "Residual error        : %s" % self.s,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_fitted_residuals); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_Fitted_residuals_s, __pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":521
 *                 "Fitted values         : %s\n" % self.fitted_values,
 *                 "Fitted residuals      : %s\n" % self.fitted_residuals,
 *                 "Eqv. nb of parameters : %s" % self.enp,             # <<<<<<<<<<<<<<
 *                 "Residual error        : %s" % self.s,
 *                 "Deltas                : %s - %s" % (self.one_delta, self.two_delta),
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_enp); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Eqv_nb_of_parameters_s, __pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":522
 *                 "Fitted residuals      : %s\n" % self.fitted_residuals,
 *                 "Eqv. nb of parameters : %s" % self.enp,
 *                 "Residual error        : %s" % self.s,             # <<<<<<<<<<<<<<
 *                 "Deltas                : %s - %s" % (self.one_delta, self.two_delta),
 *                 "Normalization factors : %s" % self.divisor,]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_s); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_Residual_error_s, __pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":523
 *                 "Eqv. nb of parameters : %s" % self.enp,
 *                 "Residual error        : %s" % self.s,
 *                 "Deltas                : %s - %s" % (self.one_delta, self.two_delta),             # <<<<<<<<<<<<<<
 *                 "Normalization factors : %s" % self.divisor,]
 *         return '\n'.join(strg)
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_one_delta); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_two_delta); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_6);
  __pyx_t_1 = 0;
  __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_Deltas_s_s, __pyx_t_7); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "_loess.pyx":524
 *                 "Residual error        : %s" % self.s,
 *                 "Deltas                : %s - %s" % (self.one_delta, self.two_delta),
 *                 "Normalization factors : %s" % self.divisor,]             # <<<<<<<<<<<<<<
 *         return '\n'.join(strg)
 * 
 */
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_divisor); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Normalization_factors_s, __pyx_t_7); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "_loess.pyx":518
 *     #.........
 *     def __str__(self):
 *         strg = ["Outputs................",             # <<<<<<<<<<<<<<
 *                 "Fitted values         : %s\n" % self.fitted_values,
 *                 "Fitted residuals      : %s\n" % self.fitted_residuals,
 */
  __pyx_t_7 = PyList_New(7); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_INCREF(__pyx_kp_s_Outputs);
  PyList_SET_ITEM(__pyx_t_7, 0, __pyx_kp_s_Outputs);
  __Pyx_GIVEREF(__pyx_kp_s_Outputs);
  PyList_SET_ITEM(__pyx_t_7, 1, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_7, 2, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_7, 3, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_7, 4, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_5);
  PyList_SET_ITEM(__pyx_t_7, 5, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_7, 6, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_1 = 0;
  __pyx_v_strg = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "_loess.pyx":525
 *                 "Deltas                : %s - %s" % (self.one_delta, self.two_delta),
 *                 "Normalization factors : %s" % self.divisor,]
 *         return '\n'.join(strg)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_7 = __Pyx_PyString_Join(__pyx_kp_s__7, __pyx_v_strg); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":517
 *             return self._base.trace_hat
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         strg = ["Outputs................",
 *                 "Fitted values         : %s\n" % self.fitted_values,
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("_loess.loess_outputs.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_strg);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":466
 *     cdef c_loess.c_loess_outputs *_base
 *     cdef long nobs, npar
 *     cdef readonly int activated             # <<<<<<<<<<<<<<
 *     cdef setup(self,c_loess.c_loess_outputs *base, long nobs, long npar):
 *         self._base = base
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_13loess_outputs_9activated_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_13loess_outputs_9activated_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_13loess_outputs_9activated___get__(((struct __pyx_obj_6_loess_loess_outputs *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_13loess_outputs_9activated___get__(struct __pyx_obj_6_loess_loess_outputs *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->activated); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_outputs.activated.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":546
 *     cdef readonly ndarray lower, fit, upper
 *     #.........
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         c_loess.pw_free_mem(&self._base)
 *     #.........
 */

/* Python wrapper */
static void __pyx_pw_6_loess_14conf_intervals_1__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_6_loess_14conf_intervals_1__dealloc__(PyObject *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
  __pyx_pf_6_loess_14conf_intervals___dealloc__(((struct __pyx_obj_6_loess_conf_intervals *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

static void __pyx_pf_6_loess_14conf_intervals___dealloc__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__", 0);

  /* "_loess.pyx":547
 *     #.........
 *     def __dealloc__(self):
 *         c_loess.pw_free_mem(&self._base)             # <<<<<<<<<<<<<<
 *     #.........
 *     cdef setup(self, c_loess.c_conf_inv base, long nest):
 */
  pw_free_mem((&__pyx_v_self->_base));

  /* "_loess.pyx":546
 *     cdef readonly ndarray lower, fit, upper
 *     #.........
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         c_loess.pw_free_mem(&self._base)
 *     #.........
 */

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

/* "_loess.pyx":549
 *         c_loess.pw_free_mem(&self._base)
 *     #.........
 *     cdef setup(self, c_loess.c_conf_inv base, long nest):             # <<<<<<<<<<<<<<
 *         self._base = base
 *         self.fit = floatarray_from_data(nest, 1, base.fit)
 */

static PyObject *__pyx_f_6_loess_14conf_intervals_setup(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self, conf_inv __pyx_v_base, long __pyx_v_nest) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setup", 0);

  /* "_loess.pyx":550
 *     #.........
 *     cdef setup(self, c_loess.c_conf_inv base, long nest):
 *         self._base = base             # <<<<<<<<<<<<<<
 *         self.fit = floatarray_from_data(nest, 1, base.fit)
 *         self.upper = floatarray_from_data(nest, 1, base.upper)
 */
  __pyx_v_self->_base = __pyx_v_base;

  /* "_loess.pyx":551
 *     cdef setup(self, c_loess.c_conf_inv base, long nest):
 *         self._base = base
 *         self.fit = floatarray_from_data(nest, 1, base.fit)             # <<<<<<<<<<<<<<
 *         self.upper = floatarray_from_data(nest, 1, base.upper)
 *         self.lower = floatarray_from_data(nest, 1, base.lower)
 */
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_nest, 1, __pyx_v_base.fit); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->fit);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->fit));
  __pyx_v_self->fit = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":552
 *         self._base = base
 *         self.fit = floatarray_from_data(nest, 1, base.fit)
 *         self.upper = floatarray_from_data(nest, 1, base.upper)             # <<<<<<<<<<<<<<
 *         self.lower = floatarray_from_data(nest, 1, base.lower)
 *     #.........
 */
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_nest, 1, __pyx_v_base.upper); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->upper);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->upper));
  __pyx_v_self->upper = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":553
 *         self.fit = floatarray_from_data(nest, 1, base.fit)
 *         self.upper = floatarray_from_data(nest, 1, base.upper)
 *         self.lower = floatarray_from_data(nest, 1, base.lower)             # <<<<<<<<<<<<<<
 *     #.........
 *     def __str__(self):
 */
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_nest, 1, __pyx_v_base.lower); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->lower);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->lower));
  __pyx_v_self->lower = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":549
 *         c_loess.pw_free_mem(&self._base)
 *     #.........
 *     cdef setup(self, c_loess.c_conf_inv base, long nest):             # <<<<<<<<<<<<<<
 *         self._base = base
 *         self.fit = floatarray_from_data(nest, 1, base.fit)
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.conf_intervals.setup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":555
 *         self.lower = floatarray_from_data(nest, 1, base.lower)
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         cdef ndarray tmp_ndr
 *         tmp_ndr = numpy.r_[[self.lower,self.fit,self.upper]].T
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_14conf_intervals_3__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_14conf_intervals_3__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_14conf_intervals_2__str__(((struct __pyx_obj_6_loess_conf_intervals *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_14conf_intervals_2__str__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self) {
  PyArrayObject *__pyx_v_tmp_ndr = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__str__", 0);

  /* "_loess.pyx":557
 *     def __str__(self):
 *         cdef ndarray tmp_ndr
 *         tmp_ndr = numpy.r_[[self.lower,self.fit,self.upper]].T             # <<<<<<<<<<<<<<
 *         return "Confidence intervals....\nLower b./ fit / upper b.\n%s" % \
 *                tmp_ndr
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_r); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->lower));
  PyList_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->lower));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self->lower));
  __Pyx_INCREF(((PyObject *)__pyx_v_self->fit));
  PyList_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_self->fit));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fit));
  __Pyx_INCREF(((PyObject *)__pyx_v_self->upper));
  PyList_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_v_self->upper));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self->upper));
  __pyx_t_3 = PyObject_GetItem(__pyx_t_2, __pyx_t_1); if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_tmp_ndr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":558
 *         cdef ndarray tmp_ndr
 *         tmp_ndr = numpy.r_[[self.lower,self.fit,self.upper]].T
 *         return "Confidence intervals....\nLower b./ fit / upper b.\n%s" % \             # <<<<<<<<<<<<<<
 *                tmp_ndr
 * 
 */
  __Pyx_XDECREF(__pyx_r);

  /* "_loess.pyx":559
 *         tmp_ndr = numpy.r_[[self.lower,self.fit,self.upper]].T
 *         return "Confidence intervals....\nLower b./ fit / upper b.\n%s" % \
 *                tmp_ndr             # <<<<<<<<<<<<<<
 * 
 * #####---------------------------------------------------------------------------
 */
  __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Confidence_intervals_Lower_b_fit, ((PyObject *)__pyx_v_tmp_ndr)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":555
 *         self.lower = floatarray_from_data(nest, 1, base.lower)
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         cdef ndarray tmp_ndr
 *         tmp_ndr = numpy.r_[[self.lower,self.fit,self.upper]].T
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("_loess.conf_intervals.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_tmp_ndr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":544
 *     """
 *     cdef c_loess.c_conf_inv _base
 *     cdef readonly ndarray lower, fit, upper             # <<<<<<<<<<<<<<
 *     #.........
 *     def __dealloc__(self):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_14conf_intervals_5lower_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_14conf_intervals_5lower_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_14conf_intervals_5lower___get__(((struct __pyx_obj_6_loess_conf_intervals *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_14conf_intervals_5lower___get__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->lower));
  __pyx_r = ((PyObject *)__pyx_v_self->lower);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_14conf_intervals_3fit_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_14conf_intervals_3fit_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_14conf_intervals_3fit___get__(((struct __pyx_obj_6_loess_conf_intervals *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_14conf_intervals_3fit___get__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->fit));
  __pyx_r = ((PyObject *)__pyx_v_self->fit);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_14conf_intervals_5upper_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_14conf_intervals_5upper_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_14conf_intervals_5upper___get__(((struct __pyx_obj_6_loess_conf_intervals *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_14conf_intervals_5upper___get__(struct __pyx_obj_6_loess_conf_intervals *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->upper));
  __pyx_r = ((PyObject *)__pyx_v_self->upper);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":586
 *     cdef readonly conf_intervals confidence_intervals
 *     #.........
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         c_loess.pred_free_mem(&self._base)
 *     #.........
 */

/* Python wrapper */
static void __pyx_pw_6_loess_15loess_predicted_1__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_6_loess_15loess_predicted_1__dealloc__(PyObject *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
  __pyx_pf_6_loess_15loess_predicted___dealloc__(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

static void __pyx_pf_6_loess_15loess_predicted___dealloc__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__", 0);

  /* "_loess.pyx":587
 *     #.........
 *     def __dealloc__(self):
 *         c_loess.pred_free_mem(&self._base)             # <<<<<<<<<<<<<<
 *     #.........
 *     cdef setup(self, c_loess.c_prediction base, long nest):
 */
  pred_free_mem((&__pyx_v_self->_base));

  /* "_loess.pyx":586
 *     cdef readonly conf_intervals confidence_intervals
 *     #.........
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         c_loess.pred_free_mem(&self._base)
 *     #.........
 */

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

/* "_loess.pyx":589
 *         c_loess.pred_free_mem(&self._base)
 *     #.........
 *     cdef setup(self, c_loess.c_prediction base, long nest):             # <<<<<<<<<<<<<<
 *         self._base = base
 *         self.nest = nest
 */

static PyObject *__pyx_f_6_loess_15loess_predicted_setup(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self, prediction __pyx_v_base, long __pyx_v_nest) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setup", 0);

  /* "_loess.pyx":590
 *     #.........
 *     cdef setup(self, c_loess.c_prediction base, long nest):
 *         self._base = base             # <<<<<<<<<<<<<<
 *         self.nest = nest
 *     #.........
 */
  __pyx_v_self->_base = __pyx_v_base;

  /* "_loess.pyx":591
 *     cdef setup(self, c_loess.c_prediction base, long nest):
 *         self._base = base
 *         self.nest = nest             # <<<<<<<<<<<<<<
 *     #.........
 *     property values:
 */
  __pyx_v_self->nest = __pyx_v_nest;

  /* "_loess.pyx":589
 *         c_loess.pred_free_mem(&self._base)
 *     #.........
 *     cdef setup(self, c_loess.c_prediction base, long nest):             # <<<<<<<<<<<<<<
 *         self._base = base
 *         self.nest = nest
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":594
 *     #.........
 *     property values:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nest, 1, self._base.fit)
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_15loess_predicted_6values_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_15loess_predicted_6values_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_15loess_predicted_6values___get__(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_15loess_predicted_6values___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":595
 *     property values:
 *         def __get__(self):
 *             return floatarray_from_data(self.nest, 1, self._base.fit)             # <<<<<<<<<<<<<<
 *     #.........
 *     property stderr:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_self->nest, 1, __pyx_v_self->_base.fit); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 595; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":594
 *     #.........
 *     property values:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nest, 1, self._base.fit)
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_predicted.values.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":598
 *     #.........
 *     property stderr:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nest, 1, self._base.se_fit)
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_15loess_predicted_6stderr_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_15loess_predicted_6stderr_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_15loess_predicted_6stderr___get__(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_15loess_predicted_6stderr___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":599
 *     property stderr:
 *         def __get__(self):
 *             return floatarray_from_data(self.nest, 1, self._base.se_fit)             # <<<<<<<<<<<<<<
 *     #.........
 *     property residual_scale:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6_loess_floatarray_from_data(__pyx_v_self->nest, 1, __pyx_v_self->_base.se_fit); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":598
 *     #.........
 *     property stderr:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return floatarray_from_data(self.nest, 1, self._base.se_fit)
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_predicted.stderr.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":602
 *     #.........
 *     property residual_scale:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.residual_scale
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_15loess_predicted_14residual_scale_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_15loess_predicted_14residual_scale_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_15loess_predicted_14residual_scale___get__(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_15loess_predicted_14residual_scale___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":603
 *     property residual_scale:
 *         def __get__(self):
 *             return self._base.residual_scale             # <<<<<<<<<<<<<<
 *     #.........
 *     property df:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base.residual_scale); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":602
 *     #.........
 *     property residual_scale:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.residual_scale
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_predicted.residual_scale.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":606
 *     #.........
 *     property df:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.df
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_15loess_predicted_2df_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_15loess_predicted_2df_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_15loess_predicted_2df___get__(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_15loess_predicted_2df___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);

  /* "_loess.pyx":607
 *     property df:
 *         def __get__(self):
 *             return self._base.df             # <<<<<<<<<<<<<<
 *     #.........
 *     def confidence(self, coverage=0.95):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->_base.df); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":606
 *     #.........
 *     property df:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._base.df
 *     #.........
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_predicted.df.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":609
 *             return self._base.df
 *     #.........
 *     def confidence(self, coverage=0.95):             # <<<<<<<<<<<<<<
 *         """Returns the pointwise confidence intervals for each predicted values,
 * at the given confidence interval coverage.
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_15loess_predicted_3confidence(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6_loess_15loess_predicted_2confidence[] = "Returns the pointwise confidence intervals for each predicted values,\nat the given confidence interval coverage.\n        \n:Parameters:\n    coverage : float\n        Confidence level of the confidence intervals limits, as a fraction.\n        \n:Returns:\n    A new conf_intervals object, consisting of:\n    fit : ndarray\n        Predicted values.\n    lower : ndarray\n        Lower bounds of the confidence intervals.\n    upper : ndarray\n        Upper bounds of the confidence intervals.\n        ";
static PyObject *__pyx_pw_6_loess_15loess_predicted_3confidence(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coverage = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("confidence (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_coverage,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_float_0_95);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_coverage);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "confidence") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_coverage = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("confidence", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("_loess.loess_predicted.confidence", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6_loess_15loess_predicted_2confidence(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self), __pyx_v_coverage);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_15loess_predicted_2confidence(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self, PyObject *__pyx_v_coverage) {
  conf_inv __pyx_v__confintv;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  double __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("confidence", 0);
  __Pyx_INCREF(__pyx_v_coverage);

  /* "_loess.pyx":627
 *         """
 *         cdef c_loess.c_conf_inv _confintv
 *         if coverage < 0.5:             # <<<<<<<<<<<<<<
 *             coverage = 1. - coverage
 *         if coverage > 1. :
 */
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_coverage, __pyx_float_0_5, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 627; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 627; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {

    /* "_loess.pyx":628
 *         cdef c_loess.c_conf_inv _confintv
 *         if coverage < 0.5:
 *             coverage = 1. - coverage             # <<<<<<<<<<<<<<
 *         if coverage > 1. :
 *             raise ValueError("The coverage precentage should be between 0 and 1!")
 */
    __pyx_t_1 = PyNumber_Subtract(__pyx_float_1_, __pyx_v_coverage); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF_SET(__pyx_v_coverage, __pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "_loess.pyx":629
 *         if coverage < 0.5:
 *             coverage = 1. - coverage
 *         if coverage > 1. :             # <<<<<<<<<<<<<<
 *             raise ValueError("The coverage precentage should be between 0 and 1!")
 *         c_loess.c_pointwise(&self._base, self.nest, coverage, &_confintv)
 */
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_coverage, __pyx_float_1_, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {

    /* "_loess.pyx":630
 *             coverage = 1. - coverage
 *         if coverage > 1. :
 *             raise ValueError("The coverage precentage should be between 0 and 1!")             # <<<<<<<<<<<<<<
 *         c_loess.c_pointwise(&self._base, self.nest, coverage, &_confintv)
 *         self.confidence_intervals = conf_intervals()
 */
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":631
 *         if coverage > 1. :
 *             raise ValueError("The coverage precentage should be between 0 and 1!")
 *         c_loess.c_pointwise(&self._base, self.nest, coverage, &_confintv)             # <<<<<<<<<<<<<<
 *         self.confidence_intervals = conf_intervals()
 *         self.confidence_intervals.setup(_confintv, self.nest)
 */
  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_v_coverage); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  pointwise((&__pyx_v_self->_base), __pyx_v_self->nest, __pyx_t_3, (&__pyx_v__confintv));

  /* "_loess.pyx":632
 *             raise ValueError("The coverage precentage should be between 0 and 1!")
 *         c_loess.c_pointwise(&self._base, self.nest, coverage, &_confintv)
 *         self.confidence_intervals = conf_intervals()             # <<<<<<<<<<<<<<
 *         self.confidence_intervals.setup(_confintv, self.nest)
 *         return self.confidence_intervals
 */
  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6_loess_conf_intervals)), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->confidence_intervals);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->confidence_intervals));
  __pyx_v_self->confidence_intervals = ((struct __pyx_obj_6_loess_conf_intervals *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":633
 *         c_loess.c_pointwise(&self._base, self.nest, coverage, &_confintv)
 *         self.confidence_intervals = conf_intervals()
 *         self.confidence_intervals.setup(_confintv, self.nest)             # <<<<<<<<<<<<<<
 *         return self.confidence_intervals
 *     #.........
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_6_loess_conf_intervals *)__pyx_v_self->confidence_intervals->__pyx_vtab)->setup(__pyx_v_self->confidence_intervals, __pyx_v__confintv, __pyx_v_self->nest); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":634
 *         self.confidence_intervals = conf_intervals()
 *         self.confidence_intervals.setup(_confintv, self.nest)
 *         return self.confidence_intervals             # <<<<<<<<<<<<<<
 *     #.........
 *     def __str__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->confidence_intervals));
  __pyx_r = ((PyObject *)__pyx_v_self->confidence_intervals);
  goto __pyx_L0;

  /* "_loess.pyx":609
 *             return self._base.df
 *     #.........
 *     def confidence(self, coverage=0.95):             # <<<<<<<<<<<<<<
 *         """Returns the pointwise confidence intervals for each predicted values,
 * at the given confidence interval coverage.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_predicted.confidence", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_coverage);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":636
 *         return self.confidence_intervals
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         strg = ["Outputs................",
 *                 "Predicted values      : %s\n" % self.values,
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_15loess_predicted_5__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_15loess_predicted_5__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_15loess_predicted_4__str__(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_15loess_predicted_4__str__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self) {
  PyObject *__pyx_v_strg = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__str__", 0);

  /* "_loess.pyx":638
 *     def __str__(self):
 *         strg = ["Outputs................",
 *                 "Predicted values      : %s\n" % self.values,             # <<<<<<<<<<<<<<
 *                 "Predicted std error   : %s\n" % self.stderr,
 *                 "Residual scale        : %s" % self.residual_scale,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_values); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Predicted_values_s, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":639
 *         strg = ["Outputs................",
 *                 "Predicted values      : %s\n" % self.values,
 *                 "Predicted std error   : %s\n" % self.stderr,             # <<<<<<<<<<<<<<
 *                 "Residual scale        : %s" % self.residual_scale,
 *                 "Degrees of freedom    : %s" % self.df,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_stderr); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_Predicted_std_error_s, __pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":640
 *                 "Predicted values      : %s\n" % self.values,
 *                 "Predicted std error   : %s\n" % self.stderr,
 *                 "Residual scale        : %s" % self.residual_scale,             # <<<<<<<<<<<<<<
 *                 "Degrees of freedom    : %s" % self.df,
 * #                "Confidence intervals  : %s" % self.confidence,
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_residual_scale); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Residual_scale_s, __pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":641
 *                 "Predicted std error   : %s\n" % self.stderr,
 *                 "Residual scale        : %s" % self.residual_scale,
 *                 "Degrees of freedom    : %s" % self.df,             # <<<<<<<<<<<<<<
 * #                "Confidence intervals  : %s" % self.confidence,
 *                 ]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_df); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_Degrees_of_freedom_s, __pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":637
 *     #.........
 *     def __str__(self):
 *         strg = ["Outputs................",             # <<<<<<<<<<<<<<
 *                 "Predicted values      : %s\n" % self.values,
 *                 "Predicted std error   : %s\n" % self.stderr,
 */
  __pyx_t_1 = PyList_New(5); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_kp_s_Outputs);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_s_Outputs);
  __Pyx_GIVEREF(__pyx_kp_s_Outputs);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_1, 4, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_v_strg = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":644
 * #                "Confidence intervals  : %s" % self.confidence,
 *                 ]
 *         return '\n'.join(strg)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyString_Join(__pyx_kp_s__7, __pyx_v_strg); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 644; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":636
 *         return self.confidence_intervals
 *     #.........
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         strg = ["Outputs................",
 *                 "Predicted values      : %s\n" % self.values,
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("_loess.loess_predicted.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_strg);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":583
 * 
 *     cdef c_loess.c_prediction _base
 *     cdef readonly long nest             # <<<<<<<<<<<<<<
 *     cdef readonly conf_intervals confidence_intervals
 *     #.........
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_15loess_predicted_4nest_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_15loess_predicted_4nest_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_15loess_predicted_4nest___get__(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_15loess_predicted_4nest___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_self->nest); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.loess_predicted.nest.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":584
 *     cdef c_loess.c_prediction _base
 *     cdef readonly long nest
 *     cdef readonly conf_intervals confidence_intervals             # <<<<<<<<<<<<<<
 *     #.........
 *     def __dealloc__(self):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_15loess_predicted_20confidence_intervals_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_15loess_predicted_20confidence_intervals_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_15loess_predicted_20confidence_intervals___get__(((struct __pyx_obj_6_loess_loess_predicted *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_15loess_predicted_20confidence_intervals___get__(struct __pyx_obj_6_loess_loess_predicted *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->confidence_intervals));
  __pyx_r = ((PyObject *)__pyx_v_self->confidence_intervals);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":758
 *     cdef readonly loess_predicted predicted
 * 
 *     def __init__(self, object x, object y, object weights=None, **options):             # <<<<<<<<<<<<<<
 *         #
 *         cdef ndarray x_ndr, y_ndr
 */

/* Python wrapper */
static int __pyx_pw_6_loess_5loess_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6_loess_5loess_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  CYTHON_UNUSED PyObject *__pyx_v_weights = 0;
  PyObject *__pyx_v_options = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  __pyx_v_options = PyDict_New(); if (unlikely(!__pyx_v_options)) return -1;
  __Pyx_GOTREF(__pyx_v_options);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,&__pyx_n_s_weights,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_weights);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_options, values, pos_args, "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_x = values[0];
    __pyx_v_y = values[1];
    __pyx_v_weights = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_DECREF(__pyx_v_options); __pyx_v_options = 0;
  __Pyx_AddTraceback("_loess.loess.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6_loess_5loess___init__(((struct __pyx_obj_6_loess_loess *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_weights, __pyx_v_options);

  /* function exit code */
  __Pyx_XDECREF(__pyx_v_options);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_5loess___init__(struct __pyx_obj_6_loess_loess *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, CYTHON_UNUSED PyObject *__pyx_v_weights, PyObject *__pyx_v_options) {
  double *__pyx_v_x_dat;
  double *__pyx_v_y_dat;
  int __pyx_v_n;
  int __pyx_v_p;
  PyObject *__pyx_v_modelopt = NULL;
  PyObject *__pyx_v_controlopt = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_v_v = NULL;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  Py_ssize_t __pyx_t_4;
  Py_ssize_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__", 0);

  /* "_loess.pyx":764
 *         cdef int i
 *         # Initialize the inputs .......
 *         self.inputs = loess_inputs(x, y)             # <<<<<<<<<<<<<<
 *         x_dat = <double *>self.inputs.x_eff.data
 *         y_dat = <double *>self.inputs.y_eff.data
 */
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_x);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_x);
  __Pyx_GIVEREF(__pyx_v_x);
  __Pyx_INCREF(__pyx_v_y);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_y);
  __Pyx_GIVEREF(__pyx_v_y);
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6_loess_loess_inputs)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->inputs);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->inputs));
  __pyx_v_self->inputs = ((struct __pyx_obj_6_loess_loess_inputs *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":765
 *         # Initialize the inputs .......
 *         self.inputs = loess_inputs(x, y)
 *         x_dat = <double *>self.inputs.x_eff.data             # <<<<<<<<<<<<<<
 *         y_dat = <double *>self.inputs.y_eff.data
 *         n = self.inputs.nobs
 */
  __pyx_v_x_dat = ((double *)__pyx_v_self->inputs->x_eff->data);

  /* "_loess.pyx":766
 *         self.inputs = loess_inputs(x, y)
 *         x_dat = <double *>self.inputs.x_eff.data
 *         y_dat = <double *>self.inputs.y_eff.data             # <<<<<<<<<<<<<<
 *         n = self.inputs.nobs
 *         p = self.inputs.npar
 */
  __pyx_v_y_dat = ((double *)__pyx_v_self->inputs->y_eff->data);

  /* "_loess.pyx":767
 *         x_dat = <double *>self.inputs.x_eff.data
 *         y_dat = <double *>self.inputs.y_eff.data
 *         n = self.inputs.nobs             # <<<<<<<<<<<<<<
 *         p = self.inputs.npar
 *         c_loess.loess_setup(x_dat, y_dat, n, p, &self._base)
 */
  __pyx_t_3 = __pyx_v_self->inputs->nobs;
  __pyx_v_n = __pyx_t_3;

  /* "_loess.pyx":768
 *         y_dat = <double *>self.inputs.y_eff.data
 *         n = self.inputs.nobs
 *         p = self.inputs.npar             # <<<<<<<<<<<<<<
 *         c_loess.loess_setup(x_dat, y_dat, n, p, &self._base)
 *         # Sets the _base input .........
 */
  __pyx_t_3 = __pyx_v_self->inputs->npar;
  __pyx_v_p = __pyx_t_3;

  /* "_loess.pyx":769
 *         n = self.inputs.nobs
 *         p = self.inputs.npar
 *         c_loess.loess_setup(x_dat, y_dat, n, p, &self._base)             # <<<<<<<<<<<<<<
 *         # Sets the _base input .........
 *         self.inputs._base = &self._base.inputs
 */
  loess_setup(__pyx_v_x_dat, __pyx_v_y_dat, __pyx_v_n, __pyx_v_p, (&__pyx_v_self->_base));

  /* "_loess.pyx":771
 *         c_loess.loess_setup(x_dat, y_dat, n, p, &self._base)
 *         # Sets the _base input .........
 *         self.inputs._base = &self._base.inputs             # <<<<<<<<<<<<<<
 *         # Initialize the model parameters
 *         self.model = loess_model()
 */
  __pyx_v_self->inputs->_base = (&__pyx_v_self->_base.inputs);

  /* "_loess.pyx":773
 *         self.inputs._base = &self._base.inputs
 *         # Initialize the model parameters
 *         self.model = loess_model()             # <<<<<<<<<<<<<<
 *         self.model.setup(&self._base.model, p)
 *         # Initialize the control parameters
 */
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6_loess_loess_model)), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->model);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->model));
  __pyx_v_self->model = ((struct __pyx_obj_6_loess_loess_model *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":774
 *         # Initialize the model parameters
 *         self.model = loess_model()
 *         self.model.setup(&self._base.model, p)             # <<<<<<<<<<<<<<
 *         # Initialize the control parameters
 *         self.control = loess_control()
 */
  __pyx_t_2 = ((struct __pyx_vtabstruct_6_loess_loess_model *)__pyx_v_self->model->__pyx_vtab)->setup(__pyx_v_self->model, (&__pyx_v_self->_base.model), __pyx_v_p); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "_loess.pyx":776
 *         self.model.setup(&self._base.model, p)
 *         # Initialize the control parameters
 *         self.control = loess_control()             # <<<<<<<<<<<<<<
 *         self.control._base = &self._base.control
 *         # Initialize the kd tree ......
 */
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6_loess_loess_control)), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->control);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->control));
  __pyx_v_self->control = ((struct __pyx_obj_6_loess_loess_control *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":777
 *         # Initialize the control parameters
 *         self.control = loess_control()
 *         self.control._base = &self._base.control             # <<<<<<<<<<<<<<
 *         # Initialize the kd tree ......
 *         self.kd_tree = loess_kd_tree()
 */
  __pyx_v_self->control->_base = (&__pyx_v_self->_base.control);

  /* "_loess.pyx":779
 *         self.control._base = &self._base.control
 *         # Initialize the kd tree ......
 *         self.kd_tree = loess_kd_tree()             # <<<<<<<<<<<<<<
 *         self.kd_tree._base = &self._base.kd_tree
 *         # Initialize the outputs ......
 */
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6_loess_loess_kd_tree)), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->kd_tree);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->kd_tree));
  __pyx_v_self->kd_tree = ((struct __pyx_obj_6_loess_loess_kd_tree *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":780
 *         # Initialize the kd tree ......
 *         self.kd_tree = loess_kd_tree()
 *         self.kd_tree._base = &self._base.kd_tree             # <<<<<<<<<<<<<<
 *         # Initialize the outputs ......
 *         self.outputs = loess_outputs()
 */
  __pyx_v_self->kd_tree->_base = (&__pyx_v_self->_base.kd_tree);

  /* "_loess.pyx":782
 *         self.kd_tree._base = &self._base.kd_tree
 *         # Initialize the outputs ......
 *         self.outputs = loess_outputs()             # <<<<<<<<<<<<<<
 *         self.outputs.setup(&self._base.outputs, n, p,)
 *         # Process options .............
 */
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6_loess_loess_outputs)), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->outputs);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->outputs));
  __pyx_v_self->outputs = ((struct __pyx_obj_6_loess_loess_outputs *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":783
 *         # Initialize the outputs ......
 *         self.outputs = loess_outputs()
 *         self.outputs.setup(&self._base.outputs, n, p,)             # <<<<<<<<<<<<<<
 *         # Process options .............
 *         modelopt = {}
 */
  __pyx_t_2 = ((struct __pyx_vtabstruct_6_loess_loess_outputs *)__pyx_v_self->outputs->__pyx_vtab)->setup(__pyx_v_self->outputs, (&__pyx_v_self->_base.outputs), __pyx_v_n, __pyx_v_p); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "_loess.pyx":785
 *         self.outputs.setup(&self._base.outputs, n, p,)
 *         # Process options .............
 *         modelopt = {}             # <<<<<<<<<<<<<<
 *         controlopt = {}
 *         for (k,v) in options.iteritems():
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_modelopt = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":786
 *         # Process options .............
 *         modelopt = {}
 *         controlopt = {}             # <<<<<<<<<<<<<<
 *         for (k,v) in options.iteritems():
 *             if k in ('family', 'span', 'degree', 'normalize',
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_controlopt = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":787
 *         modelopt = {}
 *         controlopt = {}
 *         for (k,v) in options.iteritems():             # <<<<<<<<<<<<<<
 *             if k in ('family', 'span', 'degree', 'normalize',
 *                      'parametric', 'drop_square',):
 */
  __pyx_t_4 = 0;
  __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_options, 1, __pyx_n_s_iteritems, (&__pyx_t_5), (&__pyx_t_3)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = __pyx_t_1;
  __pyx_t_1 = 0;
  while (1) {
    __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_2, __pyx_t_5, &__pyx_t_4, &__pyx_t_1, &__pyx_t_6, NULL, __pyx_t_3);
    if (unlikely(__pyx_t_7 == 0)) break;
    if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_XDECREF_SET(__pyx_v_k, __pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_XDECREF_SET(__pyx_v_v, __pyx_t_6);
    __pyx_t_6 = 0;

    /* "_loess.pyx":788
 *         controlopt = {}
 *         for (k,v) in options.iteritems():
 *             if k in ('family', 'span', 'degree', 'normalize',             # <<<<<<<<<<<<<<
 *                      'parametric', 'drop_square',):
 *                 modelopt[k] = v
 */
    __Pyx_INCREF(__pyx_v_k);
    __pyx_t_6 = __pyx_v_k;
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_family, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_span, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_degree, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_normalize, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_parametric, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_drop_square, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_8 = __pyx_t_9;
    __pyx_L6_bool_binop_done:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_9 = (__pyx_t_8 != 0);
    if (__pyx_t_9) {

      /* "_loess.pyx":790
 *             if k in ('family', 'span', 'degree', 'normalize',
 *                      'parametric', 'drop_square',):
 *                 modelopt[k] = v             # <<<<<<<<<<<<<<
 *             elif k in ('surface', 'statistics', 'trace_hat',
 *                        'iterations', 'cell'):
 */
      if (unlikely(PyDict_SetItem(__pyx_v_modelopt, __pyx_v_k, __pyx_v_v) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L5;
    }

    /* "_loess.pyx":791
 *                      'parametric', 'drop_square',):
 *                 modelopt[k] = v
 *             elif k in ('surface', 'statistics', 'trace_hat',             # <<<<<<<<<<<<<<
 *                        'iterations', 'cell'):
 *                 controlopt[k] = v
 */
    __Pyx_INCREF(__pyx_v_k);
    __pyx_t_6 = __pyx_v_k;
    __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_surface, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_8) {
    } else {
      __pyx_t_9 = __pyx_t_8;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_statistics, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_8) {
    } else {
      __pyx_t_9 = __pyx_t_8;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_trace_hat, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_8) {
    } else {
      __pyx_t_9 = __pyx_t_8;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_iterations, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!__pyx_t_8) {
    } else {
      __pyx_t_9 = __pyx_t_8;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_cell, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_9 = __pyx_t_8;
    __pyx_L12_bool_binop_done:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = (__pyx_t_9 != 0);
    if (__pyx_t_8) {

      /* "_loess.pyx":793
 *             elif k in ('surface', 'statistics', 'trace_hat',
 *                        'iterations', 'cell'):
 *                 controlopt[k] = v             # <<<<<<<<<<<<<<
 *         self.control.update(**controlopt)
 *         self.model.update(**modelopt)
 */
      if (unlikely(PyDict_SetItem(__pyx_v_controlopt, __pyx_v_k, __pyx_v_v) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "_loess.pyx":794
 *                        'iterations', 'cell'):
 *                 controlopt[k] = v
 *         self.control.update(**controlopt)             # <<<<<<<<<<<<<<
 *         self.model.update(**modelopt)
 *     #......................................................
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->control), __pyx_n_s_update); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = __pyx_v_controlopt;
  __Pyx_INCREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_6); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":795
 *                 controlopt[k] = v
 *         self.control.update(**controlopt)
 *         self.model.update(**modelopt)             # <<<<<<<<<<<<<<
 *     #......................................................
 *     def fit(self):
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->model), __pyx_n_s_update); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __pyx_v_modelopt;
  __Pyx_INCREF(__pyx_t_6);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_empty_tuple, __pyx_t_6); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "_loess.pyx":758
 *     cdef readonly loess_predicted predicted
 * 
 *     def __init__(self, object x, object y, object weights=None, **options):             # <<<<<<<<<<<<<<
 *         #
 *         cdef ndarray x_ndr, y_ndr
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("_loess.loess.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_modelopt);
  __Pyx_XDECREF(__pyx_v_controlopt);
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":797
 *         self.model.update(**modelopt)
 *     #......................................................
 *     def fit(self):             # <<<<<<<<<<<<<<
 *         """Computes the loess parameters on the current inputs and sets of parameters."""
 *         c_loess.loess_fit(&self._base)
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_3fit(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6_loess_5loess_2fit[] = "Computes the loess parameters on the current inputs and sets of parameters.";
static PyObject *__pyx_pw_6_loess_5loess_3fit(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("fit (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_2fit(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_2fit(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("fit", 0);

  /* "_loess.pyx":799
 *     def fit(self):
 *         """Computes the loess parameters on the current inputs and sets of parameters."""
 *         c_loess.loess_fit(&self._base)             # <<<<<<<<<<<<<<
 *         self.outputs.activated = True
 *         if self._base.status.err_status:
 */
  loess_fit((&__pyx_v_self->_base));

  /* "_loess.pyx":800
 *         """Computes the loess parameters on the current inputs and sets of parameters."""
 *         c_loess.loess_fit(&self._base)
 *         self.outputs.activated = True             # <<<<<<<<<<<<<<
 *         if self._base.status.err_status:
 *             raise ValueError(self._base.status.err_msg)
 */
  __pyx_v_self->outputs->activated = 1;

  /* "_loess.pyx":801
 *         c_loess.loess_fit(&self._base)
 *         self.outputs.activated = True
 *         if self._base.status.err_status:             # <<<<<<<<<<<<<<
 *             raise ValueError(self._base.status.err_msg)
 *         return
 */
  __pyx_t_1 = (__pyx_v_self->_base.status.err_status != 0);
  if (__pyx_t_1) {

    /* "_loess.pyx":802
 *         self.outputs.activated = True
 *         if self._base.status.err_status:
 *             raise ValueError(self._base.status.err_msg)             # <<<<<<<<<<<<<<
 *         return
 *     #......................................................
 */
    __pyx_t_2 = __Pyx_PyBytes_FromString(__pyx_v_self->_base.status.err_msg); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":803
 *         if self._base.status.err_status:
 *             raise ValueError(self._base.status.err_msg)
 *         return             # <<<<<<<<<<<<<<
 *     #......................................................
 *     def input_summary(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;

  /* "_loess.pyx":797
 *         self.model.update(**modelopt)
 *     #......................................................
 *     def fit(self):             # <<<<<<<<<<<<<<
 *         """Computes the loess parameters on the current inputs and sets of parameters."""
 *         c_loess.loess_fit(&self._base)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("_loess.loess.fit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":805
 *         return
 *     #......................................................
 *     def input_summary(self):             # <<<<<<<<<<<<<<
 *         """Returns some generic information about the loess parameters.
 *         """
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_5input_summary(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6_loess_5loess_4input_summary[] = "Returns some generic information about the loess parameters.\n        ";
static PyObject *__pyx_pw_6_loess_5loess_5input_summary(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("input_summary (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_4input_summary(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_4input_summary(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_v_toprint = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("input_summary", 0);

  /* "_loess.pyx":808
 *         """Returns some generic information about the loess parameters.
 *         """
 *         toprint = [str(self.inputs), str(self.model), str(self.control)]             # <<<<<<<<<<<<<<
 *         return "\n".join(toprint)
 * 
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->inputs));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->inputs));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self->inputs));
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->model));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->model));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self->model));
  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->control));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->control));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self->control));
  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_toprint = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "_loess.pyx":809
 *         """
 *         toprint = [str(self.inputs), str(self.model), str(self.control)]
 *         return "\n".join(toprint)             # <<<<<<<<<<<<<<
 * 
 *     def output_summary(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyString_Join(__pyx_kp_s__7, __pyx_v_toprint); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "_loess.pyx":805
 *         return
 *     #......................................................
 *     def input_summary(self):             # <<<<<<<<<<<<<<
 *         """Returns some generic information about the loess parameters.
 *         """
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("_loess.loess.input_summary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_toprint);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":811
 *         return "\n".join(toprint)
 * 
 *     def output_summary(self):             # <<<<<<<<<<<<<<
 *         """Returns some generic information about the loess fit."""
 *         print "Number of Observations         : %d" % self.inputs.nobs
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_7output_summary(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6_loess_5loess_6output_summary[] = "Returns some generic information about the loess fit.";
static PyObject *__pyx_pw_6_loess_5loess_7output_summary(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("output_summary (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_6output_summary(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_6output_summary(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("output_summary", 0);

  /* "_loess.pyx":813
 *     def output_summary(self):
 *         """Returns some generic information about the loess fit."""
 *         print "Number of Observations         : %d" % self.inputs.nobs             # <<<<<<<<<<<<<<
 *         print "Fit flag                       : %d" % bool(self.outputs.activated)
 *         print "Equivalent Number of Parameters: %.1f" % self.outputs.enp
 */
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->inputs->nobs); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Number_of_Observations_d, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__Pyx_PrintOne(0, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "_loess.pyx":814
 *         """Returns some generic information about the loess fit."""
 *         print "Number of Observations         : %d" % self.inputs.nobs
 *         print "Fit flag                       : %d" % bool(self.outputs.activated)             # <<<<<<<<<<<<<<
 *         print "Equivalent Number of Parameters: %.1f" % self.outputs.enp
 *         if self.model.family == "gaussian":
 */
  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->outputs->activated); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyBool_FromLong((!(!__pyx_t_3))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Fit_flag_d, __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__Pyx_PrintOne(0, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":815
 *         print "Number of Observations         : %d" % self.inputs.nobs
 *         print "Fit flag                       : %d" % bool(self.outputs.activated)
 *         print "Equivalent Number of Parameters: %.1f" % self.outputs.enp             # <<<<<<<<<<<<<<
 *         if self.model.family == "gaussian":
 *             print "Residual Standard Error        : %.4f" % self.outputs.s
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->outputs), __pyx_n_s_enp); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Equivalent_Number_of_Parameters, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__Pyx_PrintOne(0, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "_loess.pyx":816
 *         print "Fit flag                       : %d" % bool(self.outputs.activated)
 *         print "Equivalent Number of Parameters: %.1f" % self.outputs.enp
 *         if self.model.family == "gaussian":             # <<<<<<<<<<<<<<
 *             print "Residual Standard Error        : %.4f" % self.outputs.s
 *         else:
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->model), __pyx_n_s_family); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = (__Pyx_PyString_Equals(__pyx_t_2, __pyx_n_s_gaussian, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "_loess.pyx":817
 *         print "Equivalent Number of Parameters: %.1f" % self.outputs.enp
 *         if self.model.family == "gaussian":
 *             print "Residual Standard Error        : %.4f" % self.outputs.s             # <<<<<<<<<<<<<<
 *         else:
 *             print "Residual Scale Estimate        : %.4f" % self.outputs.s
 */
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->outputs), __pyx_n_s_s); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Residual_Standard_Error_4f, __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "_loess.pyx":819
 *             print "Residual Standard Error        : %.4f" % self.outputs.s
 *         else:
 *             print "Residual Scale Estimate        : %.4f" % self.outputs.s             # <<<<<<<<<<<<<<
 *     #......................................................
 *     def predict(self, newdata, stderror=False):
 */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->outputs), __pyx_n_s_s); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Residual_Scale_Estimate_4f, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__Pyx_PrintOne(0, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_L3:;

  /* "_loess.pyx":811
 *         return "\n".join(toprint)
 * 
 *     def output_summary(self):             # <<<<<<<<<<<<<<
 *         """Returns some generic information about the loess fit."""
 *         print "Number of Observations         : %d" % self.inputs.nobs
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("_loess.loess.output_summary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":821
 *             print "Residual Scale Estimate        : %.4f" % self.outputs.s
 *     #......................................................
 *     def predict(self, newdata, stderror=False):             # <<<<<<<<<<<<<<
 *         """Computes loess estimates at the given new data points newdata. Returns
 * a loess_predicted object, whose attributes are described below.
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_9predict(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6_loess_5loess_8predict[] = "Computes loess estimates at the given new data points newdata. Returns\na loess_predicted object, whose attributes are described below.\n        \n:Parameters:\n    newdata : ndarray\n        The (m,p) array of independent variables where the surface must be estimated,\n        with m the number of new data points, and p the number of independent\n        variables.\n    stderror : boolean\n        Whether the standard error should be computed\n        \n:Returns:\n    A new loess_predicted object, consisting of:\n    values : ndarray\n        The (m,) ndarray of loess values evaluated at newdata\n    stderr : ndarray\n        The (m,) ndarray of the estimates of the standard error on the estimated\n        values.\n    residual_scale : float\n        Estimate of the scale of the residuals\n    df : integer\n        Degrees of freedom of the t-distribution used to compute pointwise \n        confidence intervals for the evaluated surface.\n    nest : integer\n        Number of new observations.\n        ";
static PyObject *__pyx_pw_6_loess_5loess_9predict(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_newdata = 0;
  PyObject *__pyx_v_stderror = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("predict (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_newdata,&__pyx_n_s_stderror,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_newdata)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_stderror);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_newdata = values[0];
    __pyx_v_stderror = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("predict", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("_loess.loess.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6_loess_5loess_8predict(((struct __pyx_obj_6_loess_loess *)__pyx_v_self), __pyx_v_newdata, __pyx_v_stderror);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_8predict(struct __pyx_obj_6_loess_loess *__pyx_v_self, PyObject *__pyx_v_newdata, PyObject *__pyx_v_stderror) {
  PyArrayObject *__pyx_v_p_ndr = 0;
  double *__pyx_v_p_dat;
  prediction __pyx_v__prediction;
  int __pyx_v_m;
  PyObject *__pyx_v_notOK = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  Py_ssize_t __pyx_t_7;
  PyObject *(*__pyx_t_8)(PyObject *);
  int __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("predict", 0);

  /* "_loess.pyx":853
 *         cdef int i, m
 *         # Make sure there's been a fit earlier ...
 *         if self.outputs.activated == 0:             # <<<<<<<<<<<<<<
 *             c_loess.loess_fit(&self._base)
 *             self.outputs.activated = True
 */
  __pyx_t_1 = ((__pyx_v_self->outputs->activated == 0) != 0);
  if (__pyx_t_1) {

    /* "_loess.pyx":854
 *         # Make sure there's been a fit earlier ...
 *         if self.outputs.activated == 0:
 *             c_loess.loess_fit(&self._base)             # <<<<<<<<<<<<<<
 *             self.outputs.activated = True
 *             if self._base.status.err_status:
 */
    loess_fit((&__pyx_v_self->_base));

    /* "_loess.pyx":855
 *         if self.outputs.activated == 0:
 *             c_loess.loess_fit(&self._base)
 *             self.outputs.activated = True             # <<<<<<<<<<<<<<
 *             if self._base.status.err_status:
 *                 raise ValueError(self._base.status.err_msg)
 */
    __pyx_v_self->outputs->activated = 1;

    /* "_loess.pyx":856
 *             c_loess.loess_fit(&self._base)
 *             self.outputs.activated = True
 *             if self._base.status.err_status:             # <<<<<<<<<<<<<<
 *                 raise ValueError(self._base.status.err_msg)
 *         # Note : we need a copy as we may have to normalize
 */
    __pyx_t_1 = (__pyx_v_self->_base.status.err_status != 0);
    if (__pyx_t_1) {

      /* "_loess.pyx":857
 *             self.outputs.activated = True
 *             if self._base.status.err_status:
 *                 raise ValueError(self._base.status.err_msg)             # <<<<<<<<<<<<<<
 *         # Note : we need a copy as we may have to normalize
 *         p_ndr = narray(newdata, copy=True, subok=True, order='C').ravel()
 */
      __pyx_t_2 = __Pyx_PyBytes_FromString(__pyx_v_self->_base.status.err_msg); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "_loess.pyx":859
 *                 raise ValueError(self._base.status.err_msg)
 *         # Note : we need a copy as we may have to normalize
 *         p_ndr = narray(newdata, copy=True, subok=True, order='C').ravel()             # <<<<<<<<<<<<<<
 *         p_dat = <double *>p_ndr.data
 *         # Test the compatibility of sizes .......
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_narray); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_INCREF(__pyx_v_newdata);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_newdata);
  __Pyx_GIVEREF(__pyx_v_newdata);
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_copy, Py_True) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_subok, Py_True) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_order, __pyx_n_s_C) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ravel); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7c_numpy_ndarray))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_p_ndr = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "_loess.pyx":860
 *         # Note : we need a copy as we may have to normalize
 *         p_ndr = narray(newdata, copy=True, subok=True, order='C').ravel()
 *         p_dat = <double *>p_ndr.data             # <<<<<<<<<<<<<<
 *         # Test the compatibility of sizes .......
 *         if p_ndr.size == 0:
 */
  __pyx_v_p_dat = ((double *)__pyx_v_p_ndr->data);

  /* "_loess.pyx":862
 *         p_dat = <double *>p_ndr.data
 *         # Test the compatibility of sizes .......
 *         if p_ndr.size == 0:             # <<<<<<<<<<<<<<
 *             raise ValueError("Can't predict without input data !")
 *         (m, notOK) = divmod(len(p_ndr), self.inputs.npar)
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_p_ndr), __pyx_n_s_size); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 862; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_int_0, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 862; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 862; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_1) {

    /* "_loess.pyx":863
 *         # Test the compatibility of sizes .......
 *         if p_ndr.size == 0:
 *             raise ValueError("Can't predict without input data !")             # <<<<<<<<<<<<<<
 *         (m, notOK) = divmod(len(p_ndr), self.inputs.npar)
 *         if notOK:
 */
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 863; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 863; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":864
 *         if p_ndr.size == 0:
 *             raise ValueError("Can't predict without input data !")
 *         (m, notOK) = divmod(len(p_ndr), self.inputs.npar)             # <<<<<<<<<<<<<<
 *         if notOK:
 *             raise ValueError(
 */
  __pyx_t_7 = PyObject_Length(((PyObject *)__pyx_v_p_ndr)); if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->inputs->npar); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = PyNumber_Divmod(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
    PyObject* sequence = __pyx_t_6;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_t_5);
    #else
    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    #endif
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = Py_TYPE(__pyx_t_4)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L6_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_2);
    index = 1; __pyx_t_5 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_5)) goto __pyx_L6_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_5);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_4), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_8 = NULL;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L7_unpacking_done;
    __pyx_L6_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_L7_unpacking_done:;
  }
  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_m = __pyx_t_9;
  __pyx_v_notOK = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "_loess.pyx":865
 *             raise ValueError("Can't predict without input data !")
 *         (m, notOK) = divmod(len(p_ndr), self.inputs.npar)
 *         if notOK:             # <<<<<<<<<<<<<<
 *             raise ValueError(
 *                   "Incompatible data size: there should be as many rows as parameters")
 */
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_notOK); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_1) {

    /* "_loess.pyx":866
 *         (m, notOK) = divmod(len(p_ndr), self.inputs.npar)
 *         if notOK:
 *             raise ValueError(             # <<<<<<<<<<<<<<
 *                   "Incompatible data size: there should be as many rows as parameters")
 *         #.....
 */
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":869
 *                   "Incompatible data size: there should be as many rows as parameters")
 *         #.....
 *         c_loess.c_predict(p_dat, m, &self._base, &_prediction, stderror)             # <<<<<<<<<<<<<<
 *         if self._base.status.err_status:
 *             raise ValueError(self._base.status.err_msg)
 */
  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_stderror); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  predict(__pyx_v_p_dat, __pyx_v_m, (&__pyx_v_self->_base), (&__pyx_v__prediction), __pyx_t_9);

  /* "_loess.pyx":870
 *         #.....
 *         c_loess.c_predict(p_dat, m, &self._base, &_prediction, stderror)
 *         if self._base.status.err_status:             # <<<<<<<<<<<<<<
 *             raise ValueError(self._base.status.err_msg)
 *         self.predicted = loess_predicted()
 */
  __pyx_t_1 = (__pyx_v_self->_base.status.err_status != 0);
  if (__pyx_t_1) {

    /* "_loess.pyx":871
 *         c_loess.c_predict(p_dat, m, &self._base, &_prediction, stderror)
 *         if self._base.status.err_status:
 *             raise ValueError(self._base.status.err_msg)             # <<<<<<<<<<<<<<
 *         self.predicted = loess_predicted()
 *         self.predicted._base = _prediction
 */
    __pyx_t_6 = __Pyx_PyBytes_FromString(__pyx_v_self->_base.status.err_msg); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":872
 *         if self._base.status.err_status:
 *             raise ValueError(self._base.status.err_msg)
 *         self.predicted = loess_predicted()             # <<<<<<<<<<<<<<
 *         self.predicted._base = _prediction
 *         self.predicted.nest = m
 */
  __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6_loess_loess_predicted)), __pyx_empty_tuple, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 872; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_6);
  __Pyx_GOTREF(__pyx_v_self->predicted);
  __Pyx_DECREF(((PyObject *)__pyx_v_self->predicted));
  __pyx_v_self->predicted = ((struct __pyx_obj_6_loess_loess_predicted *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "_loess.pyx":873
 *             raise ValueError(self._base.status.err_msg)
 *         self.predicted = loess_predicted()
 *         self.predicted._base = _prediction             # <<<<<<<<<<<<<<
 *         self.predicted.nest = m
 * #        self.predicted.setup(_prediction, m)
 */
  __pyx_v_self->predicted->_base = __pyx_v__prediction;

  /* "_loess.pyx":874
 *         self.predicted = loess_predicted()
 *         self.predicted._base = _prediction
 *         self.predicted.nest = m             # <<<<<<<<<<<<<<
 * #        self.predicted.setup(_prediction, m)
 *         return self.predicted
 */
  __pyx_v_self->predicted->nest = __pyx_v_m;

  /* "_loess.pyx":876
 *         self.predicted.nest = m
 * #        self.predicted.setup(_prediction, m)
 *         return self.predicted             # <<<<<<<<<<<<<<
 *     #.........
 *     def __dealloc__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->predicted));
  __pyx_r = ((PyObject *)__pyx_v_self->predicted);
  goto __pyx_L0;

  /* "_loess.pyx":821
 *             print "Residual Scale Estimate        : %.4f" % self.outputs.s
 *     #......................................................
 *     def predict(self, newdata, stderror=False):             # <<<<<<<<<<<<<<
 *         """Computes loess estimates at the given new data points newdata. Returns
 * a loess_predicted object, whose attributes are described below.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("_loess.loess.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_p_ndr);
  __Pyx_XDECREF(__pyx_v_notOK);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":878
 *         return self.predicted
 *     #.........
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         c_loess.loess_free_mem(&self._base)
 *     #......................................................
 */

/* Python wrapper */
static void __pyx_pw_6_loess_5loess_11__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_6_loess_5loess_11__dealloc__(PyObject *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
  __pyx_pf_6_loess_5loess_10__dealloc__(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

static void __pyx_pf_6_loess_5loess_10__dealloc__(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__", 0);

  /* "_loess.pyx":879
 *     #.........
 *     def __dealloc__(self):
 *         c_loess.loess_free_mem(&self._base)             # <<<<<<<<<<<<<<
 *     #......................................................
 * 
 */
  loess_free_mem((&__pyx_v_self->_base));

  /* "_loess.pyx":878
 *         return self.predicted
 *     #.........
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         c_loess.loess_free_mem(&self._base)
 *     #......................................................
 */

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

/* "_loess.pyx":751
 *     """
 *     cdef c_loess.c_loess _base
 *     cdef readonly loess_inputs inputs             # <<<<<<<<<<<<<<
 *     cdef readonly loess_model model
 *     cdef readonly loess_control control
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_6inputs_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5loess_6inputs_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_6inputs___get__(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_6inputs___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->inputs));
  __pyx_r = ((PyObject *)__pyx_v_self->inputs);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":752
 *     cdef c_loess.c_loess _base
 *     cdef readonly loess_inputs inputs
 *     cdef readonly loess_model model             # <<<<<<<<<<<<<<
 *     cdef readonly loess_control control
 *     cdef readonly loess_kd_tree kd_tree
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_5model_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5loess_5model_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_5model___get__(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_5model___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->model));
  __pyx_r = ((PyObject *)__pyx_v_self->model);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":753
 *     cdef readonly loess_inputs inputs
 *     cdef readonly loess_model model
 *     cdef readonly loess_control control             # <<<<<<<<<<<<<<
 *     cdef readonly loess_kd_tree kd_tree
 *     cdef readonly loess_outputs outputs
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_7control_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5loess_7control_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_7control___get__(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_7control___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->control));
  __pyx_r = ((PyObject *)__pyx_v_self->control);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":754
 *     cdef readonly loess_model model
 *     cdef readonly loess_control control
 *     cdef readonly loess_kd_tree kd_tree             # <<<<<<<<<<<<<<
 *     cdef readonly loess_outputs outputs
 *     cdef readonly loess_predicted predicted
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_7kd_tree_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5loess_7kd_tree_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_7kd_tree___get__(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_7kd_tree___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->kd_tree));
  __pyx_r = ((PyObject *)__pyx_v_self->kd_tree);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":755
 *     cdef readonly loess_control control
 *     cdef readonly loess_kd_tree kd_tree
 *     cdef readonly loess_outputs outputs             # <<<<<<<<<<<<<<
 *     cdef readonly loess_predicted predicted
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_7outputs_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5loess_7outputs_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_7outputs___get__(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_7outputs___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->outputs));
  __pyx_r = ((PyObject *)__pyx_v_self->outputs);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":756
 *     cdef readonly loess_kd_tree kd_tree
 *     cdef readonly loess_outputs outputs
 *     cdef readonly loess_predicted predicted             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self, object x, object y, object weights=None, **options):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5loess_9predicted_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5loess_9predicted_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5loess_9predicted___get__(((struct __pyx_obj_6_loess_loess *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5loess_9predicted___get__(struct __pyx_obj_6_loess_loess *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_self->predicted));
  __pyx_r = ((PyObject *)__pyx_v_self->predicted);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":889
 *     cdef readonly double dfn, dfd, F_value, Pr_F
 *     #
 *     def __init__(self, loess_one, loess_two):             # <<<<<<<<<<<<<<
 *         cdef double one_d1, one_d2, one_s, two_d1, two_d2, two_s, rssdiff,\
 *                     d1diff, tmp, df1, df2
 */

/* Python wrapper */
static int __pyx_pw_6_loess_5anova_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6_loess_5anova_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_loess_one = 0;
  PyObject *__pyx_v_loess_two = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_loess_one,&__pyx_n_s_loess_two,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_loess_one)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_loess_two)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_loess_one = values[0];
    __pyx_v_loess_two = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("_loess.anova.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6_loess_5anova___init__(((struct __pyx_obj_6_loess_anova *)__pyx_v_self), __pyx_v_loess_one, __pyx_v_loess_two);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6_loess_5anova___init__(struct __pyx_obj_6_loess_anova *__pyx_v_self, PyObject *__pyx_v_loess_one, PyObject *__pyx_v_loess_two) {
  double __pyx_v_one_d1;
  double __pyx_v_one_d2;
  double __pyx_v_one_s;
  double __pyx_v_two_d1;
  double __pyx_v_two_d2;
  double __pyx_v_two_s;
  double __pyx_v_rssdiff;
  double __pyx_v_d1diff;
  double __pyx_v_tmp;
  double __pyx_v_df1;
  double __pyx_v_df2;
  PyObject *__pyx_v_out_one = NULL;
  PyObject *__pyx_v_out_two = NULL;
  double __pyx_v_F_value;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  double __pyx_t_6;
  double __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__", 0);

  /* "_loess.pyx":893
 *                     d1diff, tmp, df1, df2
 *         #
 *         if not isinstance(loess_one, loess) or not isinstance(loess_two, loess):             # <<<<<<<<<<<<<<
 *             raise ValueError("Arguments should be valid loess objects!"\
 *                              "got '%s' instead" % type(loess_one))
 */
  __pyx_t_2 = __Pyx_TypeCheck(__pyx_v_loess_one, ((PyObject*)__pyx_ptype_6_loess_loess)); 
  __pyx_t_3 = ((!(__pyx_t_2 != 0)) != 0);
  if (!__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_loess_two, ((PyObject*)__pyx_ptype_6_loess_loess)); 
  __pyx_t_2 = ((!(__pyx_t_3 != 0)) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {

    /* "_loess.pyx":895
 *         if not isinstance(loess_one, loess) or not isinstance(loess_two, loess):
 *             raise ValueError("Arguments should be valid loess objects!"\
 *                              "got '%s' instead" % type(loess_one))             # <<<<<<<<<<<<<<
 *         #
 *         out_one = loess_one.outputs
 */
    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Arguments_should_be_valid_loess, ((PyObject *)Py_TYPE(__pyx_v_loess_one))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);

    /* "_loess.pyx":894
 *         #
 *         if not isinstance(loess_one, loess) or not isinstance(loess_two, loess):
 *             raise ValueError("Arguments should be valid loess objects!"\             # <<<<<<<<<<<<<<
 *                              "got '%s' instead" % type(loess_one))
 *         #
 */
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "_loess.pyx":897
 *                              "got '%s' instead" % type(loess_one))
 *         #
 *         out_one = loess_one.outputs             # <<<<<<<<<<<<<<
 *         out_two = loess_two.outputs
 *         #
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_loess_one, __pyx_n_s_outputs); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_v_out_one = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "_loess.pyx":898
 *         #
 *         out_one = loess_one.outputs
 *         out_two = loess_two.outputs             # <<<<<<<<<<<<<<
 *         #
 *         one_d1 = out_one.one_delta
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_loess_two, __pyx_n_s_outputs); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_v_out_two = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "_loess.pyx":900
 *         out_two = loess_two.outputs
 *         #
 *         one_d1 = out_one.one_delta             # <<<<<<<<<<<<<<
 *         one_d2 = out_one.two_delta
 *         one_s = out_one.s
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_one, __pyx_n_s_one_delta); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_one_d1 = __pyx_t_6;

  /* "_loess.pyx":901
 *         #
 *         one_d1 = out_one.one_delta
 *         one_d2 = out_one.two_delta             # <<<<<<<<<<<<<<
 *         one_s = out_one.s
 *         #
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_one, __pyx_n_s_two_delta); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_one_d2 = __pyx_t_6;

  /* "_loess.pyx":902
 *         one_d1 = out_one.one_delta
 *         one_d2 = out_one.two_delta
 *         one_s = out_one.s             # <<<<<<<<<<<<<<
 *         #
 *         two_d1 = out_two.one_delta
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_one, __pyx_n_s_s); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 902; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 902; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_one_s = __pyx_t_6;

  /* "_loess.pyx":904
 *         one_s = out_one.s
 *         #
 *         two_d1 = out_two.one_delta             # <<<<<<<<<<<<<<
 *         two_d2 = out_two.two_delta
 *         two_s = out_two.s
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_two, __pyx_n_s_one_delta); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_two_d1 = __pyx_t_6;

  /* "_loess.pyx":905
 *         #
 *         two_d1 = out_two.one_delta
 *         two_d2 = out_two.two_delta             # <<<<<<<<<<<<<<
 *         two_s = out_two.s
 *         #
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_two, __pyx_n_s_two_delta); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 905; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 905; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_two_d2 = __pyx_t_6;

  /* "_loess.pyx":906
 *         two_d1 = out_two.one_delta
 *         two_d2 = out_two.two_delta
 *         two_s = out_two.s             # <<<<<<<<<<<<<<
 *         #
 *         rssdiff = abs(one_s * one_s * one_d1 - two_s * two_s * two_d1)
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_two, __pyx_n_s_s); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 906; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 906; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_two_s = __pyx_t_6;

  /* "_loess.pyx":908
 *         two_s = out_two.s
 *         #
 *         rssdiff = abs(one_s * one_s * one_d1 - two_s * two_s * two_d1)             # <<<<<<<<<<<<<<
 *         d1diff = abs(one_d1 - two_d1)
 *         self.dfn = d1diff * d1diff / abs(one_d2 - two_d2)
 */
  __pyx_v_rssdiff = fabs((((__pyx_v_one_s * __pyx_v_one_s) * __pyx_v_one_d1) - ((__pyx_v_two_s * __pyx_v_two_s) * __pyx_v_two_d1)));

  /* "_loess.pyx":909
 *         #
 *         rssdiff = abs(one_s * one_s * one_d1 - two_s * two_s * two_d1)
 *         d1diff = abs(one_d1 - two_d1)             # <<<<<<<<<<<<<<
 *         self.dfn = d1diff * d1diff / abs(one_d2 - two_d2)
 *         df1 = self.dfn
 */
  __pyx_v_d1diff = fabs((__pyx_v_one_d1 - __pyx_v_two_d1));

  /* "_loess.pyx":910
 *         rssdiff = abs(one_s * one_s * one_d1 - two_s * two_s * two_d1)
 *         d1diff = abs(one_d1 - two_d1)
 *         self.dfn = d1diff * d1diff / abs(one_d2 - two_d2)             # <<<<<<<<<<<<<<
 *         df1 = self.dfn
 *         #
 */
  __pyx_t_6 = (__pyx_v_d1diff * __pyx_v_d1diff);
  __pyx_t_7 = fabs((__pyx_v_one_d2 - __pyx_v_two_d2));
  if (unlikely(__pyx_t_7 == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 910; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_v_self->dfn = (__pyx_t_6 / __pyx_t_7);

  /* "_loess.pyx":911
 *         d1diff = abs(one_d1 - two_d1)
 *         self.dfn = d1diff * d1diff / abs(one_d2 - two_d2)
 *         df1 = self.dfn             # <<<<<<<<<<<<<<
 *         #
 *         if out_one.enp > out_two.enp:
 */
  __pyx_t_7 = __pyx_v_self->dfn;
  __pyx_v_df1 = __pyx_t_7;

  /* "_loess.pyx":913
 *         df1 = self.dfn
 *         #
 *         if out_one.enp > out_two.enp:             # <<<<<<<<<<<<<<
 *             self.dfd = one_d1 * one_d1 / one_d2
 *             tmp = one_s
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_one, __pyx_n_s_enp); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 913; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_two, __pyx_n_s_enp); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 913; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_8 = PyObject_RichCompare(__pyx_t_4, __pyx_t_5, Py_GT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 913; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 913; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  if (__pyx_t_1) {

    /* "_loess.pyx":914
 *         #
 *         if out_one.enp > out_two.enp:
 *             self.dfd = one_d1 * one_d1 / one_d2             # <<<<<<<<<<<<<<
 *             tmp = one_s
 *         else:
 */
    __pyx_t_7 = (__pyx_v_one_d1 * __pyx_v_one_d1);
    if (unlikely(__pyx_v_one_d2 == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 914; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_v_self->dfd = (__pyx_t_7 / __pyx_v_one_d2);

    /* "_loess.pyx":915
 *         if out_one.enp > out_two.enp:
 *             self.dfd = one_d1 * one_d1 / one_d2
 *             tmp = one_s             # <<<<<<<<<<<<<<
 *         else:
 *             self.dfd = two_d1 * two_d1 / two_d2
 */
    __pyx_v_tmp = __pyx_v_one_s;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "_loess.pyx":917
 *             tmp = one_s
 *         else:
 *             self.dfd = two_d1 * two_d1 / two_d2             # <<<<<<<<<<<<<<
 *             tmp = two_s
 *         df2 = self.dfd
 */
    __pyx_t_7 = (__pyx_v_two_d1 * __pyx_v_two_d1);
    if (unlikely(__pyx_v_two_d2 == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_v_self->dfd = (__pyx_t_7 / __pyx_v_two_d2);

    /* "_loess.pyx":918
 *         else:
 *             self.dfd = two_d1 * two_d1 / two_d2
 *             tmp = two_s             # <<<<<<<<<<<<<<
 *         df2 = self.dfd
 *         F_value = (rssdiff / d1diff) / (tmp * tmp)
 */
    __pyx_v_tmp = __pyx_v_two_s;
  }
  __pyx_L6:;

  /* "_loess.pyx":919
 *             self.dfd = two_d1 * two_d1 / two_d2
 *             tmp = two_s
 *         df2 = self.dfd             # <<<<<<<<<<<<<<
 *         F_value = (rssdiff / d1diff) / (tmp * tmp)
 * 
 */
  __pyx_t_7 = __pyx_v_self->dfd;
  __pyx_v_df2 = __pyx_t_7;

  /* "_loess.pyx":920
 *             tmp = two_s
 *         df2 = self.dfd
 *         F_value = (rssdiff / d1diff) / (tmp * tmp)             # <<<<<<<<<<<<<<
 * 
 *         self.Pr_F = 1. - c_loess.ibeta(F_value*df1/(df2+F_value*df1), df1/2, df2/2)
 */
  if (unlikely(__pyx_v_d1diff == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_t_7 = (__pyx_v_rssdiff / __pyx_v_d1diff);
  __pyx_t_6 = (__pyx_v_tmp * __pyx_v_tmp);
  if (unlikely(__pyx_t_6 == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_v_F_value = (__pyx_t_7 / __pyx_t_6);

  /* "_loess.pyx":922
 *         F_value = (rssdiff / d1diff) / (tmp * tmp)
 * 
 *         self.Pr_F = 1. - c_loess.ibeta(F_value*df1/(df2+F_value*df1), df1/2, df2/2)             # <<<<<<<<<<<<<<
 *         self.F_value = F_value
 * 
 */
  __pyx_t_6 = (__pyx_v_F_value * __pyx_v_df1);
  __pyx_t_7 = (__pyx_v_df2 + (__pyx_v_F_value * __pyx_v_df1));
  if (unlikely(__pyx_t_7 == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_v_self->Pr_F = (1. - ibeta((__pyx_t_6 / __pyx_t_7), (__pyx_v_df1 / 2.0), (__pyx_v_df2 / 2.0)));

  /* "_loess.pyx":923
 * 
 *         self.Pr_F = 1. - c_loess.ibeta(F_value*df1/(df2+F_value*df1), df1/2, df2/2)
 *         self.F_value = F_value             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_v_self->F_value = __pyx_v_F_value;

  /* "_loess.pyx":889
 *     cdef readonly double dfn, dfd, F_value, Pr_F
 *     #
 *     def __init__(self, loess_one, loess_two):             # <<<<<<<<<<<<<<
 *         cdef double one_d1, one_d2, one_s, two_d1, two_d2, two_s, rssdiff,\
 *                     d1diff, tmp, df1, df2
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("_loess.anova.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out_one);
  __Pyx_XDECREF(__pyx_v_out_two);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "_loess.pyx":887
 * #####---------------------------------------------------------------------------
 * cdef class anova:
 *     cdef readonly double dfn, dfd, F_value, Pr_F             # <<<<<<<<<<<<<<
 *     #
 *     def __init__(self, loess_one, loess_two):
 */

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5anova_3dfn_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5anova_3dfn_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5anova_3dfn___get__(((struct __pyx_obj_6_loess_anova *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5anova_3dfn___get__(struct __pyx_obj_6_loess_anova *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->dfn); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.anova.dfn.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5anova_3dfd_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5anova_3dfd_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5anova_3dfd___get__(((struct __pyx_obj_6_loess_anova *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5anova_3dfd___get__(struct __pyx_obj_6_loess_anova *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->dfd); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.anova.dfd.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5anova_7F_value_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5anova_7F_value_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5anova_7F_value___get__(((struct __pyx_obj_6_loess_anova *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5anova_7F_value___get__(struct __pyx_obj_6_loess_anova *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->F_value); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.anova.F_value.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6_loess_5anova_4Pr_F_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6_loess_5anova_4Pr_F_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6_loess_5anova_4Pr_F___get__(((struct __pyx_obj_6_loess_anova *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6_loess_5anova_4Pr_F___get__(struct __pyx_obj_6_loess_anova *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->Pr_F); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("_loess.anova.Pr_F.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_tp_new_6_loess_loess_inputs(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6_loess_loess_inputs *p;
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  p = ((struct __pyx_obj_6_loess_loess_inputs *)o);
  p->w_ndr = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  p->x = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  p->y = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  p->masked = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  p->x_eff = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  p->y_eff = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_6_loess_loess_inputs(PyObject *o) {
  struct __pyx_obj_6_loess_loess_inputs *p = (struct __pyx_obj_6_loess_loess_inputs *)o;
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->w_ndr);
  Py_CLEAR(p->x);
  Py_CLEAR(p->y);
  Py_CLEAR(p->masked);
  Py_CLEAR(p->x_eff);
  Py_CLEAR(p->y_eff);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_6_loess_loess_inputs(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6_loess_loess_inputs *p = (struct __pyx_obj_6_loess_loess_inputs *)o;
  if (p->w_ndr) {
    e = (*v)(((PyObject*)p->w_ndr), a); if (e) return e;
  }
  if (p->x) {
    e = (*v)(((PyObject*)p->x), a); if (e) return e;
  }
  if (p->y) {
    e = (*v)(((PyObject*)p->y), a); if (e) return e;
  }
  if (p->masked) {
    e = (*v)(((PyObject*)p->masked), a); if (e) return e;
  }
  if (p->x_eff) {
    e = (*v)(((PyObject*)p->x_eff), a); if (e) return e;
  }
  if (p->y_eff) {
    e = (*v)(((PyObject*)p->y_eff), a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6_loess_loess_inputs(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6_loess_loess_inputs *p = (struct __pyx_obj_6_loess_loess_inputs *)o;
  tmp = ((PyObject*)p->w_ndr);
  p->w_ndr = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->x);
  p->x = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->y);
  p->y = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->masked);
  p->masked = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->x_eff);
  p->x_eff = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->y_eff);
  p->y_eff = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6_loess_12loess_inputs_weights(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_12loess_inputs_7weights_1__get__(o);
}

static int __pyx_setprop_6_loess_12loess_inputs_weights(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_12loess_inputs_7weights_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_12loess_inputs_x(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_12loess_inputs_1x_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_12loess_inputs_y(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_12loess_inputs_1y_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_12loess_inputs_masked(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_12loess_inputs_6masked_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_12loess_inputs_x_eff(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_12loess_inputs_5x_eff_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_12loess_inputs_y_eff(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_12loess_inputs_5y_eff_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_12loess_inputs_nobs(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_12loess_inputs_4nobs_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_12loess_inputs_npar(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_12loess_inputs_4npar_1__get__(o);
}

static PyMethodDef __pyx_methods_6_loess_loess_inputs[] = {
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6_loess_loess_inputs[] = {
  {(char *)"weights", __pyx_getprop_6_loess_12loess_inputs_weights, __pyx_setprop_6_loess_12loess_inputs_weights, __pyx_k_A_n_ndarray_of_weights_to_be_giv, 0},
  {(char *)"x", __pyx_getprop_6_loess_12loess_inputs_x, 0, 0, 0},
  {(char *)"y", __pyx_getprop_6_loess_12loess_inputs_y, 0, 0, 0},
  {(char *)"masked", __pyx_getprop_6_loess_12loess_inputs_masked, 0, 0, 0},
  {(char *)"x_eff", __pyx_getprop_6_loess_12loess_inputs_x_eff, 0, 0, 0},
  {(char *)"y_eff", __pyx_getprop_6_loess_12loess_inputs_y_eff, 0, 0, 0},
  {(char *)"nobs", __pyx_getprop_6_loess_12loess_inputs_nobs, 0, 0, 0},
  {(char *)"npar", __pyx_getprop_6_loess_12loess_inputs_npar, 0, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyTypeObject __pyx_type_6_loess_loess_inputs = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.loess_inputs", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_loess_inputs), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_loess_inputs, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  "Loess inputs\n    \n:IVariables:\n    x : ndarray\n        A (n,p) ndarray of independent variables, with n the number of observations\n        and p the number of variables.\n    y : ndarray\n        A (n,) ndarray of observations\n    nobs : integer\n        Number of observations: nobs=n.\n    npar : integer\n        Number of independent variables: npar=p.\n    weights : ndarray\n        A (n,) ndarray of weights to be given to individual observations in the \n        sum of squared residuals that forms the local fitting criterion. If not\n        None, the weights should be non negative. If the different observations\n        have non-equal variances, the weights should be inversely proportional \n        to the variances.\n        By default, an unweighted fit is carried out (all the weights are one).\n    ", /*tp_doc*/
  __pyx_tp_traverse_6_loess_loess_inputs, /*tp_traverse*/
  __pyx_tp_clear_6_loess_loess_inputs, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6_loess_loess_inputs, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6_loess_loess_inputs, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pw_6_loess_12loess_inputs_1__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_loess_inputs, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};

static PyObject *__pyx_tp_new_6_loess_loess_control(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  return o;
}

static void __pyx_tp_dealloc_6_loess_loess_control(PyObject *o) {
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  (*Py_TYPE(o)->tp_free)(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_control_surface(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_control_7surface_1__get__(o);
}

static int __pyx_setprop_6_loess_13loess_control_surface(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_13loess_control_7surface_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_13loess_control_statistics(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_control_10statistics_1__get__(o);
}

static int __pyx_setprop_6_loess_13loess_control_statistics(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_13loess_control_10statistics_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_13loess_control_trace_hat(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_control_9trace_hat_1__get__(o);
}

static int __pyx_setprop_6_loess_13loess_control_trace_hat(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_13loess_control_9trace_hat_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_13loess_control_iterations(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_control_10iterations_1__get__(o);
}

static int __pyx_setprop_6_loess_13loess_control_iterations(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_13loess_control_10iterations_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_13loess_control_cell(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_control_4cell_1__get__(o);
}

static int __pyx_setprop_6_loess_13loess_control_cell(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_13loess_control_4cell_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyMethodDef __pyx_methods_6_loess_loess_control[] = {
  {"update", (PyCFunction)__pyx_pw_6_loess_13loess_control_1update, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6_loess_13loess_control_update},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6_loess_loess_control[] = {
  {(char *)"surface", __pyx_getprop_6_loess_13loess_control_surface, __pyx_setprop_6_loess_13loess_control_surface, __pyx_k_surface_string_interpolate_Dete, 0},
  {(char *)"statistics", __pyx_getprop_6_loess_13loess_control_statistics, __pyx_setprop_6_loess_13loess_control_statistics, __pyx_k_statistics_string_approximate_D, 0},
  {(char *)"trace_hat", __pyx_getprop_6_loess_13loess_control_trace_hat, __pyx_setprop_6_loess_13loess_control_trace_hat, __pyx_k_trace_hat_string_wait_to_decide, 0},
  {(char *)"iterations", __pyx_getprop_6_loess_13loess_control_iterations, __pyx_setprop_6_loess_13loess_control_iterations, __pyx_k_iterations_integer_Number_of_it, 0},
  {(char *)"cell", __pyx_getprop_6_loess_13loess_control_cell, __pyx_setprop_6_loess_13loess_control_cell, __pyx_k_cell_integer_Maximum_cell_size, 0},
  {0, 0, 0, 0, 0}
};

static PyTypeObject __pyx_type_6_loess_loess_control = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.loess_control", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_loess_control), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_loess_control, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  __pyx_pw_6_loess_13loess_control_3__str__, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  "Loess control parameters.\n    \n:IVariables:\n    surface : string [\"interpolate\"]\n        Determines whether the fitted surface is computed directly at all points\n        (\"direct\") or whether an interpolation method is used (\"interpolate\").\n        The default (\"interpolate\") is what most users should use unless special \n        circumstances warrant.\n    statistics : string [\"approximate\"]\n        Determines whether the statistical quantities are computed exactly \n        (\"exact\") or approximately (\"approximate\"). \"exact\" should only be used \n        for testing the approximation in statistical development and is not meant \n        for routine usage because computation time can be horrendous.\n    trace_hat : string [\"wait.to.decide\"]\n        Determines how the trace of the hat matrix should be computed. The hat\n        matrix is used in the computation of the statistical quantities. \n        If \"exact\", an exact computation is done; this could be slow when the\n        number of observations n becomes large. If \"wait.to.decide\" is selected, \n        then a default is \"exact\" for n < 500 and \"approximate\" otherwise. \n        This option is only useful when the fitted surface is interpolated. If  \n        surface is \"exact\", an exact computation is always done for the trace. \n        Setting trace_hat to \"approximate\" for large dataset will substantially \n        reduce the computation time.\n    iterations : integer\n        Number of iterations of the robust fitting method. If the family is \n        \"gaussian\", the number of iterations is set to 0.\n    cell : integer\n        Maximum cell size of the kd-tree. Suppose k = floor(n*cell*span),\n        where n is the number of observations, and span the smoothing parameter.\n        Then, a cell is further divided if the number of observations within it \n        is greater than or equal to k. This option is only used if the surface \n        is interpolated.\n    \n    ", /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6_loess_loess_control, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6_loess_loess_control, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_loess_control, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};

static PyObject *__pyx_tp_new_6_loess_loess_kd_tree(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  return o;
}

static void __pyx_tp_dealloc_6_loess_loess_kd_tree(PyObject *o) {
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  (*Py_TYPE(o)->tp_free)(o);
}

static PyTypeObject __pyx_type_6_loess_loess_kd_tree = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.loess_kd_tree", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_loess_kd_tree), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_loess_kd_tree, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  0, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_loess_kd_tree, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};
static struct __pyx_vtabstruct_6_loess_loess_model __pyx_vtable_6_loess_loess_model;

static PyObject *__pyx_tp_new_6_loess_loess_model(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6_loess_loess_model *p;
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  p = ((struct __pyx_obj_6_loess_loess_model *)o);
  p->__pyx_vtab = __pyx_vtabptr_6_loess_loess_model;
  return o;
}

static void __pyx_tp_dealloc_6_loess_loess_model(PyObject *o) {
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  (*Py_TYPE(o)->tp_free)(o);
}

static PyObject *__pyx_getprop_6_loess_11loess_model_normalize(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_11loess_model_9normalize_1__get__(o);
}

static int __pyx_setprop_6_loess_11loess_model_normalize(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_11loess_model_9normalize_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_11loess_model_span(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_11loess_model_4span_1__get__(o);
}

static int __pyx_setprop_6_loess_11loess_model_span(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_11loess_model_4span_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_11loess_model_degree(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_11loess_model_6degree_1__get__(o);
}

static int __pyx_setprop_6_loess_11loess_model_degree(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_11loess_model_6degree_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_11loess_model_family(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_11loess_model_6family_1__get__(o);
}

static int __pyx_setprop_6_loess_11loess_model_family(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_11loess_model_6family_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_11loess_model_parametric_flags(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_11loess_model_16parametric_flags_1__get__(o);
}

static int __pyx_setprop_6_loess_11loess_model_parametric_flags(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_11loess_model_16parametric_flags_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_6_loess_11loess_model_drop_square_flags(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_11loess_model_17drop_square_flags_1__get__(o);
}

static int __pyx_setprop_6_loess_11loess_model_drop_square_flags(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6_loess_11loess_model_17drop_square_flags_3__set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyMethodDef __pyx_methods_6_loess_loess_model[] = {
  {"update", (PyCFunction)__pyx_pw_6_loess_11loess_model_1update, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6_loess_loess_model[] = {
  {(char *)"normalize", __pyx_getprop_6_loess_11loess_model_normalize, __pyx_setprop_6_loess_11loess_model_normalize, 0, 0},
  {(char *)"span", __pyx_getprop_6_loess_11loess_model_span, __pyx_setprop_6_loess_11loess_model_span, 0, 0},
  {(char *)"degree", __pyx_getprop_6_loess_11loess_model_degree, __pyx_setprop_6_loess_11loess_model_degree, 0, 0},
  {(char *)"family", __pyx_getprop_6_loess_11loess_model_family, __pyx_setprop_6_loess_11loess_model_family, 0, 0},
  {(char *)"parametric_flags", __pyx_getprop_6_loess_11loess_model_parametric_flags, __pyx_setprop_6_loess_11loess_model_parametric_flags, 0, 0},
  {(char *)"drop_square_flags", __pyx_getprop_6_loess_11loess_model_drop_square_flags, __pyx_setprop_6_loess_11loess_model_drop_square_flags, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyTypeObject __pyx_type_6_loess_loess_model = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.loess_model", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_loess_model), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_loess_model, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  __pyx_pw_6_loess_11loess_model_3__repr__, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  __pyx_pw_6_loess_11loess_model_5__str__, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  "loess_model contains parameters required for a loess fit.\n    \n:IVariables:\n    normalize : boolean [True]\n        Determines whether the independent variables should be normalized.  \n        If True, the normalization is performed by setting the 10% trimmed \n        standard deviation to one. If False, no normalization is carried out. \n        This option is only useful for more than one variable. For spatial\n        coordinates predictors or variables with a common scale, it should be \n        set to False.\n    span : float [0.75]\n        Smoothing factor, as a fraction of the number of points to take into\n        account. \n    degree : integer [2]\n        Overall degree of locally-fitted polynomial. 1 is locally-linear \n        fitting and 2 is locally-quadratic fitting.  Degree should be 2 at most.\n    family : string [\"gaussian\"]\n        Determines the assumed distribution of the errors. The values are \n        \"gaussian\" or \"symmetric\". If \"gaussian\" is selected, the fit is \n        performed with least-squares. If \"symmetric\" is selected, the fit\n        is performed robustly by redescending M-estimators.\n    parametric_flags : sequence [ [False]*p ]\n        Indicates which independent variables should be conditionally-parametric\n        (if there are two or more independent variables). The argument should be\n        a sequence of booleans, with the same size as the number of independent \n        variables, specified in the order of the predictor group ordered in x. \n        Note: elements of the sequence cannot be modified individually: the whole\n        sequence must be given.\n    drop_square : sequence [ [False]* p]\n        When there are two or more independent variables and when a 2nd order\n        polynomial is used, \"drop_square_flags\" specifies those numeric predictors \n        whose squares should be dropped from the set of fitting variables. \n        The method of specification is the same as for parametric.  \n        Note: elements of the sequence cannot be modified individually: the whole\n        sequence must be given.\n\n    ", /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6_loess_loess_model, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6_loess_loess_model, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_loess_model, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};
static struct __pyx_vtabstruct_6_loess_loess_outputs __pyx_vtable_6_loess_loess_outputs;

static PyObject *__pyx_tp_new_6_loess_loess_outputs(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6_loess_loess_outputs *p;
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  p = ((struct __pyx_obj_6_loess_loess_outputs *)o);
  p->__pyx_vtab = __pyx_vtabptr_6_loess_loess_outputs;
  return o;
}

static void __pyx_tp_dealloc_6_loess_loess_outputs(PyObject *o) {
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  (*Py_TYPE(o)->tp_free)(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_fitted_values(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_13fitted_values_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_fitted_residuals(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_16fitted_residuals_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_pseudovalues(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_12pseudovalues_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_diagonal(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_8diagonal_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_robust(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_6robust_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_divisor(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_7divisor_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_enp(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_3enp_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_s(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_1s_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_one_delta(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_9one_delta_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_two_delta(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_9two_delta_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_trace_hat(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_9trace_hat_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_13loess_outputs_activated(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_13loess_outputs_9activated_1__get__(o);
}

static PyMethodDef __pyx_methods_6_loess_loess_outputs[] = {
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6_loess_loess_outputs[] = {
  {(char *)"fitted_values", __pyx_getprop_6_loess_13loess_outputs_fitted_values, 0, 0, 0},
  {(char *)"fitted_residuals", __pyx_getprop_6_loess_13loess_outputs_fitted_residuals, 0, 0, 0},
  {(char *)"pseudovalues", __pyx_getprop_6_loess_13loess_outputs_pseudovalues, 0, 0, 0},
  {(char *)"diagonal", __pyx_getprop_6_loess_13loess_outputs_diagonal, 0, 0, 0},
  {(char *)"robust", __pyx_getprop_6_loess_13loess_outputs_robust, 0, 0, 0},
  {(char *)"divisor", __pyx_getprop_6_loess_13loess_outputs_divisor, 0, 0, 0},
  {(char *)"enp", __pyx_getprop_6_loess_13loess_outputs_enp, 0, 0, 0},
  {(char *)"s", __pyx_getprop_6_loess_13loess_outputs_s, 0, 0, 0},
  {(char *)"one_delta", __pyx_getprop_6_loess_13loess_outputs_one_delta, 0, 0, 0},
  {(char *)"two_delta", __pyx_getprop_6_loess_13loess_outputs_two_delta, 0, 0, 0},
  {(char *)"trace_hat", __pyx_getprop_6_loess_13loess_outputs_trace_hat, 0, 0, 0},
  {(char *)"activated", __pyx_getprop_6_loess_13loess_outputs_activated, 0, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyTypeObject __pyx_type_6_loess_loess_outputs = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.loess_outputs", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_loess_outputs), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_loess_outputs, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  __pyx_pw_6_loess_13loess_outputs_1__str__, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  "Outputs of a loess fit. This object is automatically created with empty\nvalues when a new loess object is instantiated. The object gets filled when the \nloess.fit() method is called.\n    \n:IVariables:\n    fitted_values : ndarray\n        The (n,) ndarray of fitted values.\n    fitted_residuals : ndarray\n        The (n,) ndarray of fitted residuals (observations - fitted values).\n    enp : float\n        Equivalent number of parameters.\n    s : float\n        Estimate of the scale of residuals.\n    one_delta: float\n        Statistical parameter used in the computation of standard errors.\n    two_delta : float\n        Statistical parameter used in the computation of standard errors.\n    pseudovalues : ndarray\n        The (n,) ndarray of adjusted values of the response when robust estimation \n        is used.\n    trace_hat : float    \n        Trace of the operator hat matrix.\n    diagonal : ndarray\n        Diagonal of the operator hat matrix.\n    robust : ndarray\n        The (n,) ndarray of robustness weights for robust fitting.\n    divisor : ndarray\n        The (p,) array of normalization divisors for numeric predictors.\n    ", /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6_loess_loess_outputs, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6_loess_loess_outputs, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_loess_outputs, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};
static struct __pyx_vtabstruct_6_loess_conf_intervals __pyx_vtable_6_loess_conf_intervals;

static PyObject *__pyx_tp_new_6_loess_conf_intervals(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6_loess_conf_intervals *p;
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  p = ((struct __pyx_obj_6_loess_conf_intervals *)o);
  p->__pyx_vtab = __pyx_vtabptr_6_loess_conf_intervals;
  p->lower = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  p->fit = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  p->upper = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_6_loess_conf_intervals(PyObject *o) {
  struct __pyx_obj_6_loess_conf_intervals *p = (struct __pyx_obj_6_loess_conf_intervals *)o;
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  PyObject_GC_UnTrack(o);
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pw_6_loess_14conf_intervals_1__dealloc__(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  Py_CLEAR(p->lower);
  Py_CLEAR(p->fit);
  Py_CLEAR(p->upper);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_6_loess_conf_intervals(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6_loess_conf_intervals *p = (struct __pyx_obj_6_loess_conf_intervals *)o;
  if (p->lower) {
    e = (*v)(((PyObject*)p->lower), a); if (e) return e;
  }
  if (p->fit) {
    e = (*v)(((PyObject*)p->fit), a); if (e) return e;
  }
  if (p->upper) {
    e = (*v)(((PyObject*)p->upper), a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6_loess_conf_intervals(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6_loess_conf_intervals *p = (struct __pyx_obj_6_loess_conf_intervals *)o;
  tmp = ((PyObject*)p->lower);
  p->lower = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fit);
  p->fit = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->upper);
  p->upper = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6_loess_14conf_intervals_lower(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_14conf_intervals_5lower_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_14conf_intervals_fit(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_14conf_intervals_3fit_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_14conf_intervals_upper(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_14conf_intervals_5upper_1__get__(o);
}

static PyMethodDef __pyx_methods_6_loess_conf_intervals[] = {
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6_loess_conf_intervals[] = {
  {(char *)"lower", __pyx_getprop_6_loess_14conf_intervals_lower, 0, 0, 0},
  {(char *)"fit", __pyx_getprop_6_loess_14conf_intervals_fit, 0, 0, 0},
  {(char *)"upper", __pyx_getprop_6_loess_14conf_intervals_upper, 0, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyTypeObject __pyx_type_6_loess_conf_intervals = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.conf_intervals", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_conf_intervals), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_conf_intervals, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  __pyx_pw_6_loess_14conf_intervals_3__str__, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  "Pointwise confidence intervals of a loess-predicted object:\n    \n:IVariables:\n    fit : ndarray\n        Predicted values.\n    lower : ndarray\n        Lower bounds of the confidence intervals.\n    upper : ndarray\n        Upper bounds of the confidence intervals.\n    ", /*tp_doc*/
  __pyx_tp_traverse_6_loess_conf_intervals, /*tp_traverse*/
  __pyx_tp_clear_6_loess_conf_intervals, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6_loess_conf_intervals, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6_loess_conf_intervals, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_conf_intervals, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};
static struct __pyx_vtabstruct_6_loess_loess_predicted __pyx_vtable_6_loess_loess_predicted;

static PyObject *__pyx_tp_new_6_loess_loess_predicted(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6_loess_loess_predicted *p;
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  p = ((struct __pyx_obj_6_loess_loess_predicted *)o);
  p->__pyx_vtab = __pyx_vtabptr_6_loess_loess_predicted;
  p->confidence_intervals = ((struct __pyx_obj_6_loess_conf_intervals *)Py_None); Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_6_loess_loess_predicted(PyObject *o) {
  struct __pyx_obj_6_loess_loess_predicted *p = (struct __pyx_obj_6_loess_loess_predicted *)o;
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  PyObject_GC_UnTrack(o);
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pw_6_loess_15loess_predicted_1__dealloc__(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  Py_CLEAR(p->confidence_intervals);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_6_loess_loess_predicted(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6_loess_loess_predicted *p = (struct __pyx_obj_6_loess_loess_predicted *)o;
  if (p->confidence_intervals) {
    e = (*v)(((PyObject*)p->confidence_intervals), a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6_loess_loess_predicted(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6_loess_loess_predicted *p = (struct __pyx_obj_6_loess_loess_predicted *)o;
  tmp = ((PyObject*)p->confidence_intervals);
  p->confidence_intervals = ((struct __pyx_obj_6_loess_conf_intervals *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6_loess_15loess_predicted_values(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_15loess_predicted_6values_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_15loess_predicted_stderr(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_15loess_predicted_6stderr_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_15loess_predicted_residual_scale(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_15loess_predicted_14residual_scale_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_15loess_predicted_df(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_15loess_predicted_2df_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_15loess_predicted_nest(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_15loess_predicted_4nest_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_15loess_predicted_confidence_intervals(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_15loess_predicted_20confidence_intervals_1__get__(o);
}

static PyMethodDef __pyx_methods_6_loess_loess_predicted[] = {
  {"confidence", (PyCFunction)__pyx_pw_6_loess_15loess_predicted_3confidence, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6_loess_15loess_predicted_2confidence},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6_loess_loess_predicted[] = {
  {(char *)"values", __pyx_getprop_6_loess_15loess_predicted_values, 0, 0, 0},
  {(char *)"stderr", __pyx_getprop_6_loess_15loess_predicted_stderr, 0, 0, 0},
  {(char *)"residual_scale", __pyx_getprop_6_loess_15loess_predicted_residual_scale, 0, 0, 0},
  {(char *)"df", __pyx_getprop_6_loess_15loess_predicted_df, 0, 0, 0},
  {(char *)"nest", __pyx_getprop_6_loess_15loess_predicted_nest, 0, 0, 0},
  {(char *)"confidence_intervals", __pyx_getprop_6_loess_15loess_predicted_confidence_intervals, 0, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyTypeObject __pyx_type_6_loess_loess_predicted = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.loess_predicted", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_loess_predicted), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_loess_predicted, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  __pyx_pw_6_loess_15loess_predicted_5__str__, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  "Predicted values and standard errors of a loess object\n\n:IVariables:\n    values : ndarray\n        The (m,) ndarray of loess values evaluated at newdata\n    stderr : ndarray\n        The (m,) ndarray of the estimates of the standard error on the estimated\n        values.\n    residual_scale : float\n        Estimate of the scale of the residuals\n    df : integer\n        Degrees of freedom of the t-distribution used to compute pointwise \n        confidence intervals for the evaluated surface.\n    nest : integer\n        Number of new observations.\n    ", /*tp_doc*/
  __pyx_tp_traverse_6_loess_loess_predicted, /*tp_traverse*/
  __pyx_tp_clear_6_loess_loess_predicted, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6_loess_loess_predicted, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6_loess_loess_predicted, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_loess_predicted, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};

static PyObject *__pyx_tp_new_6_loess_loess(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6_loess_loess *p;
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  p = ((struct __pyx_obj_6_loess_loess *)o);
  p->inputs = ((struct __pyx_obj_6_loess_loess_inputs *)Py_None); Py_INCREF(Py_None);
  p->model = ((struct __pyx_obj_6_loess_loess_model *)Py_None); Py_INCREF(Py_None);
  p->control = ((struct __pyx_obj_6_loess_loess_control *)Py_None); Py_INCREF(Py_None);
  p->kd_tree = ((struct __pyx_obj_6_loess_loess_kd_tree *)Py_None); Py_INCREF(Py_None);
  p->outputs = ((struct __pyx_obj_6_loess_loess_outputs *)Py_None); Py_INCREF(Py_None);
  p->predicted = ((struct __pyx_obj_6_loess_loess_predicted *)Py_None); Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_6_loess_loess(PyObject *o) {
  struct __pyx_obj_6_loess_loess *p = (struct __pyx_obj_6_loess_loess *)o;
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  PyObject_GC_UnTrack(o);
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pw_6_loess_5loess_11__dealloc__(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  Py_CLEAR(p->inputs);
  Py_CLEAR(p->model);
  Py_CLEAR(p->control);
  Py_CLEAR(p->kd_tree);
  Py_CLEAR(p->outputs);
  Py_CLEAR(p->predicted);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_6_loess_loess(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6_loess_loess *p = (struct __pyx_obj_6_loess_loess *)o;
  if (p->inputs) {
    e = (*v)(((PyObject*)p->inputs), a); if (e) return e;
  }
  if (p->model) {
    e = (*v)(((PyObject*)p->model), a); if (e) return e;
  }
  if (p->control) {
    e = (*v)(((PyObject*)p->control), a); if (e) return e;
  }
  if (p->kd_tree) {
    e = (*v)(((PyObject*)p->kd_tree), a); if (e) return e;
  }
  if (p->outputs) {
    e = (*v)(((PyObject*)p->outputs), a); if (e) return e;
  }
  if (p->predicted) {
    e = (*v)(((PyObject*)p->predicted), a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6_loess_loess(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6_loess_loess *p = (struct __pyx_obj_6_loess_loess *)o;
  tmp = ((PyObject*)p->inputs);
  p->inputs = ((struct __pyx_obj_6_loess_loess_inputs *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->model);
  p->model = ((struct __pyx_obj_6_loess_loess_model *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->control);
  p->control = ((struct __pyx_obj_6_loess_loess_control *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->kd_tree);
  p->kd_tree = ((struct __pyx_obj_6_loess_loess_kd_tree *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->outputs);
  p->outputs = ((struct __pyx_obj_6_loess_loess_outputs *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->predicted);
  p->predicted = ((struct __pyx_obj_6_loess_loess_predicted *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6_loess_5loess_inputs(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5loess_6inputs_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_5loess_model(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5loess_5model_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_5loess_control(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5loess_7control_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_5loess_kd_tree(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5loess_7kd_tree_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_5loess_outputs(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5loess_7outputs_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_5loess_predicted(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5loess_9predicted_1__get__(o);
}

static PyMethodDef __pyx_methods_6_loess_loess[] = {
  {"fit", (PyCFunction)__pyx_pw_6_loess_5loess_3fit, METH_NOARGS, __pyx_doc_6_loess_5loess_2fit},
  {"input_summary", (PyCFunction)__pyx_pw_6_loess_5loess_5input_summary, METH_NOARGS, __pyx_doc_6_loess_5loess_4input_summary},
  {"output_summary", (PyCFunction)__pyx_pw_6_loess_5loess_7output_summary, METH_NOARGS, __pyx_doc_6_loess_5loess_6output_summary},
  {"predict", (PyCFunction)__pyx_pw_6_loess_5loess_9predict, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6_loess_5loess_8predict},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6_loess_loess[] = {
  {(char *)"inputs", __pyx_getprop_6_loess_5loess_inputs, 0, 0, 0},
  {(char *)"model", __pyx_getprop_6_loess_5loess_model, 0, 0, 0},
  {(char *)"control", __pyx_getprop_6_loess_5loess_control, 0, 0, 0},
  {(char *)"kd_tree", __pyx_getprop_6_loess_5loess_kd_tree, 0, 0, 0},
  {(char *)"outputs", __pyx_getprop_6_loess_5loess_outputs, 0, 0, 0},
  {(char *)"predicted", __pyx_getprop_6_loess_5loess_predicted, 0, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyTypeObject __pyx_type_6_loess_loess = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.loess", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_loess), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_loess, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  "\n    \n:Keywords:\n    x : ndarray\n        A (n,p) ndarray of independent variables, with n the number of observations\n        and p the number of variables.\n    y : ndarray\n        A (n,) ndarray of observations\n    weights : ndarray\n        A (n,) ndarray of weights to be given to individual observations in the \n        sum of squared residuals that forms the local fitting criterion. If not\n        None, the weights should be non negative. If the different observations\n        have non-equal variances, the weights should be inversely proportional \n        to the variances.\n        By default, an unweighted fit is carried out (all the weights are one).\n    surface : string [\"interpolate\"]\n        Determines whether the fitted surface is computed directly at all points\n        (\"direct\") or whether an interpolation method is used (\"interpolate\").\n        The default (\"interpolate\") is what most users should use unless special \n        circumstances warrant.\n    statistics : string [\"approximate\"]\n        Determines whether the statistical quantities are computed exactly \n        (\"exact\") or approximately (\"approximate\"). \"exact\" should only be used \n        for testing the approximation in statistical development and is not meant \n        for routine usage because computation time can be horrendous.\n    trace_hat : string [\"wait.to.decide\"]\n        Determines how the trace of the hat matrix should be computed. The hat\n        matrix is used in the computation of the statistical quantities. \n        If \"exact\", an exact computation is done; this could be slow when the\n        number of observations n becomes large. If \"wait.to.decide\" is selected, \n        then a default is \"exact\" for n < 500 and \"approximate\" otherwise. \n        This option is only useful when the fitted surface is interpolated. If  \n        surface is \"exact\", an exact computation is always done for the trace. \n        Setting trace_hat to \"approximate\" for large dataset will substantially \n        reduce the computation time.\n    iterations : integer\n        Number of iterations of the robust fitting method. If the family is \n        \"gaussian\", the number of iterations is set to 0.\n    cell : integer\n        Maximum cell size of the kd-tree. Suppose k = floor(n*cell*span),\n        where n is the number of observations, and span the smoothing parameter.\n        Then, a cell is further divided if the number of observations within it \n        is greater than or equal to k. This option is only used if the surface \n        is interpolated.\n    span : float [0.75]\n        Smoothing factor, as a fraction of the number of points to take into\n        account. \n    degree : integer [2]\n        Overall degree of locally-fitted polynomial. 1 is locally-linear \n        fitting and 2 is locally-quadratic fitting.  Degree should be 2 at most.\n    normalize : boolean [True]\n        Determines whether the independent variables should be normalized.  \n        If True, the normalization is performed by setting the 10% trimmed \n        standard deviation to one. If False, no normalization is carried out. \n        This option is only useful for more than one variable. For spatial\n        coordinates predictors or variables with a common scale, it should be \n        set to False.\n    family : string [\"gaussian\"]\n        Determines the assumed distribution of the errors. The values are \n        \"gaussian\" or \"symmetric\". If \"gaussian\" is selected, the fit is \n        performed with least-squares. If \"symmetric\" is selected, the fit\n        is performed robustly by redescending M-estimators.\n    parametric_flags : sequence [ [False]*p ]\n        Indicates which independent variables should be conditionally-parametric\n       (if there are two or more independent variables). The argument should \n       be a sequence of booleans, with the same size as the number of independent \n       variables, specified in the order of the predictor group ordered in x. \n    drop_square : sequence [ [False]* p]\n        When there are two or more independent variables and when a 2nd order\n        polynomial is used, \"drop_square_flags\" specifies those numeric predictors \n        whose squares should be dropped from the set of fitting variables. \n        The method of specification is the same as for parametric.  \n        \n:Outputs:\n    fitted_values : ndarray\n        The (n,) ndarray of fitted values.\n    fitted_residuals : ndarray\n        The (n,) ndarray of fitted residuals (observations - fitted values).\n    enp : float\n        Equivalent number of parameters.\n    s : float\n        Estimate of the scale of residuals.\n    one_delta: float\n        Statistical parameter used in the computation of standard errors.\n    two_delta : float\n        Statistical parameter used in the computation of standard errors.\n    pseudovalues : ndarray\n        The (n,) ndarray of adjusted values of the response when robust estimation \n        is used.\n    trace_hat : float    \n        Trace of the operator hat matrix.\n    diagonal :\n        Diagonal of the operator hat matrix.\n    robust : ndarray\n        The (n,) ndarray of robustness weights for robust fitting.\n    divisor : ndarray\n        The (p,) array of normalization divisors for numeric predictors.\n\n    ", /*tp_doc*/
  __pyx_tp_traverse_6_loess_loess, /*tp_traverse*/
  __pyx_tp_clear_6_loess_loess, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6_loess_loess, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6_loess_loess, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pw_6_loess_5loess_1__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_loess, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};

static PyObject *__pyx_tp_new_6_loess_anova(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  return o;
}

static void __pyx_tp_dealloc_6_loess_anova(PyObject *o) {
  #if PY_VERSION_HEX >= 0x030400a1
  if (unlikely(Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
    if (PyObject_CallFinalizerFromDealloc(o)) return;
  }
  #endif
  (*Py_TYPE(o)->tp_free)(o);
}

static PyObject *__pyx_getprop_6_loess_5anova_dfn(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5anova_3dfn_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_5anova_dfd(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5anova_3dfd_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_5anova_F_value(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5anova_7F_value_1__get__(o);
}

static PyObject *__pyx_getprop_6_loess_5anova_Pr_F(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6_loess_5anova_4Pr_F_1__get__(o);
}

static PyMethodDef __pyx_methods_6_loess_anova[] = {
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6_loess_anova[] = {
  {(char *)"dfn", __pyx_getprop_6_loess_5anova_dfn, 0, 0, 0},
  {(char *)"dfd", __pyx_getprop_6_loess_5anova_dfd, 0, 0, 0},
  {(char *)"F_value", __pyx_getprop_6_loess_5anova_F_value, 0, 0, 0},
  {(char *)"Pr_F", __pyx_getprop_6_loess_5anova_Pr_F, 0, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyTypeObject __pyx_type_6_loess_anova = {
  PyVarObject_HEAD_INIT(0, 0)
  "_loess.anova", /*tp_name*/
  sizeof(struct __pyx_obj_6_loess_anova), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6_loess_anova, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6_loess_anova, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6_loess_anova, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pw_6_loess_5anova_1__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6_loess_anova, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};

static PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
  #if PY_VERSION_HEX < 0x03020000
    { PyObject_HEAD_INIT(NULL) NULL, 0, NULL },
  #else
    PyModuleDef_HEAD_INIT,
  #endif
    "_loess",
    0, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp_s_Arguments_should_be_valid_loess, __pyx_k_Arguments_should_be_valid_loess, sizeof(__pyx_k_Arguments_should_be_valid_loess), 0, 0, 1, 0},
  {&__pyx_n_s_C, __pyx_k_C, sizeof(__pyx_k_C), 0, 0, 1, 1},
  {&__pyx_kp_s_Can_t_predict_without_input_data, __pyx_k_Can_t_predict_without_input_data, sizeof(__pyx_k_Can_t_predict_without_input_data), 0, 0, 1, 0},
  {&__pyx_kp_s_Cell_size_s, __pyx_k_Cell_size_s, sizeof(__pyx_k_Cell_size_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Confidence_intervals_Lower_b_fit, __pyx_k_Confidence_intervals_Lower_b_fit, sizeof(__pyx_k_Confidence_intervals_Lower_b_fit), 0, 0, 1, 0},
  {&__pyx_kp_s_Control, __pyx_k_Control, sizeof(__pyx_k_Control), 0, 0, 1, 0},
  {&__pyx_kp_s_Degree_s, __pyx_k_Degree_s, sizeof(__pyx_k_Degree_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Degree_should_be_between_0_and_2, __pyx_k_Degree_should_be_between_0_and_2, sizeof(__pyx_k_Degree_should_be_between_0_and_2), 0, 0, 1, 0},
  {&__pyx_kp_s_Degrees_of_freedom_s, __pyx_k_Degrees_of_freedom_s, sizeof(__pyx_k_Degrees_of_freedom_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Deltas_s_s, __pyx_k_Deltas_s_s, sizeof(__pyx_k_Deltas_s_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Drop_square_s, __pyx_k_Drop_square_s, sizeof(__pyx_k_Drop_square_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Equivalent_Number_of_Parameters, __pyx_k_Equivalent_Number_of_Parameters, sizeof(__pyx_k_Equivalent_Number_of_Parameters), 0, 0, 1, 0},
  {&__pyx_kp_s_Eqv_nb_of_parameters_s, __pyx_k_Eqv_nb_of_parameters_s, sizeof(__pyx_k_Eqv_nb_of_parameters_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Family_s, __pyx_k_Family_s, sizeof(__pyx_k_Family_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Fit_flag_d, __pyx_k_Fit_flag_d, sizeof(__pyx_k_Fit_flag_d), 0, 0, 1, 0},
  {&__pyx_kp_s_Fitted_residuals_s, __pyx_k_Fitted_residuals_s, sizeof(__pyx_k_Fitted_residuals_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Fitted_values_s, __pyx_k_Fitted_values_s, sizeof(__pyx_k_Fitted_values_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Incompatible_data_size_there_sho, __pyx_k_Incompatible_data_size_there_sho, sizeof(__pyx_k_Incompatible_data_size_there_sho), 0, 0, 1, 0},
  {&__pyx_kp_s_Invalid_number_of_iterations_sho, __pyx_k_Invalid_number_of_iterations_sho, sizeof(__pyx_k_Invalid_number_of_iterations_sho), 0, 0, 1, 0},
  {&__pyx_kp_s_Invalid_size_of_the_weights_vect, __pyx_k_Invalid_size_of_the_weights_vect, sizeof(__pyx_k_Invalid_size_of_the_weights_vect), 0, 0, 1, 0},
  {&__pyx_kp_s_Invalid_value_for_the_cell_argum, __pyx_k_Invalid_value_for_the_cell_argum, sizeof(__pyx_k_Invalid_value_for_the_cell_argum), 0, 0, 1, 0},
  {&__pyx_kp_s_Invalid_value_for_the_family_arg, __pyx_k_Invalid_value_for_the_family_arg, sizeof(__pyx_k_Invalid_value_for_the_family_arg), 0, 0, 1, 0},
  {&__pyx_kp_s_Invalid_value_for_the_statistics, __pyx_k_Invalid_value_for_the_statistics, sizeof(__pyx_k_Invalid_value_for_the_statistics), 0, 0, 1, 0},
  {&__pyx_kp_s_Invalid_value_for_the_surface_ar, __pyx_k_Invalid_value_for_the_surface_ar, sizeof(__pyx_k_Invalid_value_for_the_surface_ar), 0, 0, 1, 0},
  {&__pyx_kp_s_Invalid_value_for_the_trace_hat, __pyx_k_Invalid_value_for_the_trace_hat, sizeof(__pyx_k_Invalid_value_for_the_trace_hat), 0, 0, 1, 0},
  {&__pyx_kp_s_Model_parameters, __pyx_k_Model_parameters, sizeof(__pyx_k_Model_parameters), 0, 0, 1, 0},
  {&__pyx_kp_s_Nb_iterations_s, __pyx_k_Nb_iterations_s, sizeof(__pyx_k_Nb_iterations_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Normalization_factors_s, __pyx_k_Normalization_factors_s, sizeof(__pyx_k_Normalization_factors_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Normalized_s, __pyx_k_Normalized_s, sizeof(__pyx_k_Normalized_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Number_of_Observations_d, __pyx_k_Number_of_Observations_d, sizeof(__pyx_k_Number_of_Observations_d), 0, 0, 1, 0},
  {&__pyx_kp_s_Outputs, __pyx_k_Outputs, sizeof(__pyx_k_Outputs), 0, 0, 1, 0},
  {&__pyx_kp_s_Parametric_s, __pyx_k_Parametric_s, sizeof(__pyx_k_Parametric_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Predicted_std_error_s, __pyx_k_Predicted_std_error_s, sizeof(__pyx_k_Predicted_std_error_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Predicted_values_s, __pyx_k_Predicted_values_s, sizeof(__pyx_k_Predicted_values_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Residual_Scale_Estimate_4f, __pyx_k_Residual_Scale_Estimate_4f, sizeof(__pyx_k_Residual_Scale_Estimate_4f), 0, 0, 1, 0},
  {&__pyx_kp_s_Residual_Standard_Error_4f, __pyx_k_Residual_Standard_Error_4f, sizeof(__pyx_k_Residual_Standard_Error_4f), 0, 0, 1, 0},
  {&__pyx_kp_s_Residual_error_s, __pyx_k_Residual_error_s, sizeof(__pyx_k_Residual_error_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Residual_scale_s, __pyx_k_Residual_scale_s, sizeof(__pyx_k_Residual_scale_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Span_s, __pyx_k_Span_s, sizeof(__pyx_k_Span_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Span_should_be_between_0_and_1, __pyx_k_Span_should_be_between_0_and_1, sizeof(__pyx_k_Span_should_be_between_0_and_1), 0, 0, 1, 0},
  {&__pyx_kp_s_Statistics_s, __pyx_k_Statistics_s, sizeof(__pyx_k_Statistics_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Surface_type_s, __pyx_k_Surface_type_s, sizeof(__pyx_k_Surface_type_s), 0, 0, 1, 0},
  {&__pyx_n_s_T, __pyx_k_T, sizeof(__pyx_k_T), 0, 0, 1, 1},
  {&__pyx_kp_s_The_array_of_indepedent_varibale, __pyx_k_The_array_of_indepedent_varibale, sizeof(__pyx_k_The_array_of_indepedent_varibale), 0, 0, 1, 0},
  {&__pyx_kp_s_The_coverage_precentage_should_b, __pyx_k_The_coverage_precentage_should_b, sizeof(__pyx_k_The_coverage_precentage_should_b), 0, 0, 1, 0},
  {&__pyx_kp_s_Trace_estimation_s, __pyx_k_Trace_estimation_s, sizeof(__pyx_k_Trace_estimation_s), 0, 0, 1, 0},
  {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
  {&__pyx_kp_s__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 0, 1, 0},
  {&__pyx_n_s_approximate, __pyx_k_approximate, sizeof(__pyx_k_approximate), 0, 0, 1, 1},
  {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
  {&__pyx_n_s_astype, __pyx_k_astype, sizeof(__pyx_k_astype), 0, 0, 1, 1},
  {&__pyx_n_s_atleast_1d, __pyx_k_atleast_1d, sizeof(__pyx_k_atleast_1d), 0, 0, 1, 1},
  {&__pyx_n_s_bool, __pyx_k_bool, sizeof(__pyx_k_bool), 0, 0, 1, 1},
  {&__pyx_n_s_cell, __pyx_k_cell, sizeof(__pyx_k_cell), 0, 0, 1, 1},
  {&__pyx_n_s_copy, __pyx_k_copy, sizeof(__pyx_k_copy), 0, 0, 1, 1},
  {&__pyx_n_s_coverage, __pyx_k_coverage, sizeof(__pyx_k_coverage), 0, 0, 1, 1},
  {&__pyx_n_s_degree, __pyx_k_degree, sizeof(__pyx_k_degree), 0, 0, 1, 1},
  {&__pyx_n_s_df, __pyx_k_df, sizeof(__pyx_k_df), 0, 0, 1, 1},
  {&__pyx_n_s_direct, __pyx_k_direct, sizeof(__pyx_k_direct), 0, 0, 1, 1},
  {&__pyx_n_s_divisor, __pyx_k_divisor, sizeof(__pyx_k_divisor), 0, 0, 1, 1},
  {&__pyx_n_s_drop_square, __pyx_k_drop_square, sizeof(__pyx_k_drop_square), 0, 0, 1, 1},
  {&__pyx_n_s_drop_square_flags, __pyx_k_drop_square_flags, sizeof(__pyx_k_drop_square_flags), 0, 0, 1, 1},
  {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
  {&__pyx_n_s_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 0, 1, 1},
  {&__pyx_n_s_enp, __pyx_k_enp, sizeof(__pyx_k_enp), 0, 0, 1, 1},
  {&__pyx_n_s_exact, __pyx_k_exact, sizeof(__pyx_k_exact), 0, 0, 1, 1},
  {&__pyx_n_s_family, __pyx_k_family, sizeof(__pyx_k_family), 0, 0, 1, 1},
  {&__pyx_n_s_file, __pyx_k_file, sizeof(__pyx_k_file), 0, 0, 1, 1},
  {&__pyx_n_s_fitted_residuals, __pyx_k_fitted_residuals, sizeof(__pyx_k_fitted_residuals), 0, 0, 1, 1},
  {&__pyx_n_s_fitted_values, __pyx_k_fitted_values, sizeof(__pyx_k_fitted_values), 0, 0, 1, 1},
  {&__pyx_n_s_float, __pyx_k_float, sizeof(__pyx_k_float), 0, 0, 1, 1},
  {&__pyx_n_s_gaussian, __pyx_k_gaussian, sizeof(__pyx_k_gaussian), 0, 0, 1, 1},
  {&__pyx_n_s_get, __pyx_k_get, sizeof(__pyx_k_get), 0, 0, 1, 1},
  {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
  {&__pyx_n_s_interpolate, __pyx_k_interpolate, sizeof(__pyx_k_interpolate), 0, 0, 1, 1},
  {&__pyx_n_s_iterations, __pyx_k_iterations, sizeof(__pyx_k_iterations), 0, 0, 1, 1},
  {&__pyx_n_s_iteritems, __pyx_k_iteritems, sizeof(__pyx_k_iteritems), 0, 0, 1, 1},
  {&__pyx_n_s_join, __pyx_k_join, sizeof(__pyx_k_join), 0, 0, 1, 1},
  {&__pyx_kp_s_loess_object_model_parameters, __pyx_k_loess_object_model_parameters, sizeof(__pyx_k_loess_object_model_parameters), 0, 0, 1, 0},
  {&__pyx_n_s_loess_one, __pyx_k_loess_one, sizeof(__pyx_k_loess_one), 0, 0, 1, 1},
  {&__pyx_n_s_loess_two, __pyx_k_loess_two, sizeof(__pyx_k_loess_two), 0, 0, 1, 1},
  {&__pyx_n_s_lower, __pyx_k_lower, sizeof(__pyx_k_lower), 0, 0, 1, 1},
  {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
  {&__pyx_n_s_narray, __pyx_k_narray, sizeof(__pyx_k_narray), 0, 0, 1, 1},
  {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
  {&__pyx_n_s_newdata, __pyx_k_newdata, sizeof(__pyx_k_newdata), 0, 0, 1, 1},
  {&__pyx_n_s_normalize, __pyx_k_normalize, sizeof(__pyx_k_normalize), 0, 0, 1, 1},
  {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
  {&__pyx_n_s_one_delta, __pyx_k_one_delta, sizeof(__pyx_k_one_delta), 0, 0, 1, 1},
  {&__pyx_n_s_ones, __pyx_k_ones, sizeof(__pyx_k_ones), 0, 0, 1, 1},
  {&__pyx_n_s_order, __pyx_k_order, sizeof(__pyx_k_order), 0, 0, 1, 1},
  {&__pyx_n_s_outputs, __pyx_k_outputs, sizeof(__pyx_k_outputs), 0, 0, 1, 1},
  {&__pyx_n_s_parametric, __pyx_k_parametric, sizeof(__pyx_k_parametric), 0, 0, 1, 1},
  {&__pyx_n_s_parametric_flags, __pyx_k_parametric_flags, sizeof(__pyx_k_parametric_flags), 0, 0, 1, 1},
  {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
  {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
  {&__pyx_n_s_r, __pyx_k_r, sizeof(__pyx_k_r), 0, 0, 1, 1},
  {&__pyx_n_s_ravel, __pyx_k_ravel, sizeof(__pyx_k_ravel), 0, 0, 1, 1},
  {&__pyx_n_s_residual_scale, __pyx_k_residual_scale, sizeof(__pyx_k_residual_scale), 0, 0, 1, 1},
  {&__pyx_n_s_s, __pyx_k_s, sizeof(__pyx_k_s), 0, 0, 1, 1},
  {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
  {&__pyx_kp_s_should_be_in_interpolate_direct, __pyx_k_should_be_in_interpolate_direct, sizeof(__pyx_k_should_be_in_interpolate_direct), 0, 0, 1, 0},
  {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
  {&__pyx_n_s_span, __pyx_k_span, sizeof(__pyx_k_span), 0, 0, 1, 1},
  {&__pyx_n_s_statistics, __pyx_k_statistics, sizeof(__pyx_k_statistics), 0, 0, 1, 1},
  {&__pyx_n_s_stderr, __pyx_k_stderr, sizeof(__pyx_k_stderr), 0, 0, 1, 1},
  {&__pyx_n_s_stderror, __pyx_k_stderror, sizeof(__pyx_k_stderror), 0, 0, 1, 1},
  {&__pyx_n_s_subok, __pyx_k_subok, sizeof(__pyx_k_subok), 0, 0, 1, 1},
  {&__pyx_n_s_surface, __pyx_k_surface, sizeof(__pyx_k_surface), 0, 0, 1, 1},
  {&__pyx_n_s_symmetric, __pyx_k_symmetric, sizeof(__pyx_k_symmetric), 0, 0, 1, 1},
  {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
  {&__pyx_n_s_trace_hat, __pyx_k_trace_hat, sizeof(__pyx_k_trace_hat), 0, 0, 1, 1},
  {&__pyx_n_s_two_delta, __pyx_k_two_delta, sizeof(__pyx_k_two_delta), 0, 0, 1, 1},
  {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
  {&__pyx_n_s_values, __pyx_k_values, sizeof(__pyx_k_values), 0, 0, 1, 1},
  {&__pyx_n_s_weights, __pyx_k_weights, sizeof(__pyx_k_weights), 0, 0, 1, 1},
  {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
  {&__pyx_n_s_x_data, __pyx_k_x_data, sizeof(__pyx_k_x_data), 0, 0, 1, 1},
  {&__pyx_n_s_y, __pyx_k_y, sizeof(__pyx_k_y), 0, 0, 1, 1},
  {&__pyx_n_s_y_data, __pyx_k_y_data, sizeof(__pyx_k_y_data), 0, 0, 1, 1},
  {0, 0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitCachedConstants(void) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);

  /* "_loess.pyx":97
 *             self.npar = self.x.shape[-1]
 *         else:
 *             raise ValueError("The array of indepedent varibales should be 2D at most!")             # <<<<<<<<<<<<<<
 *         self.nobs = len(self.x)
 *         # Get the effective data ......
 */
  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_s_The_array_of_indepedent_varibale); if (unlikely(!__pyx_tuple_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple_);
  __Pyx_GIVEREF(__pyx_tuple_);

  /* "_loess.pyx":121
 *             w_ndr = narray(w, copy=False, subok=False)
 *             if w_ndr.ndim > 1 or w_ndr.size != self.nobs:
 *                 raise ValueError("Invalid size of the 'weights' vector!")             # <<<<<<<<<<<<<<
 *             self.w_ndr = w_ndr
 *             self._base.weights = <double *>w_ndr.data
 */
  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_Invalid_size_of_the_weights_vect); if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__2);
  __Pyx_GIVEREF(__pyx_tuple__2);

  /* "_loess.pyx":194
 *         def __set__(self, statistics):
 *             if statistics.lower() not in ('approximate', 'exact'):
 *                 raise ValueError("Invalid value for the 'statistics' argument: "\             # <<<<<<<<<<<<<<
 *                                  "should be in ('approximate', 'exact').")
 *             tmpx = statistics.lower()
 */
  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_Invalid_value_for_the_statistics); if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__3);
  __Pyx_GIVEREF(__pyx_tuple__3);

  /* "_loess.pyx":216
 *         def __set__(self, trace_hat):
 *             if trace_hat.lower() not in ('approximate', 'exact'):
 *                 raise ValueError("Invalid value for the 'trace_hat' argument: "\             # <<<<<<<<<<<<<<
 *                                  "should be in ('approximate', 'exact').")
 *             tmpx = trace_hat.lower()
 */
  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_Invalid_value_for_the_trace_hat); if (unlikely(!__pyx_tuple__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__4);
  __Pyx_GIVEREF(__pyx_tuple__4);

  /* "_loess.pyx":231
 *         def __set__(self, iterations):
 *             if iterations < 0:
 *                 raise ValueError("Invalid number of iterations: should be positive")             # <<<<<<<<<<<<<<
 *             self._base.iterations = iterations
 *     #.........
 */
  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s_Invalid_number_of_iterations_sho); if (unlikely(!__pyx_tuple__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__5);
  __Pyx_GIVEREF(__pyx_tuple__5);

  /* "_loess.pyx":247
 *         def __set__(self, cell):
 *             if cell <= 0:
 *                 raise ValueError("Invalid value for the cell argument: should be positive")             # <<<<<<<<<<<<<<
 *             self._base.cell = cell
 *     #.........
 */
  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_s_Invalid_value_for_the_cell_argum); if (unlikely(!__pyx_tuple__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__6);
  __Pyx_GIVEREF(__pyx_tuple__6);

  /* "_loess.pyx":350
 *         def __set__(self, span):
 *             if span <= 0. or span > 1.:
 *                 raise ValueError("Span should be between 0 and 1!")             # <<<<<<<<<<<<<<
 *             self._base.span = span
 *     #.........
 */
  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_s_Span_should_be_between_0_and_1); if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__8);
  __Pyx_GIVEREF(__pyx_tuple__8);

  /* "_loess.pyx":358
 *         def __set__(self, degree):
 *             if degree < 0 or degree > 2:
 *                 raise ValueError("Degree should be between 0 and 2!")             # <<<<<<<<<<<<<<
 *             self._base.degree = degree
 *     #.........
 */
  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_s_Degree_should_be_between_0_and_2); if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__9);
  __Pyx_GIVEREF(__pyx_tuple__9);

  /* "_loess.pyx":366
 *         def __set__(self, family):
 *             if family.lower() not in ('symmetric', 'gaussian'):
 *                 raise ValueError("Invalid value for the 'family' argument: "\             # <<<<<<<<<<<<<<
 *                                  "should be in ('symmetric', 'gaussian').")
 *             self._base.family = family
 */
  __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_s_Invalid_value_for_the_family_arg); if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__10);
  __Pyx_GIVEREF(__pyx_tuple__10);

  /* "_loess.pyx":630
 *             coverage = 1. - coverage
 *         if coverage > 1. :
 *             raise ValueError("The coverage precentage should be between 0 and 1!")             # <<<<<<<<<<<<<<
 *         c_loess.c_pointwise(&self._base, self.nest, coverage, &_confintv)
 *         self.confidence_intervals = conf_intervals()
 */
  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s_The_coverage_precentage_should_b); if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__11);
  __Pyx_GIVEREF(__pyx_tuple__11);

  /* "_loess.pyx":863
 *         # Test the compatibility of sizes .......
 *         if p_ndr.size == 0:
 *             raise ValueError("Can't predict without input data !")             # <<<<<<<<<<<<<<
 *         (m, notOK) = divmod(len(p_ndr), self.inputs.npar)
 *         if notOK:
 */
  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_Can_t_predict_without_input_data); if (unlikely(!__pyx_tuple__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 863; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__12);
  __Pyx_GIVEREF(__pyx_tuple__12);

  /* "_loess.pyx":866
 *         (m, notOK) = divmod(len(p_ndr), self.inputs.npar)
 *         if notOK:
 *             raise ValueError(             # <<<<<<<<<<<<<<
 *                   "Incompatible data size: there should be as many rows as parameters")
 *         #.....
 */
  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_Incompatible_data_size_there_sho); if (unlikely(!__pyx_tuple__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__13);
  __Pyx_GIVEREF(__pyx_tuple__13);
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_InitGlobals(void) {
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_float_0_ = PyFloat_FromDouble(0.); if (unlikely(!__pyx_float_0_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_float_1_ = PyFloat_FromDouble(1.); if (unlikely(!__pyx_float_1_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_float_0_5 = PyFloat_FromDouble(0.5); if (unlikely(!__pyx_float_0_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_float_0_95 = PyFloat_FromDouble(0.95); if (unlikely(!__pyx_float_0_95)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC init_loess(void); /*proto*/
PyMODINIT_FUNC init_loess(void)
#else
PyMODINIT_FUNC PyInit__loess(void); /*proto*/
PyMODINIT_FUNC PyInit__loess(void)
#endif
{
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannyDeclarations
  #if CYTHON_REFNANNY
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
      PyErr_Clear();
      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
      if (!__Pyx_RefNanny)
          Py_FatalError("failed to import 'refnanny' module");
  }
  #endif
  __Pyx_RefNannySetupContext("PyMODINIT_FUNC PyInit__loess(void)", 0);
  if ( __Pyx_check_binary_version() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #ifdef __Pyx_CyFunction_USED
  if (__Pyx_CyFunction_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  #ifdef __Pyx_FusedFunction_USED
  if (__pyx_FusedFunction_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  #ifdef __Pyx_Generator_USED
  if (__pyx_Generator_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  /*--- Library function declarations ---*/
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("_loess", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (unlikely(!__pyx_m)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_d);
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if CYTHON_COMPILING_IN_PYPY
  Py_INCREF(__pyx_b);
  #endif
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
  if (__Pyx_init_sys_getdefaultencoding_params() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  if (__pyx_module_is_main__loess) {
    if (PyObject_SetAttrString(__pyx_m, "__name__", __pyx_n_s_main) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  }
  #if PY_MAJOR_VERSION >= 3
  {
    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!PyDict_GetItemString(modules, "_loess")) {
      if (unlikely(PyDict_SetItemString(modules, "_loess", __pyx_m) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
  }
  #endif
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Constants init code ---*/
  if (unlikely(__Pyx_InitCachedConstants() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Global init code ---*/
  /*--- Variable export code ---*/
  /*--- Function export code ---*/
  /*--- Type init code ---*/
  if (PyType_Ready(&__pyx_type_6_loess_loess_inputs) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_loess_inputs.tp_print = 0;
  if (PyObject_SetAttrString(__pyx_m, "loess_inputs", (PyObject *)&__pyx_type_6_loess_loess_inputs) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_loess_inputs = &__pyx_type_6_loess_loess_inputs;
  if (PyType_Ready(&__pyx_type_6_loess_loess_control) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_loess_control.tp_print = 0;
  if (PyObject_SetAttrString(__pyx_m, "loess_control", (PyObject *)&__pyx_type_6_loess_loess_control) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_loess_control = &__pyx_type_6_loess_loess_control;
  if (PyType_Ready(&__pyx_type_6_loess_loess_kd_tree) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_loess_kd_tree.tp_print = 0;
  if (PyObject_SetAttrString(__pyx_m, "loess_kd_tree", (PyObject *)&__pyx_type_6_loess_loess_kd_tree) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_loess_kd_tree = &__pyx_type_6_loess_loess_kd_tree;
  __pyx_vtabptr_6_loess_loess_model = &__pyx_vtable_6_loess_loess_model;
  __pyx_vtable_6_loess_loess_model.setup = (PyObject *(*)(struct __pyx_obj_6_loess_loess_model *, loess_model *, long))__pyx_f_6_loess_11loess_model_setup;
  if (PyType_Ready(&__pyx_type_6_loess_loess_model) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_loess_model.tp_print = 0;
  if (__Pyx_SetVtable(__pyx_type_6_loess_loess_model.tp_dict, __pyx_vtabptr_6_loess_loess_model) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttrString(__pyx_m, "loess_model", (PyObject *)&__pyx_type_6_loess_loess_model) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_loess_model = &__pyx_type_6_loess_loess_model;
  __pyx_vtabptr_6_loess_loess_outputs = &__pyx_vtable_6_loess_loess_outputs;
  __pyx_vtable_6_loess_loess_outputs.setup = (PyObject *(*)(struct __pyx_obj_6_loess_loess_outputs *, loess_outputs *, long, long))__pyx_f_6_loess_13loess_outputs_setup;
  if (PyType_Ready(&__pyx_type_6_loess_loess_outputs) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_loess_outputs.tp_print = 0;
  if (__Pyx_SetVtable(__pyx_type_6_loess_loess_outputs.tp_dict, __pyx_vtabptr_6_loess_loess_outputs) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttrString(__pyx_m, "loess_outputs", (PyObject *)&__pyx_type_6_loess_loess_outputs) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_loess_outputs = &__pyx_type_6_loess_loess_outputs;
  __pyx_vtabptr_6_loess_conf_intervals = &__pyx_vtable_6_loess_conf_intervals;
  __pyx_vtable_6_loess_conf_intervals.setup = (PyObject *(*)(struct __pyx_obj_6_loess_conf_intervals *, conf_inv, long))__pyx_f_6_loess_14conf_intervals_setup;
  if (PyType_Ready(&__pyx_type_6_loess_conf_intervals) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_conf_intervals.tp_print = 0;
  if (__Pyx_SetVtable(__pyx_type_6_loess_conf_intervals.tp_dict, __pyx_vtabptr_6_loess_conf_intervals) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttrString(__pyx_m, "conf_intervals", (PyObject *)&__pyx_type_6_loess_conf_intervals) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_conf_intervals = &__pyx_type_6_loess_conf_intervals;
  __pyx_vtabptr_6_loess_loess_predicted = &__pyx_vtable_6_loess_loess_predicted;
  __pyx_vtable_6_loess_loess_predicted.setup = (PyObject *(*)(struct __pyx_obj_6_loess_loess_predicted *, prediction, long))__pyx_f_6_loess_15loess_predicted_setup;
  if (PyType_Ready(&__pyx_type_6_loess_loess_predicted) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_loess_predicted.tp_print = 0;
  if (__Pyx_SetVtable(__pyx_type_6_loess_loess_predicted.tp_dict, __pyx_vtabptr_6_loess_loess_predicted) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttrString(__pyx_m, "loess_predicted", (PyObject *)&__pyx_type_6_loess_loess_predicted) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_loess_predicted = &__pyx_type_6_loess_loess_predicted;
  if (PyType_Ready(&__pyx_type_6_loess_loess) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_loess.tp_print = 0;
  if (PyObject_SetAttrString(__pyx_m, "loess", (PyObject *)&__pyx_type_6_loess_loess) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_loess = &__pyx_type_6_loess_loess;
  if (PyType_Ready(&__pyx_type_6_loess_anova) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_6_loess_anova.tp_print = 0;
  if (PyObject_SetAttrString(__pyx_m, "anova", (PyObject *)&__pyx_type_6_loess_anova) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6_loess_anova = &__pyx_type_6_loess_anova;
  /*--- Type import code ---*/
  __pyx_ptype_7c_numpy_dtype = __Pyx_ImportType("numpy", "dtype", sizeof(PyArray_Descr), 0); if (unlikely(!__pyx_ptype_7c_numpy_dtype)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7c_numpy_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject), 0); if (unlikely(!__pyx_ptype_7c_numpy_ndarray)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7c_numpy_flatiter = __Pyx_ImportType("numpy", "flatiter", sizeof(PyArrayIterObject), 0); if (unlikely(!__pyx_ptype_7c_numpy_flatiter)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7c_numpy_broadcast = __Pyx_ImportType("numpy", "broadcast", sizeof(PyArrayMultiIterObject), 0); if (unlikely(!__pyx_ptype_7c_numpy_broadcast)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Variable import code ---*/
  /*--- Function import code ---*/
  /*--- Execution code ---*/

  /* "_loess.pyx":8
 *     NPY_INT, NPY_DOUBLE, NPY_OWNDATA, NPY_ALIGNED, NPY_FORTRAN, \
 *     PyArray_SimpleNewFromData
 * import numpy             # <<<<<<<<<<<<<<
 * narray = numpy.array
 * float_ = numpy.float_
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_numpy, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":9
 *     PyArray_SimpleNewFromData
 * import numpy
 * narray = numpy.array             # <<<<<<<<<<<<<<
 * float_ = numpy.float_
 * 
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_narray, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "_loess.pyx":10
 * import numpy
 * narray = numpy.array
 * float_ = numpy.float_             # <<<<<<<<<<<<<<
 * 
 * # NumPy must be initialized
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_float, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "_loess.pyx":13
 * 
 * # NumPy must be initialized
 * c_numpy.import_array()             # <<<<<<<<<<<<<<
 * 
 * cimport c_loess
 */
  import_array();

  /* "_loess.pyx":1
 * # -*- Mode: Python -*-             # <<<<<<<<<<<<<<
 * cimport c_python
 * cimport c_numpy
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /*--- Wrapped vars code ---*/

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  if (__pyx_m) {
    if (__pyx_d) {
      __Pyx_AddTraceback("init _loess", __pyx_clineno, __pyx_lineno, __pyx_filename);
    }
    Py_DECREF(__pyx_m); __pyx_m = 0;
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init _loess");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

/* --- Runtime support code --- */
#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule((char *)modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
}
#endif

static PyObject *__Pyx_GetBuiltinName(PyObject *name) {
    PyObject* result = __Pyx_PyObject_GetAttrStr(__pyx_b, name);
    if (unlikely(!result)) {
        PyErr_Format(PyExc_NameError,
#if PY_MAJOR_VERSION >= 3
            "name '%U' is not defined", name);
#else
            "name '%.200s' is not defined", PyString_AS_STRING(name));
#endif
    }
    return result;
}

static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (unlikely(!type)) {
        PyErr_SetString(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (likely(PyObject_TypeCheck(obj, type)))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
                 Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name) {
    PyObject *result;
#if CYTHON_COMPILING_IN_CPYTHON
    result = PyDict_GetItem(__pyx_d, name);
    if (likely(result)) {
        Py_INCREF(result);
    } else {
#else
    result = PyObject_GetItem(__pyx_d, name);
    if (!result) {
        PyErr_Clear();
#endif
        result = __Pyx_GetBuiltinName(name);
    }
    return result;
}

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyObject *result;
    ternaryfunc call = func->ob_type->tp_call;
    if (unlikely(!call))
        return PyObject_Call(func, arg, kw);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = (*call)(func, arg, kw);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
    PyObject *self, *result;
    PyCFunction cfunc;
    cfunc = PyCFunction_GET_FUNCTION(func);
    self = PyCFunction_GET_SELF(func);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = cfunc(self, arg);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *result;
    PyObject *args = PyTuple_New(1);
    if (unlikely(!args)) return NULL;
    Py_INCREF(arg);
    PyTuple_SET_ITEM(args, 0, arg);
    result = __Pyx_PyObject_Call(func, args, NULL);
    Py_DECREF(args);
    return result;
}
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
            return __Pyx_PyObject_CallMethO(func, arg);
        }
    }
    return __Pyx__PyObject_CallOneArg(func, arg);
}
#else
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject* args = PyTuple_Pack(1, arg);
    return (likely(args)) ? __Pyx_PyObject_Call(func, args, NULL) : NULL;
}
#endif

static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *more_or_less;
    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    PyErr_Format(PyExc_TypeError,
                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
                 func_name, more_or_less, num_expected,
                 (num_expected == 1) ? "" : "s", num_found);
}

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AsString(kw_name));
        #endif
}

static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;
    while (PyDict_Next(kwds, &pos, &key, &value)) {
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            values[name-argnames] = value;
            continue;
        }
        name = first_kw_arg;
        #if PY_MAJOR_VERSION < 3
        if (likely(PyString_CheckExact(key)) || likely(PyString_Check(key))) {
            while (*name) {
                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
                        && _PyString_Eq(**name, key)) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    if ((**argname == key) || (
                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
                             && _PyString_Eq(**argname, key))) {
                        goto arg_passed_twice;
                    }
                    argname++;
                }
            }
        } else
        #endif
        if (likely(PyUnicode_Check(key))) {
            while (*name) {
                int cmp = (**name == key) ? 0 :
                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                    (PyUnicode_GET_SIZE(**name) != PyUnicode_GET_SIZE(key)) ? 1 :
                #endif
                    PyUnicode_Compare(**name, key);
                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                if (cmp == 0) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    int cmp = (**argname == key) ? 0 :
                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                        (PyUnicode_GET_SIZE(**argname) != PyUnicode_GET_SIZE(key)) ? 1 :
                    #endif
                        PyUnicode_Compare(**argname, key);
                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                    if (cmp == 0) goto arg_passed_twice;
                    argname++;
                }
            }
        } else
            goto invalid_keyword_type;
        if (kwds2) {
            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
        } else {
            goto invalid_keyword;
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, key);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%.200s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%.200s() got an unexpected keyword argument '%.200s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyList_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        PyObject *r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyTuple_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        PyObject *r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                     int is_list, int wraparound, int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (is_list || PyList_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
        if ((!boundscheck) || (likely((n >= 0) & (n < PyList_GET_SIZE(o))))) {
            PyObject *r = PyList_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    }
    else if (PyTuple_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
        if ((!boundscheck) || likely((n >= 0) & (n < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    } else {
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_item)) {
            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (likely(l >= 0)) {
                    i += l;
                } else {
                    if (PyErr_ExceptionMatches(PyExc_OverflowError))
                        PyErr_Clear();
                    else
                        return NULL;
                }
            }
            return m->sq_item(o, i);
        }
    }
#else
    if (is_list || PySequence_Check(o)) {
        return PySequence_GetItem(o, i);
    }
#endif
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}

static CYTHON_INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#else
    PyErr_Restore(type, value, tb);
#endif
}
static CYTHON_INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
#else
    PyErr_Fetch(type, value, tb);
#endif
}

#if PY_MAJOR_VERSION < 3
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                        CYTHON_UNUSED PyObject *cause) {
    Py_XINCREF(type);
    if (!value || value == Py_None)
        value = NULL;
    else
        Py_INCREF(value);
    if (!tb || tb == Py_None)
        tb = NULL;
    else {
        Py_INCREF(tb);
        if (!PyTraceBack_Check(tb)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: arg 3 must be a traceback or None");
            goto raise_error;
        }
    }
    if (PyType_Check(type)) {
#if CYTHON_COMPILING_IN_PYPY
        if (!value) {
            Py_INCREF(Py_None);
            value = Py_None;
        }
#endif
        PyErr_NormalizeException(&type, &value, &tb);
    } else {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        value = type;
        type = (PyObject*) Py_TYPE(type);
        Py_INCREF(type);
        if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: exception class must be a subclass of BaseException");
            goto raise_error;
        }
    }
    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}
#else
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
    PyObject* owned_instance = NULL;
    if (tb == Py_None) {
        tb = 0;
    } else if (tb && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto bad;
    }
    if (value == Py_None)
        value = 0;
    if (PyExceptionInstance_Check(type)) {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto bad;
        }
        value = type;
        type = (PyObject*) Py_TYPE(value);
    } else if (PyExceptionClass_Check(type)) {
        PyObject *instance_class = NULL;
        if (value && PyExceptionInstance_Check(value)) {
            instance_class = (PyObject*) Py_TYPE(value);
            if (instance_class != type) {
                if (PyObject_IsSubclass(instance_class, type)) {
                    type = instance_class;
                } else {
                    instance_class = NULL;
                }
            }
        }
        if (!instance_class) {
            PyObject *args;
            if (!value)
                args = PyTuple_New(0);
            else if (PyTuple_Check(value)) {
                Py_INCREF(value);
                args = value;
            } else
                args = PyTuple_Pack(1, value);
            if (!args)
                goto bad;
            owned_instance = PyObject_Call(type, args, NULL);
            Py_DECREF(args);
            if (!owned_instance)
                goto bad;
            value = owned_instance;
            if (!PyExceptionInstance_Check(value)) {
                PyErr_Format(PyExc_TypeError,
                             "calling %R should have returned an instance of "
                             "BaseException, not %R",
                             type, Py_TYPE(value));
                goto bad;
            }
        }
    } else {
        PyErr_SetString(PyExc_TypeError,
            "raise: exception class must be a subclass of BaseException");
        goto bad;
    }
#if PY_VERSION_HEX >= 0x03030000
    if (cause) {
#else
    if (cause && cause != Py_None) {
#endif
        PyObject *fixed_cause;
        if (cause == Py_None) {
            fixed_cause = NULL;
        } else if (PyExceptionClass_Check(cause)) {
            fixed_cause = PyObject_CallObject(cause, NULL);
            if (fixed_cause == NULL)
                goto bad;
        } else if (PyExceptionInstance_Check(cause)) {
            fixed_cause = cause;
            Py_INCREF(fixed_cause);
        } else {
            PyErr_SetString(PyExc_TypeError,
                            "exception causes must derive from "
                            "BaseException");
            goto bad;
        }
        PyException_SetCause(value, fixed_cause);
    }
    PyErr_SetObject(type, value);
    if (tb) {
#if CYTHON_COMPILING_IN_PYPY
        PyObject *tmp_type, *tmp_value, *tmp_tb;
        PyErr_Fetch(tmp_type, tmp_value, tmp_tb);
        Py_INCREF(tb);
        PyErr_Restore(tmp_type, tmp_value, tb);
        Py_XDECREF(tmp_tb);
#else
        PyThreadState *tstate = PyThreadState_GET();
        PyObject* tmp_tb = tstate->curexc_traceback;
        if (tb != tmp_tb) {
            Py_INCREF(tb);
            tstate->curexc_traceback = tb;
            Py_XDECREF(tmp_tb);
        }
#endif
    }
bad:
    Py_XDECREF(owned_instance);
    return;
}
#endif

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
            return __Pyx_PyObject_CallMethO(func, NULL);
        }
    }
    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
}
#endif

static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY
    return PyObject_RichCompareBool(s1, s2, equals);
#else
    if (s1 == s2) {
        return (equals == Py_EQ);
    } else if (PyBytes_CheckExact(s1) & PyBytes_CheckExact(s2)) {
        const char *ps1, *ps2;
        Py_ssize_t length = PyBytes_GET_SIZE(s1);
        if (length != PyBytes_GET_SIZE(s2))
            return (equals == Py_NE);
        ps1 = PyBytes_AS_STRING(s1);
        ps2 = PyBytes_AS_STRING(s2);
        if (ps1[0] != ps2[0]) {
            return (equals == Py_NE);
        } else if (length == 1) {
            return (equals == Py_EQ);
        } else {
            int result = memcmp(ps1, ps2, (size_t)length);
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & PyBytes_CheckExact(s2)) {
        return (equals == Py_NE);
    } else if ((s2 == Py_None) & PyBytes_CheckExact(s1)) {
        return (equals == Py_NE);
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
#endif
}

static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY
    return PyObject_RichCompareBool(s1, s2, equals);
#else
#if PY_MAJOR_VERSION < 3
    PyObject* owned_ref = NULL;
#endif
    int s1_is_unicode, s2_is_unicode;
    if (s1 == s2) {
        goto return_eq;
    }
    s1_is_unicode = PyUnicode_CheckExact(s1);
    s2_is_unicode = PyUnicode_CheckExact(s2);
#if PY_MAJOR_VERSION < 3
    if ((s1_is_unicode & (!s2_is_unicode)) && PyString_CheckExact(s2)) {
        owned_ref = PyUnicode_FromObject(s2);
        if (unlikely(!owned_ref))
            return -1;
        s2 = owned_ref;
        s2_is_unicode = 1;
    } else if ((s2_is_unicode & (!s1_is_unicode)) && PyString_CheckExact(s1)) {
        owned_ref = PyUnicode_FromObject(s1);
        if (unlikely(!owned_ref))
            return -1;
        s1 = owned_ref;
        s1_is_unicode = 1;
    } else if (((!s2_is_unicode) & (!s1_is_unicode))) {
        return __Pyx_PyBytes_Equals(s1, s2, equals);
    }
#endif
    if (s1_is_unicode & s2_is_unicode) {
        Py_ssize_t length;
        int kind;
        void *data1, *data2;
        if (unlikely(__Pyx_PyUnicode_READY(s1) < 0) || unlikely(__Pyx_PyUnicode_READY(s2) < 0))
            return -1;
        length = __Pyx_PyUnicode_GET_LENGTH(s1);
        if (length != __Pyx_PyUnicode_GET_LENGTH(s2)) {
            goto return_ne;
        }
        kind = __Pyx_PyUnicode_KIND(s1);
        if (kind != __Pyx_PyUnicode_KIND(s2)) {
            goto return_ne;
        }
        data1 = __Pyx_PyUnicode_DATA(s1);
        data2 = __Pyx_PyUnicode_DATA(s2);
        if (__Pyx_PyUnicode_READ(kind, data1, 0) != __Pyx_PyUnicode_READ(kind, data2, 0)) {
            goto return_ne;
        } else if (length == 1) {
            goto return_eq;
        } else {
            int result = memcmp(data1, data2, (size_t)(length * kind));
            #if PY_MAJOR_VERSION < 3
            Py_XDECREF(owned_ref);
            #endif
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & s2_is_unicode) {
        goto return_ne;
    } else if ((s2 == Py_None) & s1_is_unicode) {
        goto return_ne;
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
return_eq:
    #if PY_MAJOR_VERSION < 3
    Py_XDECREF(owned_ref);
    #endif
    return (equals == Py_EQ);
return_ne:
    #if PY_MAJOR_VERSION < 3
    Py_XDECREF(owned_ref);
    #endif
    return (equals == Py_NE);
#endif
}

static CYTHON_INLINE int __Pyx_CheckKeywordStrings(
    PyObject *kwdict,
    const char* function_name,
    int kw_allowed)
{
    PyObject* key = 0;
    Py_ssize_t pos = 0;
#if CYTHON_COMPILING_IN_PYPY
    if (!kw_allowed && PyDict_Next(kwdict, &pos, &key, 0))
        goto invalid_keyword;
    return 1;
#else
    while (PyDict_Next(kwdict, &pos, &key, 0)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key)))
        #endif
            if (unlikely(!PyUnicode_Check(key)))
                goto invalid_keyword_type;
    }
    if ((!kw_allowed) && unlikely(key))
        goto invalid_keyword;
    return 1;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%.200s() keywords must be strings", function_name);
    return 0;
#endif
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%.200s() got an unexpected keyword argument '%.200s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
    return 0;
}

static PyObject* __Pyx_PyDict_GetItemDefault(PyObject* d, PyObject* key, PyObject* default_value) {
    PyObject* value;
#if PY_MAJOR_VERSION >= 3
    value = PyDict_GetItemWithError(d, key);
    if (unlikely(!value)) {
        if (unlikely(PyErr_Occurred()))
            return NULL;
        value = default_value;
    }
    Py_INCREF(value);
#else
    if (PyString_CheckExact(key) || PyUnicode_CheckExact(key) || PyInt_CheckExact(key)) {
        value = PyDict_GetItem(d, key);
        if (unlikely(!value)) {
            value = default_value;
        }
        Py_INCREF(value);
    } else {
        if (default_value == Py_None)
            default_value = NULL;
        value = PyObject_CallMethodObjArgs(
            d, __pyx_n_s_get, key, default_value, NULL);
    }
#endif
    return value;
}

#if !CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyBytes_Join(PyObject* sep, PyObject* values) {
    return PyObject_CallMethodObjArgs(sep, __pyx_n_s_join, values, NULL);
}
#endif

static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
        int has_cstart, int has_cstop, CYTHON_UNUSED int wraparound) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyMappingMethods* mp;
#if PY_MAJOR_VERSION < 3
    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
    if (likely(ms && ms->sq_slice)) {
        if (!has_cstart) {
            if (_py_start && (*_py_start != Py_None)) {
                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstart = 0;
        }
        if (!has_cstop) {
            if (_py_stop && (*_py_stop != Py_None)) {
                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstop = PY_SSIZE_T_MAX;
        }
        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
            Py_ssize_t l = ms->sq_length(obj);
            if (likely(l >= 0)) {
                if (cstop < 0) {
                    cstop += l;
                    if (cstop < 0) cstop = 0;
                }
                if (cstart < 0) {
                    cstart += l;
                    if (cstart < 0) cstart = 0;
                }
            } else {
                if (PyErr_ExceptionMatches(PyExc_OverflowError))
                    PyErr_Clear();
                else
                    goto bad;
            }
        }
        return ms->sq_slice(obj, cstart, cstop);
    }
#endif
    mp = Py_TYPE(obj)->tp_as_mapping;
    if (likely(mp && mp->mp_subscript))
#endif
    {
        PyObject* result;
        PyObject *py_slice, *py_start, *py_stop;
        if (_py_slice) {
            py_slice = *_py_slice;
        } else {
            PyObject* owned_start = NULL;
            PyObject* owned_stop = NULL;
            if (_py_start) {
                py_start = *_py_start;
            } else {
                if (has_cstart) {
                    owned_start = py_start = PyInt_FromSsize_t(cstart);
                    if (unlikely(!py_start)) goto bad;
                } else
                    py_start = Py_None;
            }
            if (_py_stop) {
                py_stop = *_py_stop;
            } else {
                if (has_cstop) {
                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
                    if (unlikely(!py_stop)) {
                        Py_XDECREF(owned_start);
                        goto bad;
                    }
                } else
                    py_stop = Py_None;
            }
            py_slice = PySlice_New(py_start, py_stop, Py_None);
            Py_XDECREF(owned_start);
            Py_XDECREF(owned_stop);
            if (unlikely(!py_slice)) goto bad;
        }
#if CYTHON_COMPILING_IN_CPYTHON
        result = mp->mp_subscript(obj, py_slice);
#else
        result = PyObject_GetItem(obj, py_slice);
#endif
        if (!_py_slice) {
            Py_DECREF(py_slice);
        }
        return result;
    }
    PyErr_Format(PyExc_TypeError,
        "'%.200s' object is unsliceable", Py_TYPE(obj)->tp_name);
bad:
    return NULL;
}

static CYTHON_INLINE int __Pyx_IterFinish(void) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    PyObject* exc_type = tstate->curexc_type;
    if (unlikely(exc_type)) {
        if (likely(exc_type == PyExc_StopIteration) || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration)) {
            PyObject *exc_value, *exc_tb;
            exc_value = tstate->curexc_value;
            exc_tb = tstate->curexc_traceback;
            tstate->curexc_type = 0;
            tstate->curexc_value = 0;
            tstate->curexc_traceback = 0;
            Py_DECREF(exc_type);
            Py_XDECREF(exc_value);
            Py_XDECREF(exc_tb);
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#else
    if (unlikely(PyErr_Occurred())) {
        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
            PyErr_Clear();
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#endif
}

static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name) {
    PyObject *method, *result = NULL;
    method = __Pyx_PyObject_GetAttrStr(obj, method_name);
    if (unlikely(!method)) goto bad;
#if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyMethod_Check(method))) {
        PyObject *self = PyMethod_GET_SELF(method);
        if (likely(self)) {
            PyObject *function = PyMethod_GET_FUNCTION(method);
            result = __Pyx_PyObject_CallOneArg(function, self);
            Py_DECREF(method);
            return result;
        }
    }
#endif
    result = __Pyx_PyObject_CallNoArg(method);
    Py_DECREF(method);
bad:
    return result;
}

static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
                 index, (index == 1) ? "" : "s");
}

static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
    PyErr_Format(PyExc_ValueError,
                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
}

static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
    if (unlikely(retval)) {
        Py_DECREF(retval);
        __Pyx_RaiseTooManyValuesError(expected);
        return -1;
    } else {
        return __Pyx_IterFinish();
    }
    return 0;
}

static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
}

static void __Pyx_UnpackTupleError(PyObject *t, Py_ssize_t index) {
    if (t == Py_None) {
      __Pyx_RaiseNoneNotIterableError();
    } else if (PyTuple_GET_SIZE(t) < index) {
      __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(t));
    } else {
      __Pyx_RaiseTooManyValuesError(index);
    }
}

static CYTHON_INLINE int __Pyx_unpack_tuple2(PyObject* tuple, PyObject** pvalue1, PyObject** pvalue2,
                                             int is_tuple, int has_known_size, int decref_tuple) {
    Py_ssize_t index;
    PyObject *value1 = NULL, *value2 = NULL, *iter = NULL;
    if (!is_tuple && unlikely(!PyTuple_Check(tuple))) {
        iternextfunc iternext;
        iter = PyObject_GetIter(tuple);
        if (unlikely(!iter)) goto bad;
        if (decref_tuple) { Py_DECREF(tuple); tuple = NULL; }
        iternext = Py_TYPE(iter)->tp_iternext;
        value1 = iternext(iter); if (unlikely(!value1)) { index = 0; goto unpacking_failed; }
        value2 = iternext(iter); if (unlikely(!value2)) { index = 1; goto unpacking_failed; }
        if (!has_known_size && unlikely(__Pyx_IternextUnpackEndCheck(iternext(iter), 2))) goto bad;
        Py_DECREF(iter);
    } else {
        if (!has_known_size && unlikely(PyTuple_GET_SIZE(tuple) != 2)) {
            __Pyx_UnpackTupleError(tuple, 2);
            goto bad;
        }
#if CYTHON_COMPILING_IN_PYPY
        value1 = PySequence_ITEM(tuple, 0);
        if (unlikely(!value1)) goto bad;
        value2 = PySequence_ITEM(tuple, 1);
        if (unlikely(!value2)) goto bad;
#else
        value1 = PyTuple_GET_ITEM(tuple, 0);
        value2 = PyTuple_GET_ITEM(tuple, 1);
        Py_INCREF(value1);
        Py_INCREF(value2);
#endif
        if (decref_tuple) { Py_DECREF(tuple); }
    }
    *pvalue1 = value1;
    *pvalue2 = value2;
    return 0;
unpacking_failed:
    if (!has_known_size && __Pyx_IterFinish() == 0)
        __Pyx_RaiseNeedMoreValuesError(index);
bad:
    Py_XDECREF(iter);
    Py_XDECREF(value1);
    Py_XDECREF(value2);
    if (decref_tuple) { Py_XDECREF(tuple); }
    return -1;
}

static CYTHON_INLINE PyObject* __Pyx_dict_iterator(PyObject* iterable, int is_dict, PyObject* method_name,
                                                   Py_ssize_t* p_orig_length, int* p_source_is_dict) {
    is_dict = is_dict || likely(PyDict_CheckExact(iterable));
    *p_source_is_dict = is_dict;
#if !CYTHON_COMPILING_IN_PYPY
    if (is_dict) {
        *p_orig_length = PyDict_Size(iterable);
        Py_INCREF(iterable);
        return iterable;
    }
#endif
    *p_orig_length = 0;
    if (method_name) {
        PyObject* iter;
        iterable = __Pyx_PyObject_CallMethod0(iterable, method_name);
        if (!iterable)
            return NULL;
#if !CYTHON_COMPILING_IN_PYPY
        if (PyTuple_CheckExact(iterable) || PyList_CheckExact(iterable))
            return iterable;
#endif
        iter = PyObject_GetIter(iterable);
        Py_DECREF(iterable);
        return iter;
    }
    return PyObject_GetIter(iterable);
}
static CYTHON_INLINE int __Pyx_dict_iter_next(PyObject* iter_obj, Py_ssize_t orig_length, Py_ssize_t* ppos,
                                              PyObject** pkey, PyObject** pvalue, PyObject** pitem, int source_is_dict) {
    PyObject* next_item;
#if !CYTHON_COMPILING_IN_PYPY
    if (source_is_dict) {
        PyObject *key, *value;
        if (unlikely(orig_length != PyDict_Size(iter_obj))) {
            PyErr_SetString(PyExc_RuntimeError, "dictionary changed size during iteration");
            return -1;
        }
        if (unlikely(!PyDict_Next(iter_obj, ppos, &key, &value))) {
            return 0;
        }
        if (pitem) {
            PyObject* tuple = PyTuple_New(2);
            if (unlikely(!tuple)) {
                return -1;
            }
            Py_INCREF(key);
            Py_INCREF(value);
            PyTuple_SET_ITEM(tuple, 0, key);
            PyTuple_SET_ITEM(tuple, 1, value);
            *pitem = tuple;
        } else {
            if (pkey) {
                Py_INCREF(key);
                *pkey = key;
            }
            if (pvalue) {
                Py_INCREF(value);
                *pvalue = value;
            }
        }
        return 1;
    } else if (PyTuple_CheckExact(iter_obj)) {
        Py_ssize_t pos = *ppos;
        if (unlikely(pos >= PyTuple_GET_SIZE(iter_obj))) return 0;
        *ppos = pos + 1;
        next_item = PyTuple_GET_ITEM(iter_obj, pos);
        Py_INCREF(next_item);
    } else if (PyList_CheckExact(iter_obj)) {
        Py_ssize_t pos = *ppos;
        if (unlikely(pos >= PyList_GET_SIZE(iter_obj))) return 0;
        *ppos = pos + 1;
        next_item = PyList_GET_ITEM(iter_obj, pos);
        Py_INCREF(next_item);
    } else
#endif
    {
        next_item = PyIter_Next(iter_obj);
        if (unlikely(!next_item)) {
            return __Pyx_IterFinish();
        }
    }
    if (pitem) {
        *pitem = next_item;
    } else if (pkey && pvalue) {
        if (__Pyx_unpack_tuple2(next_item, pkey, pvalue, source_is_dict, source_is_dict, 1))
            return -1;
    } else if (pkey) {
        *pkey = next_item;
    } else {
        *pvalue = next_item;
    }
    return 1;
}

static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
#if PY_VERSION_HEX >= 0x02070000
    PyObject *ob = PyCapsule_New(vtable, 0, 0);
#else
    PyObject *ob = PyCObject_FromVoidPtr(vtable, 0);
#endif
    if (!ob)
        goto bad;
    if (PyDict_SetItem(dict, __pyx_n_s_pyx_vtable, ob) < 0)
        goto bad;
    Py_DECREF(ob);
    return 0;
bad:
    Py_XDECREF(ob);
    return -1;
}

static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
    int start = 0, mid = 0, end = count - 1;
    if (end >= 0 && code_line > entries[end].code_line) {
        return count;
    }
    while (start < end) {
        mid = (start + end) / 2;
        if (code_line < entries[mid].code_line) {
            end = mid;
        } else if (code_line > entries[mid].code_line) {
             start = mid + 1;
        } else {
            return mid;
        }
    }
    if (code_line <= entries[mid].code_line) {
        return mid;
    } else {
        return mid + 1;
    }
}
static PyCodeObject *__pyx_find_code_object(int code_line) {
    PyCodeObject* code_object;
    int pos;
    if (unlikely(!code_line) || unlikely(!__pyx_code_cache.entries)) {
        return NULL;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if (unlikely(pos >= __pyx_code_cache.count) || unlikely(__pyx_code_cache.entries[pos].code_line != code_line)) {
        return NULL;
    }
    code_object = __pyx_code_cache.entries[pos].code_object;
    Py_INCREF(code_object);
    return code_object;
}
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object) {
    int pos, i;
    __Pyx_CodeObjectCacheEntry* entries = __pyx_code_cache.entries;
    if (unlikely(!code_line)) {
        return;
    }
    if (unlikely(!entries)) {
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Malloc(64*sizeof(__Pyx_CodeObjectCacheEntry));
        if (likely(entries)) {
            __pyx_code_cache.entries = entries;
            __pyx_code_cache.max_count = 64;
            __pyx_code_cache.count = 1;
            entries[0].code_line = code_line;
            entries[0].code_object = code_object;
            Py_INCREF(code_object);
        }
        return;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if ((pos < __pyx_code_cache.count) && unlikely(__pyx_code_cache.entries[pos].code_line == code_line)) {
        PyCodeObject* tmp = entries[pos].code_object;
        entries[pos].code_object = code_object;
        Py_DECREF(tmp);
        return;
    }
    if (__pyx_code_cache.count == __pyx_code_cache.max_count) {
        int new_max = __pyx_code_cache.max_count + 64;
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Realloc(
            __pyx_code_cache.entries, (size_t)new_max*sizeof(__Pyx_CodeObjectCacheEntry));
        if (unlikely(!entries)) {
            return;
        }
        __pyx_code_cache.entries = entries;
        __pyx_code_cache.max_count = new_max;
    }
    for (i=__pyx_code_cache.count; i>pos; i--) {
        entries[i] = entries[i-1];
    }
    entries[pos].code_line = code_line;
    entries[pos].code_object = code_object;
    __pyx_code_cache.count++;
    Py_INCREF(code_object);
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"
static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
            const char *funcname, int c_line,
            int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(filename);
    #else
    py_srcfile = PyUnicode_FromString(filename);
    #endif
    if (!py_srcfile) goto bad;
    if (c_line) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_code = __Pyx_PyCode_New(
        0,
        0,
        0,
        0,
        0,
        __pyx_empty_bytes, /*PyObject *code,*/
        __pyx_empty_tuple, /*PyObject *consts,*/
        __pyx_empty_tuple, /*PyObject *names,*/
        __pyx_empty_tuple, /*PyObject *varnames,*/
        __pyx_empty_tuple, /*PyObject *freevars,*/
        __pyx_empty_tuple, /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        py_line,
        __pyx_empty_bytes  /*PyObject *lnotab*/
    );
    Py_DECREF(py_srcfile);
    Py_DECREF(py_funcname);
    return py_code;
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    py_code = __pyx_find_code_object(c_line ? c_line : py_line);
    if (!py_code) {
        py_code = __Pyx_CreateCodeObjectForTraceback(
            funcname, c_line, py_line, filename);
        if (!py_code) goto bad;
        __pyx_insert_code_object(c_line ? c_line : py_line, py_code);
    }
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        __pyx_d,      /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = py_line;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    #if PY_VERSION_HEX < 0x03030000
    PyObject *py_import;
    py_import = __Pyx_PyObject_GetAttrStr(__pyx_b, __pyx_n_s_import);
    if (!py_import)
        goto bad;
    #endif
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    {
        #if PY_MAJOR_VERSION >= 3
        if (level == -1) {
            if (strchr(__Pyx_MODULE_NAME, '.')) {
                #if PY_VERSION_HEX < 0x03030000
                PyObject *py_level = PyInt_FromLong(1);
                if (!py_level)
                    goto bad;
                module = PyObject_CallFunctionObjArgs(py_import,
                    name, global_dict, empty_dict, list, py_level, NULL);
                Py_DECREF(py_level);
                #else
                module = PyImport_ImportModuleLevelObject(
                    name, global_dict, empty_dict, list, 1);
                #endif
                if (!module) {
                    if (!PyErr_ExceptionMatches(PyExc_ImportError))
                        goto bad;
                    PyErr_Clear();
                }
            }
            level = 0;
        }
        #endif
        if (!module) {
            #if PY_VERSION_HEX < 0x03030000
            PyObject *py_level = PyInt_FromLong(level);
            if (!py_level)
                goto bad;
            module = PyObject_CallFunctionObjArgs(py_import,
                name, global_dict, empty_dict, list, py_level, NULL);
            Py_DECREF(py_level);
            #else
            module = PyImport_ImportModuleLevelObject(
                name, global_dict, empty_dict, list, level);
            #endif
        }
    }
bad:
    #if PY_VERSION_HEX < 0x03030000
    Py_XDECREF(py_import);
    #endif
    Py_XDECREF(empty_list);
    Py_XDECREF(empty_dict);
    return module;
}

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
    const int neg_one = (int) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(int) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(int) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(int) <= sizeof(unsigned long long)) {
            return PyLong_FromUnsignedLongLong((unsigned long long) value);
        }
    } else {
        if (sizeof(int) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(int) <= sizeof(long long)) {
            return PyLong_FromLongLong((long long) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(int),
                                     little, !is_unsigned);
    }
}

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
    const long neg_one = (long) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(long) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(long) <= sizeof(unsigned long long)) {
            return PyLong_FromUnsignedLongLong((unsigned long long) value);
        }
    } else {
        if (sizeof(long) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(long long)) {
            return PyLong_FromLongLong((long long) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(long),
                                     little, !is_unsigned);
    }
}

#define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)       \
    {                                                                     \
        func_type value = func_value;                                     \
        if (sizeof(target_type) < sizeof(func_type)) {                    \
            if (unlikely(value != (func_type) (target_type) value)) {     \
                func_type zero = 0;                                       \
                if (is_unsigned && unlikely(value < zero))                \
                    goto raise_neg_overflow;                              \
                else                                                      \
                    goto raise_overflow;                                  \
            }                                                             \
        }                                                                 \
        return (target_type) value;                                       \
    }

#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
  #include "longintrepr.h"
 #endif
#endif

static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
    const int neg_one = (int) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(int) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (int) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(int, digit, ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
            if (sizeof(int) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT(int, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(int) <= sizeof(unsigned long long)) {
                __PYX_VERIFY_RETURN_INT(int, unsigned long long, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(int,  digit, +(((PyLongObject*)x)->ob_digit[0]));
                case -1: __PYX_VERIFY_RETURN_INT(int, sdigit, -(sdigit) ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (sizeof(int) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT(int, long, PyLong_AsLong(x))
            } else if (sizeof(int) <= sizeof(long long)) {
                __PYX_VERIFY_RETURN_INT(int, long long, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            int val;
            PyObject *v = __Pyx_PyNumber_Int(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (int) -1;
        }
    } else {
        int val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (int) -1;
        val = __Pyx_PyInt_As_int(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to int");
    return (int) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to int");
    return (int) -1;
}

#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject((char *)"stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}
static int __Pyx_Print(PyObject* f, PyObject *arg_tuple, int newline) {
    int i;
    if (!f) {
        if (!(f = __Pyx_GetStdout()))
            return -1;
    }
    Py_INCREF(f);
    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
        PyObject* v;
        if (PyFile_SoftSpace(f, 1)) {
            if (PyFile_WriteString(" ", f) < 0)
                goto error;
        }
        v = PyTuple_GET_ITEM(arg_tuple, i);
        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
            goto error;
        if (PyString_Check(v)) {
            char *s = PyString_AsString(v);
            Py_ssize_t len = PyString_Size(v);
            if (len > 0) {
                switch (s[len-1]) {
                    case ' ': break;
                    case '\f': case '\r': case '\n': case '\t': case '\v':
                        PyFile_SoftSpace(f, 0);
                        break;
                    default:  break;
                }
            }
        }
    }
    if (newline) {
        if (PyFile_WriteString("\n", f) < 0)
            goto error;
        PyFile_SoftSpace(f, 0);
    }
    Py_DECREF(f);
    return 0;
error:
    Py_DECREF(f);
    return -1;
}
#else
static int __Pyx_Print(PyObject* stream, PyObject *arg_tuple, int newline) {
    PyObject* kwargs = 0;
    PyObject* result = 0;
    PyObject* end_string;
    if (unlikely(!__pyx_print)) {
        __pyx_print = PyObject_GetAttr(__pyx_b, __pyx_n_s_print);
        if (!__pyx_print)
            return -1;
    }
    if (stream) {
        kwargs = PyDict_New();
        if (unlikely(!kwargs))
            return -1;
        if (unlikely(PyDict_SetItem(kwargs, __pyx_n_s_file, stream) < 0))
            goto bad;
        if (!newline) {
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (unlikely(!end_string))
                goto bad;
            if (PyDict_SetItem(kwargs, __pyx_n_s_end, end_string) < 0) {
                Py_DECREF(end_string);
                goto bad;
            }
            Py_DECREF(end_string);
        }
    } else if (!newline) {
        if (unlikely(!__pyx_print_kwargs)) {
            __pyx_print_kwargs = PyDict_New();
            if (unlikely(!__pyx_print_kwargs))
                return -1;
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (unlikely(!end_string))
                return -1;
            if (PyDict_SetItem(__pyx_print_kwargs, __pyx_n_s_end, end_string) < 0) {
                Py_DECREF(end_string);
                return -1;
            }
            Py_DECREF(end_string);
        }
        kwargs = __pyx_print_kwargs;
    }
    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
    if (unlikely(kwargs) && (kwargs != __pyx_print_kwargs))
        Py_DECREF(kwargs);
    if (!result)
        return -1;
    Py_DECREF(result);
    return 0;
bad:
    if (kwargs != __pyx_print_kwargs)
        Py_XDECREF(kwargs);
    return -1;
}
#endif

#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
static int __Pyx_PrintOne(PyObject* f, PyObject *o) {
    if (!f) {
        if (!(f = __Pyx_GetStdout()))
            return -1;
    }
    Py_INCREF(f);
    if (PyFile_SoftSpace(f, 0)) {
        if (PyFile_WriteString(" ", f) < 0)
            goto error;
    }
    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
        goto error;
    if (PyFile_WriteString("\n", f) < 0)
        goto error;
    Py_DECREF(f);
    return 0;
error:
    Py_DECREF(f);
    return -1;
    /* the line below is just to avoid C compiler
     * warnings about unused functions */
    return __Pyx_Print(f, NULL, 0);
}
#else
static int __Pyx_PrintOne(PyObject* stream, PyObject *o) {
    int res;
    PyObject* arg_tuple = PyTuple_Pack(1, o);
    if (unlikely(!arg_tuple))
        return -1;
    res = __Pyx_Print(stream, arg_tuple, 1);
    Py_DECREF(arg_tuple);
    return res;
}
#endif

static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
    const long neg_one = (long) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(long) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (long) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(long, digit, ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
            if (sizeof(long) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT(long, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(long) <= sizeof(unsigned long long)) {
                __PYX_VERIFY_RETURN_INT(long, unsigned long long, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(long,  digit, +(((PyLongObject*)x)->ob_digit[0]));
                case -1: __PYX_VERIFY_RETURN_INT(long, sdigit, -(sdigit) ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (sizeof(long) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT(long, long, PyLong_AsLong(x))
            } else if (sizeof(long) <= sizeof(long long)) {
                __PYX_VERIFY_RETURN_INT(long, long long, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            long val;
            PyObject *v = __Pyx_PyNumber_Int(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (long) -1;
        }
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (long) -1;
        val = __Pyx_PyInt_As_long(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to long");
    return (long) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to long");
    return (long) -1;
}

static int __Pyx_check_binary_version(void) {
    char ctversion[4], rtversion[4];
    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
        char message[200];
        PyOS_snprintf(message, sizeof(message),
                      "compiletime version %s of module '%.100s' "
                      "does not match runtime version %s",
                      ctversion, __Pyx_MODULE_NAME, rtversion);
        return PyErr_WarnEx(NULL, message, 1);
    }
    return 0;
}

#ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;
    py_name = __Pyx_PyIdentifier_FromString(name);
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    size_t size, int strict)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;
    char warning[200];
    Py_ssize_t basicsize;
#ifdef Py_LIMITED_API
    PyObject *py_basicsize;
#endif
    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    py_name = __Pyx_PyIdentifier_FromString(class_name);
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError,
            "%.200s.%.200s is not a type object",
            module_name, class_name);
        goto bad;
    }
#ifndef Py_LIMITED_API
    basicsize = ((PyTypeObject *)result)->tp_basicsize;
#else
    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
    if (!py_basicsize)
        goto bad;
    basicsize = PyLong_AsSsize_t(py_basicsize);
    Py_DECREF(py_basicsize);
    py_basicsize = 0;
    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
        goto bad;
#endif
    if (!strict && (size_t)basicsize > size) {
        PyOS_snprintf(warning, sizeof(warning),
            "%s.%s size changed, may indicate binary incompatibility",
            module_name, class_name);
        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
    }
    else if ((size_t)basicsize != size) {
        PyErr_Format(PyExc_ValueError,
            "%.200s.%.200s has the wrong size, try recompiling",
            module_name, class_name);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return NULL;
}
#endif

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else
        if (t->is_unicode | t->is_str) {
            if (t->intern) {
                *t->p = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
            } else {
                *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char* c_str) {
    return __Pyx_PyUnicode_FromStringAndSize(c_str, (Py_ssize_t)strlen(c_str));
}
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject* o) {
    Py_ssize_t ignore;
    return __Pyx_PyObject_AsStringAndSize(o, &ignore);
}
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject* o, Py_ssize_t *length) {
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
    if (
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
            __Pyx_sys_getdefaultencoding_not_ascii &&
#endif
            PyUnicode_Check(o)) {
#if PY_VERSION_HEX < 0x03030000
        char* defenc_c;
        PyObject* defenc = _PyUnicode_AsDefaultEncodedString(o, NULL);
        if (!defenc) return NULL;
        defenc_c = PyBytes_AS_STRING(defenc);
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        {
            char* end = defenc_c + PyBytes_GET_SIZE(defenc);
            char* c;
            for (c = defenc_c; c < end; c++) {
                if ((unsigned char) (*c) >= 128) {
                    PyUnicode_AsASCIIString(o);
                    return NULL;
                }
            }
        }
#endif
        *length = PyBytes_GET_SIZE(defenc);
        return defenc_c;
#else
        if (__Pyx_PyUnicode_READY(o) == -1) return NULL;
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        if (PyUnicode_IS_ASCII(o)) {
            *length = PyUnicode_GET_LENGTH(o);
            return PyUnicode_AsUTF8(o);
        } else {
            PyUnicode_AsASCIIString(o);
            return NULL;
        }
#else
        return PyUnicode_AsUTF8AndSize(o, length);
#endif
#endif
    } else
#endif
#if !CYTHON_COMPILING_IN_PYPY
    if (PyByteArray_Check(o)) {
        *length = PyByteArray_GET_SIZE(o);
        return PyByteArray_AS_STRING(o);
    } else
#endif
    {
        char* result;
        int r = PyBytes_AsStringAndSize(o, &result, length);
        if (unlikely(r < 0)) {
            return NULL;
        } else {
            return result;
        }
    }
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   int is_true = x == Py_True;
   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
   else return PyObject_IsTrue(x);
}
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_MAJOR_VERSION < 3
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return Py_INCREF(x), x;
  m = Py_TYPE(x)->tp_as_number;
#if PY_MAJOR_VERSION < 3
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_MAJOR_VERSION < 3
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%.4s__ returned non-%.4s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject *x;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(b)))
      return PyInt_AS_LONG(b);
#endif
  if (likely(PyLong_CheckExact(b))) {
    #if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
     #if CYTHON_USE_PYLONG_INTERNALS
       switch (Py_SIZE(b)) {
       case -1: return -(sdigit)((PyLongObject*)b)->ob_digit[0];
       case  0: return 0;
       case  1: return ((PyLongObject*)b)->ob_digit[0];
       }
     #endif
    #endif
    return PyLong_AsSsize_t(b);
  }
  x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
    return PyInt_FromSize_t(ival);
}


#endif /* Py_PYTHON_H */
